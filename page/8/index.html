<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 7.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css" integrity="sha256-dABdfBfUoC8vJUBOwGVdm8L9qlMWaHTIfXt+7GnZCIo=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"hunter1023.github.io","root":"/","images":"/images","scheme":"Muse","darkmode":true,"version":"8.22.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"copycode":{"enable":true,"style":"flat"},"fold":{"enable":true,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":true,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":"utterances","storage":true,"lazyload":false,"nav":null,"activeClass":"utterances"},"stickytabs":false,"motion":{"enable":true,"async":false,"duration":200,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"top_n_per_article":3,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="Tough times never last, but tough people do.">
<meta property="og:type" content="website">
<meta property="og:title" content="Talk is cheap">
<meta property="og:url" content="https://hunter1023.github.io/page/8/index.html">
<meta property="og:site_name" content="Talk is cheap">
<meta property="og:description" content="Tough times never last, but tough people do.">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="Hunter">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://hunter1023.github.io/page/8/">


<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"zh-CN","comments":"","permalink":"","path":"page/8/index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Talk is cheap</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">Talk is cheap</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
      <div class="search-header">
        <span class="search-icon">
          <i class="fa fa-search"></i>
        </span>
        <div class="search-input-container">
          <input autocomplete="off" autocapitalize="off" maxlength="80"
                placeholder="搜索..." spellcheck="false"
                type="search" class="search-input">
        </div>
        <span class="popup-btn-close" role="button">
          <i class="fa fa-times-circle"></i>
        </span>
      </div>
      <div class="search-result-container">
        <div class="search-result-icon">
          <i class="fa fa-spinner fa-pulse fa-5x"></i>
        </div>
      </div>
    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Hunter</p>
  <div class="site-description" itemprop="description">Tough times never last, but tough people do.</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">98</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">37</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">175</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://hunter1023.github.io/2021/03/13/Java%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Hunter">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Talk is cheap">
      <meta itemprop="description" content="Tough times never last, but tough people do.">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Talk is cheap">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/03/13/Java%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/" class="post-title-link" itemprop="url">Java基础语法</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2021-03-13 21:17:35" itemprop="dateCreated datePublished" datetime="2021-03-13T21:17:35+08:00">2021-03-13</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-01-23 23:29:13" itemprop="dateModified" datetime="2025-01-23T23:29:13+08:00">2025-01-23</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Java%E5%85%A8%E6%A0%88/" itemprop="url" rel="index"><span itemprop="name">Java全栈</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Java%E5%85%A8%E6%A0%88/JavaSE/" itemprop="url" rel="index"><span itemprop="name">JavaSE</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="注释"><a href="#注释" class="headerlink" title="注释"></a>注释</h2><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// 单行注释</span>

<span class="token comment">/*
多行注释
*/</span>

<span class="token comment">/**
 * JavaDoc：文档注释
 * 
 * 
 */</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h2 id="标识符"><a href="#标识符" class="headerlink" title="标识符"></a>标识符</h2><p><strong>类名</strong>、<strong>变量名</strong>、<strong>方法名</strong>都被称为<strong>标识符</strong>。</p>
<ul>
<li><strong>关键字</strong>不能作为标识符</li>
<li>所有的标识符都必须以<strong>字母、<code>$</code>或下划线<code>_</code><strong>开始；<strong>首字符之后</strong>还可以选择</strong>数字</strong>作为字符。</li>
<li>标识符中<strong>不能使用<code>#</code>、<code>*</code>、<code>-</code>等字符</strong></li>
<li>标识符是<strong>大小写敏感</strong>的</li>
</ul>
<hr>
<h2 id="数据类型"><a href="#数据类型" class="headerlink" title="数据类型"></a>数据类型</h2><ul>
<li><p>强类型语言</p>
<p>  要求变量的使用严格符合规定，<strong>变量都必须先定义再使用</strong>。Java就是强类型语言。</p>
</li>
<li><p>弱类型语言</p>
<p>  JavaScript就是弱类型语言。</p>
</li>
</ul>
<hr>
<h3 id="Java的数据类型分为两大类"><a href="#Java的数据类型分为两大类" class="headerlink" title="Java的数据类型分为两大类"></a>Java的数据类型分为两大类</h3><h4 id="基本类型-primitive-type-8个"><a href="#基本类型-primitive-type-8个" class="headerlink" title="基本类型(primitive type, 8个)"></a>基本类型(primitive type, 8个)</h4><ul>
<li><p>数值类型</p>
<ul>
<li><p>整数类型</p>
<table>
<thead>
<tr>
<th>整数类型</th>
<th>大小</th>
<th>表示范围</th>
</tr>
</thead>
<tbody><tr>
<td>byte</td>
<td>8位</td>
<td>-128($-2^7$) ~ 127($2^7-1$)</td>
</tr>
<tr>
<td>short</td>
<td>16位</td>
<td>$(-2^{15})$~$(2^{15}-1)$</td>
</tr>
<tr>
<td>int</td>
<td>32位</td>
<td>$(-2^{31})$~$(2^{31}-1)$</td>
</tr>
<tr>
<td>long</td>
<td>64位</td>
<td>$(-2^{63})$~$(2^{63}-1)$</td>
</tr>
</tbody></table>
<ul>
<li>long类型的变量，赋值时需要<strong>在最后加一个L</strong>，便于和int类型区分。(<strong>不加L也能通过编译，但是可读性差</strong>；<strong>小写的l辨识度低，可读性也差</strong>)</li>
<li>float类型的变量，赋值时<strong>必须在最后加一个F</strong></li>
</ul>
</li>
<li><p>浮点数类型</p>
<table>
<thead>
<tr>
<th>浮点类型</th>
<th>大小</th>
</tr>
</thead>
<tbody><tr>
<td>float</td>
<td>32位</td>
</tr>
<tr>
<td>double</td>
<td>64位</td>
</tr>
</tbody></table>
<p>最好<strong>完全不要使用浮点数进行比较</strong>，因为浮点数是<strong>有限位的、离散的、有舍入误差的</strong>数据类型。</p>
<p>那么银行类业务应该用什么数据类型<strong>表示钱</strong>？——<strong>数学工具类 BigDecimal</strong></p>
</li>
<li><p>字符类型</p>
<p>  char，<strong>16位</strong>，赋值使用<strong>单引号<code>&#39;&#39;</code></strong>。<strong>字符串String不是关键字</strong>，而<strong>是一个类</strong>，赋值使用<strong>双引号<code>&quot;&quot;</code></strong>。</p>
</li>
</ul>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">long</span> num1 <span class="token operator">=</span> <span class="token number">30L</span><span class="token punctuation">;</span> 
<span class="token keyword">float</span> num2 <span class="token operator">=</span> <span class="token number">3.14F</span><span class="token punctuation">;</span>
<span class="token keyword">char</span> c <span class="token operator">=</span> <span class="token char">'A'</span><span class="token punctuation">;</span>
<span class="token class-name">String</span> str <span class="token operator">=</span> <span class="token string">"AS"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>JDK7</strong>的特性：赋值时，<strong>可以用下划线<code>_</code>分割过长的数字</strong>(<strong>整数&amp;浮点数均可</strong>)，<strong>提高可读性</strong>。</p>
</li>
<li><p>布尔类型 boolean</p>
<p>  1位，值为<code>true/false</code>，由所占空间大小可知，**实际是使用(1&#x2F;0)**来表示。</p>
</li>
</ul>
<hr>
<h4 id="引用类型-reference-type"><a href="#引用类型-reference-type" class="headerlink" title="引用类型(reference type)"></a>引用类型(reference type)</h4><ul>
<li><p>类</p>
<ul>
<li><p>String</p>
<ul>
<li><p><strong>判断字符串是否相等</strong></p>
<p>  <code>str1.equals(str2)</code>（<strong>重写了继承自Object的方法</strong>）</p>
<p>  而不是通过<code>==</code>来判断，因为<strong>String</strong>是引用类型中的<strong>类</strong>，<code>==</code>作用于对象<strong>实际比较的是地址</strong>。</p>
</li>
<li><pre><code class="language-java">  String str = &quot;test&quot; // 实际等价于 String str = new String(&quot;test&quot;);
  <pre class="line-numbers language-none"><code class="language-none">  	
  		**不用创建对象的写法可以看作Java为了方便的设计，并不意味着String类是和char一样的基本类型**。

- 接口

- 数组

---

### 数据类型扩展

#### 不同进制整数的特殊表示方法

- **二**进制：**0b**开头
- **八**进制：**0**开头
- **十六**进制：**0x**开头

&#96;&#96;&#96;java
int num1 &#x3D; 0b101; &#x2F;&#x2F; 0b开头，2进制
int i &#x3D; 10;
int i2 &#x3D; 010; &#x2F;&#x2F; 0开头，8进制
int i3 &#x3D; 0x10F; &#x2F;&#x2F; 0x开头，16进制<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</code></pre>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<hr>
<h4 id="字符转换成数字后的输出"><a href="#字符转换成数字后的输出" class="headerlink" title="字符转换成数字后的输出"></a>字符转换成数字后的输出</h4><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">char</span> c1 <span class="token operator">=</span> <span class="token char">'a'</span><span class="token punctuation">;</span>
<span class="token keyword">char</span> c2 <span class="token operator">=</span> <span class="token char">'\u0061'</span> <span class="token comment">// \u为转义字符 Unicode,后跟4位16进制的数字，有对应的字符</span>
    
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>c1<span class="token punctuation">)</span><span class="token punctuation">;</span>
system<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>c1<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 强制类型转换</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out。<span class="token function">println</span><span class="token punctuation">(</span>c2<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h2 id="类型转换"><a href="#类型转换" class="headerlink" title="类型转换"></a>类型转换</h2><p>由于Java是<strong>强类型语言</strong>，所以<strong>进行某些运算</strong>的时候，需要用到类型转换。</p>
<hr>
<h3 id="基本数据类型的优先级"><a href="#基本数据类型的优先级" class="headerlink" title="基本数据类型的优先级"></a>基本数据类型的优先级</h3><pre class="line-numbers language-none"><code class="language-none">&#x2F;&#x2F; 低 --------------------------------------------&gt; 高
byte, short, char, int, long, float, double<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<ul>
<li>虽然float是32位表示，long是64位表示，但<strong>浮点数优先级就是比整数高</strong>。</li>
<li><strong>布尔类型不能进行强制转换</strong></li>
<li>对象类型<strong>不能转换为不相干的类型</strong></li>
<li>类型转换可能存在<strong>内存溢出</strong>或者<strong>精度问题</strong></li>
</ul>
<hr>
<h3 id="字符串连接符"><a href="#字符串连接符" class="headerlink" title="字符串连接符"></a>字符串连接符</h3><p><strong>String类型</strong>的操作数**+<strong>另外类型的操作数，会</strong>将其他类型的操作数都转换成Stirng类型**后再连接。</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">""</span> <span class="token operator">+</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 输出23</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">+</span> <span class="token number">3</span> <span class="token operator">+</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 输出5</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<hr>
<h2 id="变量、常量、作用域"><a href="#变量、常量、作用域" class="headerlink" title="变量、常量、作用域"></a>变量、常量、作用域</h2><h3 id="变量-Variable"><a href="#变量-Variable" class="headerlink" title="变量 Variable"></a>变量 Variable</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// 数据类型 变量名 = 值</span>
type varName <span class="token punctuation">[</span><span class="token operator">=</span>value<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token punctuation">&#123;</span><span class="token punctuation">,</span> varName<span class="token punctuation">[</span><span class="token operator">=</span>value<span class="token punctuation">]</span><span class="token punctuation">&#125;</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<ul>
<li><p>可以使用逗号隔开来声明多个同类型的变量，但是<strong>不建议这样操作</strong>（后续查找、修改的操作会变得麻烦，可读性差）。</p>
</li>
<li><p><strong>变量的默认初始化</strong></p>
<ul>
<li><p>基本数据类型：</p>
<ul>
<li>整数类型：0</li>
<li>浮点数类型：0.0</li>
<li>字符类型：’\u0000’</li>
<li>布尔类型：false</li>
</ul>
</li>
<li><p>引用数据类型：</p>
<p>  默认初始化为<strong>空值null</strong>，如String。</p>
</li>
</ul>
</li>
</ul>
<hr>
<h3 id="作用域"><a href="#作用域" class="headerlink" title="作用域"></a>作用域</h3><ul>
<li>类变量：<strong>从属于类</strong>，使用<strong>关键字static</strong>修饰</li>
<li>实例变量：<strong>从属于对象</strong>，需要创建出对象后，才能使用</li>
<li>局部变量：<strong>位于方法中</strong></li>
</ul>
<p>e.g. 见Demo1.java文件</p>
<hr>
<h3 id="常量-Constant"><a href="#常量-Constant" class="headerlink" title="常量 Constant"></a>常量 Constant</h3><ul>
<li><strong>初始化后不能更改</strong>，使用<strong>关键字final</strong>修饰；</li>
</ul>
<hr>
<h3 id="修饰符不存在先后顺序"><a href="#修饰符不存在先后顺序" class="headerlink" title="修饰符不存在先后顺序"></a>修饰符不存在先后顺序</h3><p>e.g.  以下两种写法等效</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">double</span> <span class="token constant">PI</span> <span class="token operator">=</span> <span class="token number">3.14</span><span class="token punctuation">;</span>
<span class="token keyword">static</span> <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">double</span> <span class="token constant">PI</span> <span class="token operator">=</span> <span class="token number">3.14</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<hr>
<h3 id="变量和常量的命名规范"><a href="#变量和常量的命名规范" class="headerlink" title="变量和常量的命名规范"></a>变量和常量的命名规范</h3><ul>
<li><p>变量</p>
<ul>
<li><strong>首字母小写</strong>和<strong>驼峰原则</strong>：monthSalary</li>
<li>方法名的规范同变量名</li>
<li>类名要求<strong>首字母大写</strong>和驼峰原则</li>
</ul>
</li>
<li><p>常量</p>
<p>  常量一般用<strong>大写字母和下划线命名</strong>，便于和变量区分，提高可读性；</p>
</li>
</ul>
<hr>
<h2 id="Math类"><a href="#Math类" class="headerlink" title="Math类"></a>Math类</h2><p>很多运算，我们会使用一些工具类来操作。</p>
<ul>
<li><p><code>pow(double a, double b)</code></p>
<p>  返回一个结果为$a^b$的double值</p>
</li>
</ul>
<hr>
<h2 id="运算符"><a href="#运算符" class="headerlink" title="运算符"></a>运算符</h2><h3 id="位运算符"><a href="#位运算符" class="headerlink" title="位运算符"></a>位运算符</h3><p>位运算<strong>与普通的四则运算相比</strong>，<strong>执行效率高很多</strong>，因为位运算是<strong>直接以计算机底层的运行机制为基础</strong>操作的。</p>
<ul>
<li><p><code>&amp;</code> <strong>与</strong></p>
</li>
<li><p><code>|</code> <strong>或</strong></p>
</li>
<li><p><code>~</code> <strong>取反</strong></p>
</li>
<li><p><strong>移位运算符</strong></p>
<ul>
<li><p><code>&lt;&lt;</code> 左移</p>
<p>  每移1位，等效于<code>*2</code></p>
</li>
<li><p><code>&gt;&gt;</code> 右移</p>
<p>  每移1位，等效于<code>/2</code></p>
</li>
</ul>
</li>
</ul>
<hr>
<h3 id="三元运算符x-y-z"><a href="#三元运算符x-y-z" class="headerlink" title="三元运算符x?y:z"></a>三元运算符<code>x?y:z</code></h3><p>如果<code>x == true</code>，结果为<code>y</code>，否则结果为<code>z</code></p>
<hr>
<h2 id="包机制"><a href="#包机制" class="headerlink" title="包机制"></a>包机制</h2><p>为了更好地<strong>组织类</strong>，Java提供了包机制，用于区别<strong>类名的命名空间</strong>，<strong>包的本质 &#x3D;&#x3D; 文件夹</strong>。</p>
<ul>
<li><p>一般利用<strong>公司域名倒置</strong>作为包名</p>
<p>  如<code>com.hunter</code></p>
</li>
<li><p>包语句的语法格式</p>
  <pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">package1</span><span class="token punctuation">[</span><span class="token punctuation">.</span>pkg2<span class="token punctuation">[</span><span class="token punctuation">.</span>pkg3<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>  必须是类文件中的<strong>首句</strong>。</p>
</li>
<li><p>为了能够<strong>使用某一个包的成员</strong>，需要在Java文件中<strong>使用import语句</strong>明确<strong>导入该包</strong></p>
  <pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">import</span> <span class="token namespace">package1</span><span class="token punctuation">[</span><span class="token punctuation">.</span>pkg2<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token punctuation">(</span>classname<span class="token operator">|</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// *是通配符，导入指定包下所有的类</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li><p>尽量不要让不同包下的类名重复</p>
<p>  在<strong>同一个类文件</strong>中，无法使用位于<strong>不同包下相同类名</strong>的类(会<strong>报错</strong>)</p>
</li>
</ul>
<hr>
<h2 id="JavaDoc生成文档"><a href="#JavaDoc生成文档" class="headerlink" title="JavaDoc生成文档"></a>JavaDoc生成文档</h2><ul>
<li><p><code>javadoc</code>命令是用来<strong>生成API文档</strong>的</p>
</li>
<li><p><strong>文档注释</strong></p>
  <pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/**
*
* 
*/</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li>加在类上就是<strong>类注释</strong></li>
<li>加在方法上就是<strong>方法注释</strong></li>
</ul>
</li>
<li><p><strong>参数</strong>信息</p>
<ul>
<li>@auther 作者名</li>
<li>@version <strong>项目</strong>版本号</li>
<li>@since 指明需要最早使用的<strong>jdk版本</strong></li>
<li>@param 参数名</li>
<li>@return 返回值情况</li>
<li>@throw 异常抛出情况</li>
</ul>
</li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://hunter1023.github.io/2021/03/08/Java%E5%85%A5%E9%97%A8%E5%8F%8A%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Hunter">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Talk is cheap">
      <meta itemprop="description" content="Tough times never last, but tough people do.">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Talk is cheap">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/03/08/Java%E5%85%A5%E9%97%A8%E5%8F%8A%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/" class="post-title-link" itemprop="url">Java入门及环境搭建</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2021-03-08 23:05:56" itemprop="dateCreated datePublished" datetime="2021-03-08T23:05:56+08:00">2021-03-08</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-01-23 23:29:13" itemprop="dateModified" datetime="2025-01-23T23:29:13+08:00">2025-01-23</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Java%E5%85%A8%E6%A0%88/" itemprop="url" rel="index"><span itemprop="name">Java全栈</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Java%E5%85%A8%E6%A0%88/JavaSE/" itemprop="url" rel="index"><span itemprop="name">JavaSE</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="卸载JDK"><a href="#卸载JDK" class="headerlink" title="卸载JDK"></a>卸载JDK</h2><ol>
<li>删除Java的安装目录及其下所有文件</li>
<li>删除<strong>系统环境变量</strong> - JAVA_HOME</li>
<li>删除<strong>系统环境变量Path</strong>下关于Java的目录</li>
<li>通过<code>java -version</code>命令，验证是否成功卸载(报错即成功卸载)</li>
</ol>
<hr>
<h2 id="安装JDK"><a href="#安装JDK" class="headerlink" title="安装JDK"></a>安装JDK</h2><ol>
<li>下载JDK 8</li>
<li>双击安装JDK</li>
<li><strong>记住安装的路径</strong></li>
</ol>
<h3 id="配置环境变量"><a href="#配置环境变量" class="headerlink" title="配置环境变量"></a>配置环境变量</h3><ol>
<li><p>我的电脑 - 右键 - 属性 - 高级系统设置 - 环境变量</p>
</li>
<li><p><strong>系统变量</strong> - 新建 </p>
<ol>
<li>变量名：<code>JAVA_HOME</code></li>
<li>变量值：<code>C:\Program Files\Java\jdk1.8.0_201</code></li>
</ol>
</li>
<li><p><strong>系统变量</strong> - Path - 编辑 - 新建</p>
<ul>
<li>输入<code>%JAVA_HOME%\bin</code>（<code>%%</code>的作用：<strong>引用路径</strong>）</li>
<li>输入<code>%JAVA_HOME%\jre\bin</code></li>
</ul>
<p> 确定，保存。</p>
</li>
<li><p>测试JDK是否安装成功</p>
<p> 打开命令行，输入<code>java -version</code></p>
</li>
</ol>
<hr>
<h2 id="Hello-World-及-简单语法规则"><a href="#Hello-World-及-简单语法规则" class="headerlink" title="Hello World 及 简单语法规则"></a>Hello World 及 简单语法规则</h2><ol>
<li><p>创建一个java文件</p>
<ul>
<li>文件后缀名为<code>.java</code></li>
</ul>
</li>
<li><p>编写代码</p>
 <pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Hello</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
         <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"Hello, World!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>编译java文件</p>
<p> <code>javac xxx.java</code>，会生成一个class文件</p>
</li>
<li><p>运行class文件</p>
<p> <code>java xxx</code>(<strong>不写文件类型后缀</strong>)</p>
</li>
</ol>
<h3 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h3><ol>
<li>Java是严格<strong>区分大小写</strong>的</li>
<li><strong>文件名</strong>和<strong>类名</strong>必须<strong>保持一致</strong>，并且<strong>首字母大写</strong></li>
</ol>
<hr>
<h2 id="Java程序运行机制"><a href="#Java程序运行机制" class="headerlink" title="Java程序运行机制"></a>Java程序运行机制</h2><p><img src="https://i.loli.net/2021/03/09/uLsJEczonA53mKD.png"></p>
<hr>
<h2 id="使用IDEA"><a href="#使用IDEA" class="headerlink" title="使用IDEA"></a>使用IDEA</h2><h3 id="什么是IDE"><a href="#什么是IDE" class="headerlink" title="什么是IDE"></a>什么是IDE</h3><p>IDE(Integrated Development Environment，集成开发环境)</p>
<hr>
<h3 id="IDEA-使用技巧"><a href="#IDEA-使用技巧" class="headerlink" title="IDEA 使用技巧"></a>IDEA 使用技巧</h3>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://hunter1023.github.io/2020/10/11/%E9%82%AE%E4%BB%B6%E7%AE%A1%E7%90%86%E6%8A%80%E5%B7%A7/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Hunter">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Talk is cheap">
      <meta itemprop="description" content="Tough times never last, but tough people do.">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Talk is cheap">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/10/11/%E9%82%AE%E4%BB%B6%E7%AE%A1%E7%90%86%E6%8A%80%E5%B7%A7/" class="post-title-link" itemprop="url">Outlook邮件管理技巧</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-10-11 18:19:45" itemprop="dateCreated datePublished" datetime="2020-10-11T18:19:45+08:00">2020-10-11</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-01-23 23:29:13" itemprop="dateModified" datetime="2025-01-23T23:29:13+08:00">2025-01-23</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E4%B8%8E%E8%BD%AF%E4%BB%B6/" itemprop="url" rel="index"><span itemprop="name">操作系统与软件</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="如何管理邮件"><a href="#如何管理邮件" class="headerlink" title="如何管理邮件"></a>如何管理邮件</h2><p>在**收件箱(inbox)**创建3个子文件夹：</p>
<ul>
<li><p>Action 1.【行动】</p>
<p>  存放<strong>需要我做出执行</strong>的邮件。</p>
<p>  在其中将邮件按紧急程度归类。</p>
<ul>
<li><strong>紧急</strong>（需<strong>当天执行</strong>）</li>
<li><strong>不紧急</strong></li>
<li><strong>他人响应后处理</strong></li>
</ul>
<p>  <strong>按类别排序</strong>，可以让你<strong>按不同的紧急程度来浏览处理邮件</strong></p>
</li>
<li><p>Read【阅读】</p>
<p>  需要花时间去仔细阅读，但<strong>不需要我做出回复</strong></p>
</li>
<li><p>Archive【存档】</p>
<ul>
<li><strong>涉及基础需要</strong>的邮件</li>
<li><strong>不想删除</strong>的邮件</li>
</ul>
<p>  通过<strong>会话的排序规则</strong>来整理这个文件夹，能对这些邮件沟通<strong>有一个宏观的回顾</strong>，同时<strong>隔离掉相同的邮件会话内容</strong>。</p>
</li>
</ul>
<hr>
<h2 id="创建类别"><a href="#创建类别" class="headerlink" title="创建类别"></a>创建类别</h2><p>类别能<strong>将邮件、任务、日历、会议等功能都实现分组</strong>。（类别<strong>不只对应邮件</strong>）</p>
<p>创建类别的方式：</p>
<ol>
<li><p>导航栏 - 类别 - 管理类别 </p>
</li>
<li><p>选中<strong>红色</strong>类别，重命名为<strong>紧急</strong></p>
</li>
<li><p>选中<strong>橙色</strong>类别，重命名为<strong>不紧急</strong></p>
</li>
<li><p>选中蓝色类别，重命名为<strong>他人响应后处理</strong></p>
</li>
</ol>
<hr>
<h2 id="创建和运用快速步骤"><a href="#创建和运用快速步骤" class="headerlink" title="创建和运用快速步骤"></a>创建和运用快速步骤</h2><p>拖曳的方式移动邮件、邮件，过于低效累人。</p>
<p>利用<strong>快速步骤（Quick Steps）</strong>，能够快速完成邮件的整理，从而易于思考和行动。</p>
<p><img src="https://i.loli.net/2020/10/11/AQsZ6a9OvzRNdVn.png" alt="快速步骤"></p>
<p>点击快速步骤面板右下角的小箭头，对快速步骤进行管理设置。</p>
<h3 id="移动邮件"><a href="#移动邮件" class="headerlink" title="移动邮件"></a>移动邮件</h3><ol>
<li>选择移动邮件(move to ?) - 编辑 - 命名为【存档】</li>
<li>选中<strong>移至文件夹</strong>指令，再选中已创建的【存档】文件夹</li>
<li>想把【存档】文件夹里的邮件标记为已读，所以选中<strong>已读标记</strong>。</li>
<li><strong>添加动作</strong> - Clear Categories）</li>
<li><strong>添加动作</strong> - Clear flags on message</li>
<li>保存</li>
</ol>
<p><strong>删除其余用不到的快速步骤</strong>。</p>
<hr>
<h3 id="创建新的快速步骤执行指令"><a href="#创建新的快速步骤执行指令" class="headerlink" title="创建新的快速步骤执行指令"></a>创建新的快速步骤执行指令</h3><ul>
<li>新建 - xxx - 命名为【行动 - <strong>紧急</strong>】</li>
<li>换一个图标，如<strong>惊叹号</strong></li>
<li>选中<strong>移至文件夹</strong>指令，选中【行动】文件夹</li>
<li>添加动作 - Flag Message - today</li>
<li>添加动作 - categories message - 紧急</li>
<li>完成</li>
</ul>
<p>以此类推，【行动 - 不紧急】：</p>
<ul>
<li>把图标换为<strong>旗帜</strong></li>
<li>添加动作 - Flag Message - this week</li>
<li>添加动作 - categories message - 不紧急</li>
</ul>
<p>【行动 - <strong>他人响应后处理</strong>】：</p>
<ul>
<li>把图标换为<strong>信息</strong>（一个i)</li>
<li>添加动作 - Flag Message - no date</li>
<li>添加动作 - categories message - 他人响应后处理</li>
</ul>
<p>【阅读】</p>
<ul>
<li>把图标换为<strong>书本</strong>（一个i)</li>
<li>不用添加动作</li>
</ul>
<hr>
<h2 id="【行动】文件夹里各类别邮件的日程安排"><a href="#【行动】文件夹里各类别邮件的日程安排" class="headerlink" title="【行动】文件夹里各类别邮件的日程安排"></a>【行动】文件夹里各类别邮件的日程安排</h2><p>当通过上述操作整理好邮件后，就能真正专注于处理【行动】文件夹中的邮件。</p>
<p>例如有些邮件是<strong>不紧急</strong>的，但接下来几个小时里我无法跟进，就<strong>需要安排进我的日程中</strong>，从而<strong>避免忘记或影响当前的工作</strong>。</p>
<p>将邮件<strong>转为日历</strong>只需<strong>拖住该封邮件到日历选项</strong>即可。</p>
<ul>
<li>单击导航栏 - 计划（scheduling）</li>
<li>单击 自动选取下一个（autopick next）按钮，让我能在我的日程中快速找到下一个空闲的时间段，保存并关闭。</li>
</ul>
<hr>
<h2 id="定制outlook的启动文件夹视图"><a href="#定制outlook的启动文件夹视图" class="headerlink" title="定制outlook的启动文件夹视图"></a>定制outlook的启动文件夹视图</h2><p>如果<strong>想始终将精力放在最重要的事情上，最好的方法就是定制outlook视图</strong>。就是先看到、处理【行动】文件夹里的内容。</p>
<p>文件 - 选项 - 高级 - outlook启动和退出 - 在此文件夹中启动outlook - 浏览 - 找到【行动】文件夹，确定即可。</p>
<hr>
<h2 id="处理邮件的4D决策模型"><a href="#处理邮件的4D决策模型" class="headerlink" title="处理邮件的4D决策模型"></a>处理邮件的4D决策模型</h2><p><strong>理想状态</strong>下，阅读邮件的时间安排：</p>
<ol>
<li>早上 9：00 - 10：00 (1个小时)</li>
<li>下午1：30 - 2：00 (半个小时)</li>
<li>当天工作结束后，半个小时</li>
</ol>
<p>大多数人好奇或习惯<strong>不停查看收件箱</strong>，但这一行为会让自己变得<strong>非常低效</strong>，因为<strong>无法专注在优先级的工作上</strong>。这意味着，每个时间段处理邮件<strong>需要快速做出决策</strong>。</p>
<p>4D决策模型：</p>
<ol>
<li><p>Delete it <strong>删除</strong>(<strong>归档</strong>)</p>
</li>
<li><p>Do it <strong>执行</strong></p>
<p> 2分钟问题(2-minute drill)，针对<strong>当前邮件我需要采取的行动</strong>能<strong>在两分钟内完成</strong>吗？</p>
<p> 如果可以，就立即执行。如果能在两分钟内完成任务，就不需要关闭电子邮件或退出outlook</p>
</li>
<li><p>Delegate it <strong>委派</strong></p>
<p> 2-minute drill答案为否时，能转发给一个合适的团队成员来处理吗？</p>
<p> 如果是，就花两分钟时间撰写要求、情况并<strong>转发出去</strong>。然后就可以将邮件<strong>归档以便追踪</strong>。</p>
</li>
<li><p>Defer it <strong>推迟</strong></p>
<p> 上述3D都无法完成，这意味着<strong>邮件中要求的工作只有自己才能完成，而且需要2分钟以上的时间来处理的事务 <strong>。那么就需要推迟它，在查阅处理完邮件再去执行它。进行推迟操作时，记得</strong>将这些讯息用相应的快速步骤标记类别</strong>到【行动】文件夹。</p>
</li>
</ol>
<p><strong>每天运用4D决策模型，就能很容易、快速地完成大量的邮件处理</strong>。</p>
<hr>
<h2 id="创建邮件规则"><a href="#创建邮件规则" class="headerlink" title="创建邮件规则"></a>创建邮件规则</h2><p>处理<strong>灰色邮件</strong>(广告、垃圾邮件)</p>
<p>……</p>
<hr>
<p>摘取自：<a target="_blank" rel="noopener" href="https://v.qq.com/x/page/m0151orvisv.html">借助Outlook最大化提升你的个人工作生产力①_腾讯视频</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://hunter1023.github.io/2020/07/03/Python%E5%9F%BA%E7%A1%80%E7%BB%83%E4%B9%A0%E9%A2%98/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Hunter">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Talk is cheap">
      <meta itemprop="description" content="Tough times never last, but tough people do.">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Talk is cheap">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/07/03/Python%E5%9F%BA%E7%A1%80%E7%BB%83%E4%B9%A0%E9%A2%98/" class="post-title-link" itemprop="url">Python基础练习题</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-07-03 18:02:58" itemprop="dateCreated datePublished" datetime="2020-07-03T18:02:58+08:00">2020-07-03</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-01-23 23:29:13" itemprop="dateModified" datetime="2025-01-23T23:29:13+08:00">2025-01-23</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Python/" itemprop="url" rel="index"><span itemprop="name">Python</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="求三位数组合"><a href="#求三位数组合" class="headerlink" title="求三位数组合"></a>求三位数组合</h2><p>已知有一个list，里面有<strong>4个数字</strong>，分别是3，6，2，7 ，这四个数字<strong>能组成多少个互不相同且无重复数字的三位数</strong>？比如362算一个，326算一个，请逐个输出他们。</p>
<hr>
<p><strong>分析</strong></p>
<ol>
<li>三层嵌套循环，<strong>每一层循环从list中取出一个数字</strong>，这三个数字组成一个三位数</li>
<li>需要对取出来的三个数字进行<strong>去重</strong></li>
</ol>
<hr>
<p><strong>解答</strong></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#coding=utf-8</span>
lst <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">]</span>
number_lst <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> lst<span class="token punctuation">:</span>
   <span class="token keyword">for</span> j <span class="token keyword">in</span> lst<span class="token punctuation">:</span>
       <span class="token keyword">for</span> k <span class="token keyword">in</span> lst<span class="token punctuation">:</span>
           <span class="token keyword">if</span> i <span class="token operator">!=</span> j <span class="token keyword">and</span> i <span class="token operator">!=</span> k <span class="token keyword">and</span> j <span class="token operator">!=</span> k<span class="token punctuation">:</span> <span class="token comment"># 去重</span>
               number_lst<span class="token punctuation">.</span>append<span class="token punctuation">(</span>
			       <span class="token string">'&#123;first&#125;&#123;second&#125;&#123;third&#125;'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>
            	   first<span class="token operator">=</span>i<span class="token punctuation">,</span> second<span class="token operator">=</span>j<span class="token punctuation">,</span> third<span class="token operator">=</span>k<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'共有&#123;count&#125;个符合条件的数字'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>
   count<span class="token operator">=</span><span class="token builtin">len</span><span class="token punctuation">(</span>number_lst<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> item <span class="token keyword">in</span> number_lst<span class="token punctuation">:</span>
   <span class="token keyword">print</span> item<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>小结</strong></p>
<p>注意字符串format的用法，首先要在字符串里定义哪个区域是需要被替换的，并在大括号里定义一个名字，然后在format函数的参数里指明这个名字被谁替换</p>
<hr>
<h2 id="完全平方数"><a href="#完全平方数" class="headerlink" title="完全平方数"></a>完全平方数</h2><ol>
<li>打印10000以内的完全平方数</li>
<li>如果一个数<strong>加100</strong>是一个完全平方数，<strong>加268</strong>也是一个完全平方数，求10000以内所有符合这个要求的数值</li>
</ol>
<hr>
<p><strong>解答</strong></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 第一题 方法一</span>
numbers <span class="token operator">=</span> <span class="token punctuation">[</span>x<span class="token operator">*</span>x <span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10001</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> num <span class="token keyword">in</span> numbers<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span>
    
<span class="token comment"># 第一题 方法二</span>
num <span class="token operator">=</span> <span class="token number">1</span>
<span class="token keyword">while</span>  num <span class="token operator">&lt;</span> <span class="token number">10001</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>num<span class="token operator">*</span>num<span class="token punctuation">)</span>
    num <span class="token operator">+=</span> <span class="token number">1</span>
    
<span class="token comment"># 第二题</span>
num <span class="token operator">=</span> <span class="token number">1</span>
squares <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
    square <span class="token operator">=</span> num<span class="token operator">*</span>num
    <span class="token keyword">if</span> square <span class="token operator">></span> <span class="token number">10268</span><span class="token punctuation">:</span>
        <span class="token keyword">break</span>
    num <span class="token operator">+=</span> <span class="token number">1</span>
    squares<span class="token punctuation">.</span>append<span class="token punctuation">(</span>square<span class="token punctuation">)</span>

<span class="token keyword">for</span> square <span class="token keyword">in</span> squares<span class="token punctuation">:</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>square <span class="token operator">+</span> <span class="token number">168</span><span class="token punctuation">)</span> <span class="token keyword">in</span> squares<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>square <span class="token operator">-</span> <span class="token number">100</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li>有一个数，假设加100后的值为A，加268之后的值是B，根据题目要求，A和B都是完全平方数，那么B-A &#x3D; 168</li>
<li>程序先找出10268以内的所有完全平方数，然后遍历，如果一个完全平方数加168 以后还是完全平方数，那么这个完全平方数减去100，就是要找的数值</li>
</ul>
<hr>
<h2 id="打印乘法口诀表"><a href="#打印乘法口诀表" class="headerlink" title="打印乘法口诀表"></a>打印乘法口诀表</h2><p>打印乘法口诀表，效果如下表所示：</p>
<pre class="line-numbers language-none"><code class="language-none">1*1 &#x3D; 1  
1*2 &#x3D; 2 	2*2 &#x3D; 4  
1*3 &#x3D; 3 	2*3 &#x3D; 6 	3*3 &#x3D; 9  
1*4 &#x3D; 4 	2*4 &#x3D; 8 	3*4 &#x3D; 12 	4*4 &#x3D; 16  
1*5 &#x3D; 5 	2*5 &#x3D; 10	3*5 &#x3D; 15 	4*5 &#x3D; 20 	5*5 &#x3D; 25  
1*6 &#x3D; 6 	2*6 &#x3D; 12 	3*6 &#x3D; 18 	4*6 &#x3D; 24 	5*6 &#x3D; 30 	6*6 &#x3D; 36  
1*7 &#x3D; 7 	2*7 &#x3D; 14 	3*7 &#x3D; 21 	4*7 &#x3D; 28 	5*7 &#x3D; 35 	6*7 &#x3D; 42 	7*7 &#x3D; 49  
1*8 &#x3D; 8 	2*8 &#x3D; 16 	3*8 &#x3D; 24 	4*8 &#x3D; 32 	5*8 &#x3D; 40 	6*8 &#x3D; 48 	7*8 &#x3D; 56 	8*8 &#x3D; 64  
1*9 &#x3D; 9 	2*9 &#x3D; 18 	3*9 &#x3D; 27 	4*9 &#x3D; 36 	5*9 &#x3D; 45 	6*9 &#x3D; 54 	7*9 &#x3D; 63 	8*9 &#x3D; 72 	9*9 &#x3D; 81<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<p><strong>解答</strong></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">get_line</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span><span class="token punctuation">:</span>
    line <span class="token operator">=</span> <span class="token string">""</span>
    str_foramt <span class="token operator">=</span> <span class="token string">"&#123;left&#125;*&#123;right&#125; = &#123;result&#125;"</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> number<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> i <span class="token operator">!=</span> <span class="token number">1</span><span class="token punctuation">:</span>
            line <span class="token operator">+=</span> <span class="token string">" \t"</span>
        line <span class="token operator">+=</span> str_foramt<span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>left<span class="token operator">=</span>i<span class="token punctuation">,</span> right<span class="token operator">=</span>number<span class="token punctuation">,</span> result<span class="token operator">=</span>i<span class="token operator">*</span>number<span class="token punctuation">)</span>
    <span class="token keyword">return</span> line

<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>get_line<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h2 id="输出水仙花数"><a href="#输出水仙花数" class="headerlink" title="输出水仙花数"></a>输出水仙花数</h2><p><strong>题目</strong></p>
<p>输出所有的水仙花数，所谓<strong>水仙花数是指一个三位数</strong>，<strong>各个位上的数的立方相加在一起等于这个三位数</strong>。比如153，1的3次方 + 5的三次方 + 3的三次方 等于153。</p>
<hr>
<p><strong>解答</strong></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">for</span> n <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    i <span class="token operator">=</span> n <span class="token operator">/</span> <span class="token number">100</span>         <span class="token comment"># 获取百位数</span>
    j <span class="token operator">=</span> n <span class="token operator">/</span> <span class="token number">10</span> <span class="token operator">%</span> <span class="token number">10</span>     <span class="token comment"># 获取十位数</span>
    k <span class="token operator">=</span> n <span class="token operator">%</span> <span class="token number">10</span>          <span class="token comment"># 获取个位数</span>
    <span class="token keyword">if</span> n <span class="token operator">==</span> i<span class="token operator">**</span><span class="token number">3</span> <span class="token operator">+</span> j<span class="token operator">**</span><span class="token number">3</span> <span class="token operator">+</span> k<span class="token operator">**</span><span class="token number">3</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h2 id="输出学生分数的考评等级"><a href="#输出学生分数的考评等级" class="headerlink" title="输出学生分数的考评等级"></a>输出学生分数的考评等级</h2><p>允许用户从终端输入一个分数，程序输出这个分数所属的考评等级，90到100分是A，60到89是B，60分以下是C</p>
<hr>
<p><strong>解答</strong></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
    scores <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"请输入分数："</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    
    <span class="token keyword">if</span> scores <span class="token operator">>=</span> <span class="token number">90</span> <span class="token keyword">and</span> scores <span class="token operator">&lt;=</span> <span class="token number">100</span><span class="token punctuation">:</span>
        grade <span class="token operator">=</span> <span class="token string">'A'</span>
    <span class="token keyword">elif</span> scores <span class="token operator">>=</span> <span class="token number">60</span><span class="token punctuation">:</span>
        grade <span class="token operator">=</span> <span class="token string">'B'</span>
    <span class="token keyword">elif</span> scores <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">:</span>
        grade <span class="token operator">=</span> <span class="token string">'C'</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">break</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>grade<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>


      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://hunter1023.github.io/2020/06/28/Python%E9%A1%B9%E7%9B%AE%E2%80%94%E2%80%94%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Hunter">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Talk is cheap">
      <meta itemprop="description" content="Tough times never last, but tough people do.">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Talk is cheap">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/06/28/Python%E9%A1%B9%E7%9B%AE%E2%80%94%E2%80%94%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96/" class="post-title-link" itemprop="url">Python项目——数据可视化</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-06-28 11:45:57" itemprop="dateCreated datePublished" datetime="2020-06-28T11:45:57+08:00">2020-06-28</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-01-23 23:29:13" itemprop="dateModified" datetime="2025-01-23T23:29:13+08:00">2025-01-23</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Python/" itemprop="url" rel="index"><span itemprop="name">Python</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Python/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/" itemprop="url" rel="index"><span itemprop="name">数据分析</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="生成数据"><a href="#生成数据" class="headerlink" title="生成数据"></a>生成数据</h2><ul>
<li>数据<strong>可视化</strong>：通过可视化表示来探索数据</li>
<li>数据<strong>挖掘</strong>：使用代码来探索<strong>数据集的规律和关联</strong></li>
</ul>
<h3 id="安装-matplotlib"><a href="#安装-matplotlib" class="headerlink" title="安装 matplotlib"></a>安装 matplotlib</h3><h4 id="pip"><a href="#pip" class="headerlink" title="pip"></a>pip</h4><p><strong>pip</strong>是一个以Python写成的<strong>软件包管理系统</strong>，它可以<strong>安装和管理软件包</strong>。</p>
<p>大多数较新的Python版本都自带pip，因此首先可检查系统是否已经安装了pip。</p>
<ul>
<li><p>在Windows系统中检查是否安装了pip</p>
<p>  打开一个终端窗口，并执行如下命令：</p>
  <pre class="line-numbers language-none"><code class="language-none">&gt; python -m pip --version
pip 20.1.1 from C:\Users\Hunter\AppData\Local\Programs\Python\Python38-32\lib\site-packages\pip (python 3.8)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li>
</ul>
<hr>
<h4 id="在-Windows-系统中安装-matplotlib"><a href="#在-Windows-系统中安装-matplotlib" class="headerlink" title="在 Windows 系统中安装 matplotlib"></a>在 Windows 系统中安装 matplotlib</h4><p>在Windows系统中，首先需要<strong>安装Visual Studio</strong>。接下来，访问<a target="_blank" rel="noopener" href="https://pypi.org/project/matplotlib/#files">matplotlib · PyPI</a>，查找与使用的Python版本、操作系统相匹配的<code>.whl</code>文件。</p>
<p>将这个<code>.whl</code>文件复制到<strong>项目所在文件夹</strong>，打开命令窗口，使用pip来安装matplotlib:</p>
<pre class="line-numbers language-none"><code class="language-none">python -m pip install --user matplotlib-3.2.2-cp38-cp38-win32.whl<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<hr>
<h4 id="测试-matplotlib"><a href="#测试-matplotlib" class="headerlink" title="测试 matplotlib"></a>测试 matplotlib</h4><p>安装必要的包后，对安装进行测试。为此，首先使用命令python或python3启动一个终端会话，再尝试导入matplotlib:</p>
<pre class="line-numbers language-none"><code class="language-none">$ python3
&gt;&gt;&gt; import matplotlib<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>如果<strong>没有出现任何错误消息，就说明成功安装了 matplotlib</strong>。</p>
<hr>
<h3 id="绘制简单的折线图"><a href="#绘制简单的折线图" class="headerlink" title="绘制简单的折线图"></a>绘制简单的折线图</h3><p>我们将使用平方数序列1、4、9、16和25来绘制这个图表。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt

<span class="token operator">%</span>matplotlib inline <span class="token comment"># 让生成的图形嵌入jupyter notebook中</span>

    squares <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">]</span>
    plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>squares<span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li><p><strong>模块pyplot</strong>包含很多用于生成图表的函数。</p>
</li>
<li><p><code>plt.show()</code>打开<strong>matplotlib查看器</strong>，并显示绘制的图形。查看器能够<strong>缩放和导航图形</strong>，另外，<strong>单击磁盘图表可将图形保存起来</strong>。</p>
</li>
</ul>
<h4 id="修改标签文字和线条粗细"><a href="#修改标签文字和线条粗细" class="headerlink" title="修改标签文字和线条粗细"></a>修改标签文字和线条粗细</h4><p>上述代码通过matplotlib查看器显示的图形，<strong>标签文字太小、线条太细</strong>。下面通过一些定制来改善这个图形的可读性：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt

squares <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">]</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>squares<span class="token punctuation">,</span> linewidth<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span>

<span class="token comment"># 设置图表标题，并给坐标轴加上标签</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">"Square Numbers"</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">24</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">"Value"</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">14</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">"Square of Value"</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">14</span><span class="token punctuation">)</span>

<span class="token comment"># 设置刻度标记的大小</span>
plt<span class="token punctuation">.</span>tick_params<span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token string">'both'</span><span class="token punctuation">,</span> labelsize<span class="token operator">=</span><span class="token number">14</span><span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li><strong>参数linewidth</strong>决定了<code>plot()</code>绘制的<strong>线条的粗细</strong></li>
<li>函数<code>title()</code>给图表<strong>指定标题</strong></li>
<li>参数fontsize指定了图表中<strong>文字的大小</strong></li>
<li>函数<code>xlabel()</code>和<code>ylabel()</code></li>
<li>函数<code>tick_params()</code>设置<strong>刻度的样式</strong></li>
</ul>
<hr>
<h4 id="校正图形"><a href="#校正图形" class="headerlink" title="校正图形"></a>校正图形</h4><p>图形更容易阅读后，我们发现<strong>没有正确地绘制数据</strong>：折线图的终点指出4.0的平方为25。下面来修复这个问题。</p>
<p><strong>当你向<code>plot()</code>提供一系列数字时，它假设第一个数据点对应的x坐标值为0</strong>，但我们的第一个点对应的x值为1。为改变这种默认行为，我们可以给<code>plot()</code><strong>同时提供输入值和输出值</strong>：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt

input_values <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span>
squares <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">]</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>input_values<span class="token punctuation">,</span> squares<span class="token punctuation">,</span> linewidth<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span>

<span class="token comment"># 设置图表标题，并给坐标轴加上标签</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">"Square Numbers"</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">24</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">"Value"</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">14</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">"Square of Value"</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">14</span><span class="token punctuation">)</span>

<span class="token comment"># 设置刻度标记的大小</span>
plt<span class="token punctuation">.</span>tick_params<span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token string">'both'</span><span class="token punctuation">,</span> labelsize<span class="token operator">=</span><span class="token number">14</span><span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h4 id="使用-scatter-绘制散点图并设置其样式"><a href="#使用-scatter-绘制散点图并设置其样式" class="headerlink" title="使用 scatter() 绘制散点图并设置其样式"></a>使用 <code>scatter()</code> 绘制散点图并设置其样式</h4><p>有时候，需要<strong>绘制散点图</strong>并<strong>设置各个数据点的样式</strong>。例如，你可能想<strong>以一种颜色显示较小的值</strong>，用<strong>另一种颜色显示较大的值</strong>。绘制大型数据集时，还可以<strong>对每个点都设置相同的样式，再使用不同的样式选项重新绘制某些点，以突出它们</strong>。</p>
<p><strong>要绘制简单的点，可使用函数<code>scatter()</code>，并向它传递一对x和y坐标，它将在指定位置绘制一个点</strong>。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt

plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>下面来<strong>设置输出的样式</strong>，使其更有趣：添加标题，给轴加上标签，并<strong>确保所有文本都大到能够看清</strong>：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt

plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> s<span class="token operator">=</span><span class="token number">200</span><span class="token punctuation">)</span>

<span class="token comment"># 设置图表标题并给坐标轴加上标签</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">"Square Numbers"</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">24</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">"Value"</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">14</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">"Square of Value"</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">14</span><span class="token punctuation">)</span>

<span class="token comment"># 设置刻度标记的大小</span>
plt<span class="token punctuation">.</span>tick_params<span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token string">'both'</span><span class="token punctuation">,</span> which<span class="token operator">=</span><span class="token string">'major'</span><span class="token punctuation">,</span> labelsize<span class="token operator">=</span><span class="token number">14</span><span class="token punctuation">)</span>
<span class="token comment"># 显示图例</span>
plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span><span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li><code>plt.scatter(2, 4, s=200)</code>：<strong>实参s设置了</strong>绘制图形时使用的<strong>点的尺寸</strong></li>
</ul>
<hr>
<h4 id="使用-scatter-绘制一系列点"><a href="#使用-scatter-绘制一系列点" class="headerlink" title="使用 scatter() 绘制一系列点"></a>使用 scatter() 绘制一系列点</h4><p>要绘制一系列的点，可向<code>scatter()</code>传递两个<strong>分别包含x值和y值的列表</strong>，如下所示：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt

x_values <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span>
y_values <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">]</span>

plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>x_values<span class="token punctuation">,</span> y_values<span class="token punctuation">,</span> s<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">)</span>

<span class="token comment"># 设置图表标题并给坐标轴加上标签</span>
<span class="token operator">-</span><span class="token operator">-</span>snip<span class="token operator">-</span><span class="token operator">-</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">-</span><span class="token operator">-</span>snip<span class="token operator">-</span><span class="token operator">-</span>

<span class="token comment"># 绘制一个展示 船票Fare 与 乘客年龄和性别 之间关系的散点图</span>


<span class="token comment"># 方式一</span>
<span class="token comment"># 利用query对性别和年龄进行筛选</span>
x_values_1 <span class="token operator">=</span> titanic<span class="token punctuation">.</span>query<span class="token punctuation">(</span><span class="token string">"Sex == 'male' &amp; Age != 'NaN'"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'Age'</span><span class="token punctuation">]</span>
y_values_1 <span class="token operator">=</span> titanic<span class="token punctuation">.</span>query<span class="token punctuation">(</span><span class="token string">"Sex == 'male' &amp; Age != 'NaN'"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'Fare'</span><span class="token punctuation">]</span>

x_values_2 <span class="token operator">=</span> titanic<span class="token punctuation">.</span>query<span class="token punctuation">(</span><span class="token string">"Sex == 'female' &amp; Age != 'NaN'"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'Age'</span><span class="token punctuation">]</span>
y_values_2 <span class="token operator">=</span> titanic<span class="token punctuation">.</span>query<span class="token punctuation">(</span><span class="token string">"Sex == 'female' &amp; Age != 'NaN'"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'Fare'</span><span class="token punctuation">]</span>

plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>x_values_1<span class="token punctuation">,</span> y_values_1<span class="token punctuation">,</span> s<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> c<span class="token operator">=</span><span class="token string">'b'</span><span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">'Male'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>x_values_2<span class="token punctuation">,</span> y_values_2<span class="token punctuation">,</span> s<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> c<span class="token operator">=</span><span class="token string">'r'</span><span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">'Female'</span><span class="token punctuation">)</span>

<span class="token comment"># 方式二</span>
titanic<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>titanic<span class="token punctuation">[</span><span class="token string">'Sex'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'male'</span><span class="token punctuation">,</span> <span class="token string">'color'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'b'</span> <span class="token comment"># 该处loc[]的用法为：指出 符合条件的行的列值 和 列标签</span>
titanic<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token operator">~</span><span class="token punctuation">(</span>titanic<span class="token punctuation">[</span><span class="token string">'Sex'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'male'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'color'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'r'</span>
plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>titanic<span class="token punctuation">[</span><span class="token string">'Age'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>dropna<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> titanic<span class="token punctuation">[</span><span class="token string">'Fare'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>dropna<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> s<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> c<span class="token operator">=</span>titanic<span class="token punctuation">[</span>color<span class="token punctuation">]</span><span class="token punctuation">)</span>



plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">"船票与年龄"</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">24</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">"Age"</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">14</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">"Fare"</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">14</span><span class="token punctuation">)</span>
<span class="token comment"># 显示图例</span>
plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span><span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<p>可利用<code>query()</code><strong>排除一些极端值的干扰</strong></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 可视化 消费金额和购买数量的关系散点图</span>
gu <span class="token operator">=</span> grouped_user<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>query<span class="token punctuation">(</span><span class="token string">'order_amount &lt; 6000'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>gu<span class="token punctuation">[</span><span class="token string">'order_amount'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> gu<span class="token punctuation">[</span><span class="token string">'order_products'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>



<hr>
<h4 id="自动计算数据"><a href="#自动计算数据" class="headerlink" title="自动计算数据"></a>自动计算数据</h4><p>下面是<strong>绘制1000个点</strong>的代码：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt

x_values <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1001</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
y_values <span class="token operator">=</span> <span class="token punctuation">[</span>x<span class="token operator">**</span><span class="token number">2</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> x_values<span class="token punctuation">]</span>

plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>x_values<span class="token punctuation">,</span> y_values<span class="token punctuation">,</span> s<span class="token operator">=</span><span class="token number">40</span><span class="token punctuation">)</span>

<span class="token comment"># 设置图表标题并给坐标轴加上标签</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">"Square Numbers"</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">24</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">"Value"</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">14</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">"Square of Value"</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">14</span><span class="token punctuation">)</span>

<span class="token comment"># 设置每个坐标轴的取值范围</span>
plt<span class="token punctuation">.</span>axis<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1100</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1100000</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>由于这个数据集较大，我们<strong>将点设置得较小</strong>，并使用函数<code>axis()</code><strong>指定了每个坐标轴的取值范围</strong>。</p>
<hr>
<h4 id="删除数据点的轮廓"><a href="#删除数据点的轮廓" class="headerlink" title="删除数据点的轮廓"></a>删除数据点的轮廓</h4><p>matplotlib允许你<strong>给散点图中的各个点指定颜色</strong>，默认为<strong>蓝色点</strong>和<strong>黑色轮廓</strong>。在散点图包含的数据点不多时效果很好，但<strong>绘制很多点时，黑色轮廓可能会粘连在一起</strong>。</p>
<p>要删除数据点的轮廓，可在调用<code>scatter()</code>时传递实参<code>edgecolor=&#39;none&#39;</code>：</p>
<p><code>plt.scatter(x_values, y_values, edgecolor=&#39;none&#39;, s=40)</code></p>
<p>注意：matplotlib 2.0.0版本之后，<code>scatter()</code>函数的<strong>实参edgecolor默认为</strong><code>’none&#39;</code>。</p>
<hr>
<h4 id="自定义颜色"><a href="#自定义颜色" class="headerlink" title="自定义颜色"></a>自定义颜色</h4><p>要<strong>修改数据点的颜色</strong>，可向<code>scatter()</code>传递<strong>参数c</strong>，并将其<strong>设置为要使用的颜色的名称</strong>，如下所示：</p>
<p><code>plt.scatter(x_values, y_values, c=&#39;red&#39;, s=40)</code></p>
<p>还可以使用RGB颜色模式自定义颜色：</p>
<p><code>plt.scatter(x_values, y_values, c=(0, 0, 0.8), s=40)</code></p>
<p><strong>值越接近0，指定的颜色越深，值越接近1，指定的颜色越浅</strong>。</p>
<hr>
<h4 id="使用颜色映射"><a href="#使用颜色映射" class="headerlink" title="使用颜色映射"></a>使用颜色映射</h4><p><strong>颜色映射</strong>(<strong>colormap</strong>)是一系列颜色，它们<strong>从起始颜色渐变到结束颜色</strong>。在可视化中，<strong>颜色映射用于突出数据的规律</strong>，例如你可能用较浅的颜色来显示较小的值，并用较深的颜色来显示较大的值。</p>
<p><strong>模块pyplot内置了一组颜色映射</strong>：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt

x_values <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1001</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
y_values <span class="token operator">=</span> <span class="token punctuation">[</span>x<span class="token operator">**</span><span class="token number">2</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> x_values<span class="token punctuation">]</span>

plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>x_values<span class="token punctuation">,</span> y_values<span class="token punctuation">,</span> c<span class="token operator">=</span>y_values<span class="token punctuation">,</span> cmap<span class="token operator">=</span>plt<span class="token punctuation">.</span>cm<span class="token punctuation">.</span>Blues<span class="token punctuation">,</span>
           s<span class="token operator">=</span><span class="token number">40</span><span class="token punctuation">)</span>

<span class="token comment"># 设置图表标题并给坐标轴加上标签</span>
<span class="token operator">-</span><span class="token operator">-</span>snip<span class="token operator">-</span><span class="token operator">-</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>我们<strong>将参数c设置成了一个y值列表</strong>，并<strong>使用参数cmap告诉pyplot使用哪个颜色映射</strong>。y值较小的点显示为浅蓝色，y值较大的点显示为深蓝色。</p>
<p>注意：要了解pyplot中所有的颜色映射，访问<a target="_blank" rel="noopener" href="https://matplotlib.org/gallery/color/colormap_reference.html#sphx-glr-gallery-color-colormap-reference-py">Colormap reference</a></p>
<hr>
<h4 id="自动保存图表"><a href="#自动保存图表" class="headerlink" title="自动保存图表"></a>自动保存图表</h4><p>要让程序<strong>自动将图表保存到文件中</strong>，可将对<code>plt.show()</code>的调用替换为对<code>plt.savefig()</code>的调用：</p>
<p><code>plt.savefig(&#39;suqares_plot.png&#39;, bbox_inches=&#39;tight&#39;)</code></p>
<ul>
<li>第一个实参指定要以什么样的文件名保存图表，这个文件将<strong>存储到当前程序所在的目录中</strong>。</li>
<li>第二个实参指定<strong>将图表多余的空白区域剪掉</strong>。如果要保留图表周围多余的空白区域，可<strong>省略这个实参</strong>。</li>
</ul>
<hr>
<h3 id="绘制饼图"><a href="#绘制饼图" class="headerlink" title="绘制饼图"></a>绘制饼图</h3><p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/38160291">matplotlib可视化饼图 - 知乎</a></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 绘制一个展示男女乘客比例的扇形图</span>
males <span class="token operator">=</span> <span class="token punctuation">(</span>titanic<span class="token punctuation">[</span><span class="token string">'Sex'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'male'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
females <span class="token operator">=</span> <span class="token punctuation">(</span>titanic<span class="token punctuation">[</span><span class="token string">'Sex'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'female'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

proportions <span class="token operator">=</span> <span class="token punctuation">[</span>males<span class="token punctuation">,</span> females<span class="token punctuation">]</span>

<span class="token comment"># 绘制饼图</span>
plt<span class="token punctuation">.</span>pie<span class="token punctuation">(</span>
    proportions<span class="token punctuation">,</span>
    
    labels <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'Males'</span><span class="token punctuation">,</span> <span class="token string">'Females'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    
    <span class="token comment">#是否 添加阴影效果</span>
    shadow <span class="token operator">=</span> <span class="token boolean">False</span><span class="token punctuation">,</span>
    
    <span class="token comment"># 指定填充色</span>
    colors <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'blue'</span><span class="token punctuation">,</span> <span class="token string">'red'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    
    <span class="token comment"># 每一块偏移中心的距离</span>
    explode <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">0.15</span> <span class="token punctuation">,</span> <span class="token number">0.3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>

    <span class="token comment"># 饼图的初始摆放角度，默认图是从x轴正方向逆时针画起,如设定=90则从y轴正方向画起</span>
    startangle <span class="token operator">=</span> <span class="token number">90</span><span class="token punctuation">,</span>
    
    <span class="token comment"># 显示百分比, 小数点前后表示最少的位数 末尾两个%%是输出%自身</span>
    autopct <span class="token operator">=</span> <span class="token string">'%1.1f%%'</span>
    
<span class="token punctuation">)</span>


<span class="token comment"># x，y轴刻度设置一致，保证饼图为圆形</span>
plt<span class="token punctuation">.</span>axis<span class="token punctuation">(</span><span class="token string">'equal'</span><span class="token punctuation">)</span>

<span class="token comment"># 设置图表标题</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">"男女乘客比例"</span><span class="token punctuation">)</span>

<span class="token comment"># tight_layout会自动调整子图参数，使之填充整个图像区域</span>
plt<span class="token punctuation">.</span>tight_layout<span class="token punctuation">(</span><span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>







<hr>
<h3 id="随机漫步"><a href="#随机漫步" class="headerlink" title="随机漫步"></a>随机漫步</h3><p><strong>随机漫步</strong>是这样行走得到的<strong>路径</strong>：<strong>每次行走都完全是随机的，没有明确的方向，结果是由一系列随机决策决定的</strong>。在自然界、物理学、生物学、化学和经济领域，随机漫步都有其实际用途。例如，漂浮在水滴上的花粉因不断受到水分子的挤压而在水面上移动。水滴中的分子运动是随机的，因此花粉在水面上的运动路径犹如随机漫步。</p>
<h4 id="创建-RandomWalk-类"><a href="#创建-RandomWalk-类" class="headerlink" title="创建 RandomWalk() 类"></a>创建 RandomWalk() 类</h4><p>创建一个<code>RandomWalk()</code>类，这个类需要三个属性：</p>
<ol>
<li>存储随机漫步次数的变量</li>
<li>随机漫步经过的每个点的x坐标</li>
<li>随机漫步经过的每个点的y坐标</li>
</ol>
<p><code>RandomWalk()</code>类只包含两个方法：</p>
<ol>
<li><code>__init__()</code></li>
<li><code>fill_walk()</code>：计算随机漫步<strong>经过的所有点</strong></li>
</ol>
<p>先来看看<code>__init__()</code>:</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> random <span class="token keyword">import</span> choice

<span class="token keyword">class</span> <span class="token class-name">RandomWalk</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""一个生成随机漫步数据的类"""</span>
    
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> num_points<span class="token operator">=</span><span class="token number">5000</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""初始化随机漫步的属性"""</span>
        self<span class="token punctuation">.</span>num_points <span class="token operator">=</span> num_points
        
        <span class="token comment"># 所有随机漫步都始于(0, 0)</span>
        self<span class="token punctuation">.</span>x_values <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
        self<span class="token punctuation">.</span>y_values <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>为做出随机决策，我们<strong>将所有可能的选择都存储在一个列表中</strong>，并<strong>在每次做决策时都使用<code>choice()</code>来决定使用哪种选择</strong>。</p>
<hr>
<h4 id="选择方向"><a href="#选择方向" class="headerlink" title="选择方向"></a>选择方向</h4><p>我们将使用<code>fill_walk()</code>来生成漫步包含的点，并决定每次漫步的方向，如下所示：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">fill_walk</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""计算随机漫步包含的所有点"""</span>
        
        <span class="token comment"># 不断漫步，直到列表到达指定的长度</span>
        <span class="token keyword">while</span> <span class="token builtin">len</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>x_values<span class="token punctuation">)</span> <span class="token operator">&lt;</span> self<span class="token punctuation">.</span>num_points<span class="token punctuation">:</span>
            <span class="token comment"># 决定前进方向以及沿这个方向前进的距离</span>
            x_direction <span class="token operator">=</span> choice<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            x_distance <span class="token operator">=</span> choice<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            x_step <span class="token operator">=</span> x_direction <span class="token operator">*</span> x_distance
            
            y_direction <span class="token operator">=</span> choice<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            y_distance <span class="token operator">=</span> choice<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            y_step <span class="token operator">=</span> y_direction <span class="token operator">*</span> y_distance
            
            <span class="token comment"># 拒绝原地踏步</span>
            <span class="token keyword">if</span> x_step <span class="token operator">==</span> <span class="token number">0</span> <span class="token keyword">and</span> y_step <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
                <span class="token keyword">continue</span>
                
            <span class="token comment"># 计算下一个点的x和y值</span>
            next_x <span class="token operator">=</span> self<span class="token punctuation">.</span>x_values<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> x_step
            next_y <span class="token operator">=</span> self<span class="token punctuation">.</span>y_values<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> y_step
            
            self<span class="token punctuation">.</span>x_values<span class="token punctuation">.</span>append<span class="token punctuation">(</span>next_x<span class="token punctuation">)</span>
            self<span class="token punctuation">.</span>y_values<span class="token punctuation">.</span>append<span class="token punctuation">(</span>next_y<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li><code>choice([-1, 1])</code>：<strong>从-1和1中随机选择一个值</strong></li>
<li><code>choice([0, 1, 2, 3, 4])</code>：<strong>从0~4中随机选择一个值</strong></li>
</ul>
<hr>
<h4 id="绘制随机漫步图"><a href="#绘制随机漫步图" class="headerlink" title="绘制随机漫步图"></a>绘制随机漫步图</h4><p><strong>rw_visual.py</strong>：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt

<span class="token keyword">from</span> random_walk <span class="token keyword">import</span> RandomWalk

<span class="token comment"># 创建一个RandomWalk实例，并将其包含的点都绘制出来</span>
rw <span class="token operator">=</span> RandomWalk<span class="token punctuation">(</span><span class="token punctuation">)</span>
rw<span class="token punctuation">.</span>fill_walk<span class="token punctuation">(</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>rw<span class="token punctuation">.</span>x_values<span class="token punctuation">,</span> rw<span class="token punctuation">.</span>y_values<span class="token punctuation">,</span> s<span class="token operator">=</span><span class="token number">15</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h4 id="模拟多次随机漫步"><a href="#模拟多次随机漫步" class="headerlink" title="模拟多次随机漫步"></a>模拟多次随机漫步</h4><p>要在不多次运行程序的情况下<strong>模拟多次随机漫步</strong>，一种办法是<strong>将这些代码放在一个while循环中</strong>，如下所示：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt

<span class="token keyword">from</span> random_walk <span class="token keyword">import</span> RandomWalk

<span class="token comment"># 只要程序处于活动状态，就不断地模拟随机漫步</span>
<span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
    <span class="token comment"># 创建一个RandomWalk实例，并将其包含的点都绘制出来</span>
	rw <span class="token operator">=</span> RandomWalk<span class="token punctuation">(</span><span class="token punctuation">)</span>
	rw<span class="token punctuation">.</span>fill_walk<span class="token punctuation">(</span><span class="token punctuation">)</span>
	plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>rw<span class="token punctuation">.</span>x_values<span class="token punctuation">,</span> rw<span class="token punctuation">.</span>y_values<span class="token punctuation">,</span> s<span class="token operator">=</span><span class="token number">15</span><span class="token punctuation">)</span>
	plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
	
	keep_running <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"Make another walk? (y/n): "</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> keep_running <span class="token operator">==</span> <span class="token string">'n'</span><span class="token punctuation">:</span>
		<span class="token keyword">break</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h4 id="给点着色"><a href="#给点着色" class="headerlink" title="给点着色"></a>给点着色</h4><p>我们将使用<strong>颜色映射</strong>来指出漫步中各点的<strong>先后顺序</strong>。为根据漫步中各点的先后顺序进行着色，我们<strong>传递参数c</strong>，并将其<strong>设置为一个列表</strong>，其中<strong>包含各点的先后顺序</strong>。</p>
<p><strong>由于这些点是按顺序绘制的，因此给参数c指定的列表只需包含数字1~5000</strong>：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">-</span><span class="token operator">-</span>snip<span class="token operator">-</span><span class="token operator">-</span>
<span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
    <span class="token comment"># 创建一个RandomWalk实例，并将其包含的点都绘制出来</span>
	rw <span class="token operator">=</span> RandomWalk<span class="token punctuation">(</span><span class="token punctuation">)</span>
	rw<span class="token punctuation">.</span>fill_walk<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
	point_numbers <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span>rw<span class="token punctuation">.</span>num_points<span class="token punctuation">)</span><span class="token punctuation">)</span>
	plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>rw<span class="token punctuation">.</span>x_values<span class="token punctuation">,</span> rw<span class="token punctuation">.</span>y_values<span class="token punctuation">,</span> c<span class="token operator">=</span>point_numbers<span class="token punctuation">,</span> cmap<span class="token operator">=</span>plt<span class="token punctuation">.</span>cm<span class="token punctuation">.</span>Blues<span class="token punctuation">,</span> s<span class="token operator">=</span><span class="token number">15</span><span class="token punctuation">)</span>
	plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
	
	keep_running <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"Make another walk? (y/n): "</span><span class="token punctuation">)</span>
	<span class="token operator">-</span><span class="token operator">-</span>snip<span class="token operator">-</span><span class="token operator">-</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h4 id="重新绘制起点和终点"><a href="#重新绘制起点和终点" class="headerlink" title="重新绘制起点和终点"></a>重新绘制起点和终点</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">-</span><span class="token operator">-</span>snip<span class="token operator">-</span><span class="token operator">-</span>
<span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
    <span class="token operator">-</span><span class="token operator">-</span>snip<span class="token operator">-</span><span class="token operator">-</span>
    plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>rw<span class="token punctuation">.</span>x_values<span class="token punctuation">,</span> rw<span class="token punctuation">.</span>y_values<span class="token punctuation">,</span> c<span class="token operator">=</span>point_numbers<span class="token punctuation">,</span> cmap<span class="token operator">=</span>plt<span class="token punctuation">.</span>cm<span class="token punctuation">.</span>Blues<span class="token punctuation">,</span> s<span class="token operator">=</span><span class="token number">15</span><span class="token punctuation">)</span>
    
    <span class="token comment"># 突出起点和终点</span>
    plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> c<span class="token operator">=</span><span class="token string">'green'</span><span class="token punctuation">,</span> s<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>rw<span class="token punctuation">.</span>x_values<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> rw<span class="token punctuation">.</span>y_values<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> c<span class="token operator">=</span><span class="token string">'red'</span><span class="token punctuation">,</span> s<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">)</span>
    
    plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token operator">-</span><span class="token operator">-</span>snip<span class="token operator">-</span><span class="token operator">-</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h4 id="隐藏坐标轴"><a href="#隐藏坐标轴" class="headerlink" title="隐藏坐标轴"></a>隐藏坐标轴</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">-</span><span class="token operator">-</span>snip<span class="token operator">-</span><span class="token operator">-</span>
<span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
    <span class="token operator">-</span><span class="token operator">-</span>snip<span class="token operator">-</span><span class="token operator">-</span>
    plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>rw<span class="token punctuation">.</span>x_values<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> rw<span class="token punctuation">.</span>y_values<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> c<span class="token operator">=</span><span class="token string">'red'</span><span class="token punctuation">,</span> s<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">)</span>
    
    <span class="token comment"># 隐藏坐标轴</span>
    plt<span class="token punctuation">.</span>axes<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>get_xaxis<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>set_visible<span class="token punctuation">(</span><span class="token boolean">False</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>axes<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>get_yaxis<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>set_visible<span class="token punctuation">(</span><span class="token boolean">False</span><span class="token punctuation">)</span>
    
    plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token operator">-</span><span class="token operator">-</span>snip<span class="token operator">-</span><span class="token operator">-</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>为修改坐标轴，使用了函数<code>plt.axes()</code>来将每条坐标轴的可见性设置为False。</p>
<hr>
<h4 id="增加点数"><a href="#增加点数" class="headerlink" title="增加点数"></a>增加点数</h4><p>在创建RandomWalk实例时<strong>增大num_points的值，并在绘图时调整每个点的大小</strong>，如下所示：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">-</span><span class="token operator">-</span>snip<span class="token operator">-</span><span class="token operator">-</span>
<span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
    <span class="token comment"># 创建一个RandomWalk实例，并将其包含的点都绘制出来</span>
    rw <span class="token operator">=</span> RandomWalk<span class="token punctuation">(</span><span class="token number">5000</span><span class="token punctuation">)</span>
    rw<span class="token punctuation">.</span>fill_walk<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    <span class="token comment"># 绘制点并将图形显示出来</span>
    point_numbers <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span>rw<span class="token punctuation">.</span>num_points<span class="token punctuation">)</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>rw<span class="token punctuation">.</span>x_values<span class="token punctuation">,</span> rw<span class="token punctuation">.</span>y_values<span class="token punctuation">,</span> c<span class="token operator">=</span>point_numbers<span class="token punctuation">,</span> cmap<span class="token operator">=</span>plt<span class="token punctuation">.</span>cm<span class="token punctuation">.</span>Blues<span class="token punctuation">,</span> s<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token operator">-</span><span class="token operator">-</span>snip<span class="token operator">-</span><span class="token operator">-</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h4 id="调整尺寸以适合屏幕"><a href="#调整尺寸以适合屏幕" class="headerlink" title="调整尺寸以适合屏幕"></a>调整尺寸以适合屏幕</h4><p>图表适合屏幕大小时，更能有效地将数据中的规律呈现出来。为<strong>让绘图窗口更适合屏幕大小</strong>，可像下面这样<strong>调整matplotlib输出的尺寸</strong>：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">-</span><span class="token operator">-</span>snip<span class="token operator">-</span><span class="token operator">-</span>
<span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
    <span class="token comment"># 创建一个RandomWalk实例，并将其包含的点都绘制出来</span>
	rw <span class="token operator">=</span> RandomWalk<span class="token punctuation">(</span><span class="token punctuation">)</span>
	rw<span class="token punctuation">.</span>fill_walk<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    <span class="token comment"># 设置绘图窗口的尺寸</span>
    plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token operator">-</span><span class="token operator">-</span>snip<span class="token operator">-</span><span class="token operator">-</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>函数<code>figure()</code>用于<strong>指定图表的宽度、高度、分辨率和背景色</strong>：</p>
<p>需要给形参<code>figsize</code><strong>指定一个元组</strong>，向matplotlib<strong>指出绘图窗口的尺寸</strong>，<strong>单位为英寸</strong>。</p>
<p>Python<strong>假定屏幕分辨率为80像素&#x2F;英寸</strong>，如果知道自己系统的分辨率，可使用形参dpi向<code>figure()</code>传递该分辨率，以有效利用可用的屏幕空间：</p>
<p><code>plt.figure(dpi=128, figsize=(10, 6))</code></p>
<hr>
<h3 id="使用-Pygal-模拟掷骰子"><a href="#使用-Pygal-模拟掷骰子" class="headerlink" title="使用 Pygal 模拟掷骰子"></a>使用 Pygal 模拟掷骰子</h3><p>本节将使用Python<strong>可视化包Pygal</strong>来生成可缩放的<strong>矢量图形文件</strong>，它们将<strong>自动缩放</strong>，以适合观看者的屏幕。如果你打算以在线的方式使用图表，请考虑使用Pygal来生成它们，这样在任何设备上显示都会很美观。</p>
<p>在这个项目中，我们将对掷骰子的结果进行分析。为确定哪些点数出现的可能性最大，我们将<strong>生成一个表示掷骰子结果的数据集，并根据结果绘制出一个图形</strong>。</p>
<h4 id="安装-Pygal"><a href="#安装-Pygal" class="headerlink" title="安装 Pygal"></a>安装 Pygal</h4><p>在 Windows 系统中，命令：</p>
<p><code>python -m pip install --user pygal==1.7</code></p>
<hr>
<h4 id="Paygal-画廊"><a href="#Paygal-画廊" class="headerlink" title="Paygal 画廊"></a>Paygal 画廊</h4><p>要了解使用Pygal可创建什么样的图表，可以查看<a target="_blank" rel="noopener" href="http://www.pygal.org/en/stable/documentation/types/index.html">Chart types — pygal documentation</a></p>
<hr>
<h4 id="创建-Die-类"><a href="#创建-Die-类" class="headerlink" title="创建 Die 类"></a>创建 Die 类</h4><p>下面的类模拟掷一个骰子：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> random <span class="token keyword">import</span> randint

<span class="token keyword">class</span> <span class="token class-name">Die</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""表示一个骰子的类"""</span>
    
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> num_sides<span class="token operator">=</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""骰子默认为6面"""</span>
        self<span class="token punctuation">.</span>num_sides <span class="token operator">=</span> num_sides
        
    <span class="token keyword">def</span> <span class="token function">roll</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""返回一个位于1和骰子面数之间的随机数"""</span>
        <span class="token keyword">return</span> randint<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>num_sides<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li>方法<code>roll()</code>使用函数<code>randint()</code>来<strong>返回一个1和面数之间的随机整数(包括起始值1和终止值num_sides)</strong></li>
</ul>
<p>骰子根据面数命名，6面的骰子命名为D6，8面的骰子命名为D8。</p>
<hr>
<h4 id="掷骰子"><a href="#掷骰子" class="headerlink" title="掷骰子"></a>掷骰子</h4><p>使用这个类来创建图表前，先来掷D6骰子，将结果打印出来，并检查结果是否合理：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> die <span class="token keyword">import</span> Die

<span class="token comment"># 创建一个D6</span>
die <span class="token operator">=</span> Die<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 掷几次骰子，并将结果存储在一个列表中</span>
results <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> roll_num <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    result <span class="token operator">=</span> die<span class="token punctuation">.</span>roll<span class="token punctuation">(</span><span class="token punctuation">)</span>
    results<span class="token punctuation">.</span>append<span class="token punctuation">(</span>result<span class="token punctuation">)</span>
    
<span class="token keyword">print</span><span class="token punctuation">(</span>results<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h4 id="分析结果"><a href="#分析结果" class="headerlink" title="分析结果"></a>分析结果</h4><p>为分析掷一个D6骰子的结果，我们<strong>计算每个点数出现的次数</strong>：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">-</span><span class="token operator">-</span>snip<span class="token operator">-</span><span class="token operator">-</span>
<span class="token comment"># 掷几次骰子，并将结果存储在一个列表中</span>
results <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> roll_num <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    result <span class="token operator">=</span> die<span class="token punctuation">.</span>roll<span class="token punctuation">(</span><span class="token punctuation">)</span>
    results<span class="token punctuation">.</span>append<span class="token punctuation">(</span>result<span class="token punctuation">)</span>
    
<span class="token comment"># 分析结果</span>
frequencies <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> value <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> die<span class="token punctuation">.</span>num_sides<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    frequency <span class="token operator">=</span> results<span class="token punctuation">.</span>count<span class="token punctuation">(</span>value<span class="token punctuation">)</span>
    frequencies<span class="token punctuation">.</span>append<span class="token punctuation">(</span>frequency<span class="token punctuation">)</span>
    
<span class="token keyword">print</span><span class="token punctuation">(</span>frequencies<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li>为分析结果，我们创建了空列表frequencies，用于存储每种点数出现的次数</li>
</ul>
<hr>
<h4 id="绘制条形图-bar-chart"><a href="#绘制条形图-bar-chart" class="headerlink" title="绘制条形图(bar chart)"></a>绘制条形图(bar chart)</h4><p>有了频率列表后，我们就可以绘制一个表示结果的<strong>条形图(bar chart)</strong>，<strong>指出各种结果出现的频率</strong>。</p>
<ol>
<li><strong>利用pygal绘制</strong></li>
</ol>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> pygal
<span class="token operator">-</span><span class="token operator">-</span>snip<span class="token operator">-</span><span class="token operator">-</span>

<span class="token comment"># 分析结果</span>
frequencies <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> value <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> die<span class="token punctuation">.</span>num_sides<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    frequency <span class="token operator">=</span> results<span class="token punctuation">.</span>count<span class="token punctuation">(</span>value<span class="token punctuation">)</span>
    frequencies<span class="token punctuation">.</span>append<span class="token punctuation">(</span>frequency<span class="token punctuation">)</span>
    
<span class="token comment"># 对结果进行可视化</span>
bar <span class="token operator">=</span> pygal<span class="token punctuation">.</span>Bar<span class="token punctuation">(</span><span class="token punctuation">)</span>

bar<span class="token punctuation">.</span>title <span class="token operator">=</span> <span class="token string">"Results of rolling one D6 1000 times."</span>
bar<span class="token punctuation">.</span>x_labels <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'1'</span><span class="token punctuation">,</span> <span class="token string">'2'</span><span class="token punctuation">,</span> <span class="token string">'3'</span><span class="token punctuation">,</span> <span class="token string">'4'</span><span class="token punctuation">,</span> <span class="token string">'5'</span><span class="token punctuation">,</span> <span class="token string">'6'</span><span class="token punctuation">]</span>
bar<span class="token punctuation">.</span>x_title <span class="token operator">=</span> <span class="token string">"Result"</span>
bar<span class="token punctuation">.</span>y_title <span class="token operator">=</span> <span class="token string">"Frequency of Result"</span>

bar<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token string">'D6'</span><span class="token punctuation">,</span> frequencies<span class="token punctuation">)</span>
bar<span class="token punctuation">.</span>render_to_file<span class="token punctuation">(</span><span class="token string">'die_visual.svg'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li>为创建<strong>条形图(bar diagram)</strong>，创建了一个<code>pygal.Bar()</code>实例</li>
<li>将D6骰子的可能结果用作x轴的标签</li>
<li>使用<code>add()</code>将一系列值添加到图表中(传递<strong>给添加的值指定的标签</strong>、<strong>将出现在图表中的值的列表</strong>)</li>
<li>将图表<strong>渲染为一个SVG文件</strong>(Scalable Vector Graphics，可缩放的矢量图形，是一种<strong>基于XML</strong>的<strong>图像文件格式</strong>)</li>
</ul>
<p>要查看生成的直方图，最简单的方式是使用Web浏览器。为此，在任意浏览器中新建一个标签页，再打开文件die_visual.svg，将看到对应的图表。</p>
<p>注意：Python让这个图表具有交互性：<strong>如果将鼠标指向该图表中的任何条形，将看到与之相关联的数据</strong>(若无效果，刷新)。</p>
<hr>
<h4 id="绘制直方图-histogram"><a href="#绘制直方图-histogram" class="headerlink" title="绘制直方图(histogram)"></a>绘制直方图(histogram)</h4><ol>
<li><strong>利用pyplot绘制</strong></li>
</ol>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token comment"># 绘制一个展示船票价格的直方图</span>

<span class="token comment"># 创建直方图</span>
<span class="token comment"># 参数：需要计算的series ，bins可以是直方图个数(默认为10)，也可以是自定义的序列</span>
plt<span class="token punctuation">.</span>hist<span class="token punctuation">(</span>titanic<span class="token punctuation">[</span><span class="token string">'Fare'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> bins <span class="token operator">=</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">600</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># Set the title and labels</span>
plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">'Fare'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'Frequency'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'船票价格分布'</span><span class="token punctuation">)</span>

<span class="token comment"># show the plot</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>


<span class="token comment"># 用户消费金额的分布图，利用query消除极值对可视化呈现效果的干扰</span>
plt<span class="token punctuation">.</span>hist<span class="token punctuation">(</span>grouped_user<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>query<span class="token punctuation">(</span><span class="token string">'order_amount &lt; 1000'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'order_amount'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> bins <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h4 id="同时掷两个骰子"><a href="#同时掷两个骰子" class="headerlink" title="同时掷两个骰子"></a>同时掷两个骰子</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> pygal

<span class="token keyword">from</span> die <span class="token keyword">import</span> Die

<span class="token comment"># 创建两个D6骰子</span>
die_1 <span class="token operator">=</span> Die<span class="token punctuation">(</span><span class="token punctuation">)</span>
die_2 <span class="token operator">=</span> Die<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 掷骰子多次，并将结果存储到一个列表中</span>
results <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> roll_num <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    result <span class="token operator">=</span> die_1<span class="token punctuation">.</span>roll<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> die_2<span class="token punctuation">.</span>roll<span class="token punctuation">(</span><span class="token punctuation">)</span>
    results<span class="token punctuation">.</span>append<span class="token punctuation">(</span>result<span class="token punctuation">)</span>
    
<span class="token comment"># 分析结果</span>
frequencies <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
max_result <span class="token operator">=</span> die_1<span class="token punctuation">.</span>num_sides <span class="token operator">+</span> die_2<span class="token punctuation">.</span>num_sides
<span class="token keyword">for</span> value <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> max_result<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    frequency <span class="token operator">=</span> results<span class="token punctuation">.</span>count<span class="token punctuation">(</span>value<span class="token punctuation">)</span>
    frequencies<span class="token punctuation">.</span>append<span class="token punctuation">(</span>frequency<span class="token punctuation">)</span>
    
<span class="token comment"># 可视化结果</span>
bar <span class="token operator">=</span> pygal<span class="token punctuation">.</span>Bar<span class="token punctuation">(</span><span class="token punctuation">)</span>

bar<span class="token punctuation">.</span>title <span class="token operator">=</span> <span class="token string">"Results of rolling two D6 dice 1000 times."</span>
bar<span class="token punctuation">.</span>x_labels <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'2'</span><span class="token punctuation">,</span> <span class="token string">'3'</span><span class="token punctuation">,</span> <span class="token string">'4'</span><span class="token punctuation">,</span> <span class="token string">'5'</span><span class="token punctuation">,</span> <span class="token string">'6'</span><span class="token punctuation">,</span> <span class="token string">'7'</span><span class="token punctuation">,</span> <span class="token string">'8'</span><span class="token punctuation">,</span> <span class="token string">'9'</span><span class="token punctuation">,</span> <span class="token string">'10'</span><span class="token punctuation">,</span> <span class="token string">'11'</span><span class="token punctuation">,</span> <span class="token string">'12'</span><span class="token punctuation">]</span>
bar<span class="token punctuation">.</span>x_title <span class="token operator">=</span> <span class="token string">"Result"</span>
bar<span class="token punctuation">.</span>y_title <span class="token operator">=</span> <span class="token string">"Frequency of Result"</span>

bar<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token string">'D6 + D6'</span><span class="token punctuation">,</span> frequencies<span class="token punctuation">)</span>
bar<span class="token punctuation">.</span>render_to_file<span class="token punctuation">(</span><span class="token string">'dice_visual.svg'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h4 id="同时掷两个面数不同的骰子"><a href="#同时掷两个面数不同的骰子" class="headerlink" title="同时掷两个面数不同的骰子"></a>同时掷两个面数不同的骰子</h4><p>下面来创建一个6面骰子和一个10面骰子，看看同时掷这两个骰子50000次的结果：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> die <span class="token keyword">import</span> Die

<span class="token keyword">import</span> pygal

<span class="token comment"># 创建一个D6和一个D10</span>
die_1 <span class="token operator">=</span> Die<span class="token punctuation">(</span><span class="token punctuation">)</span>
die_2 <span class="token operator">=</span> Die<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>

<span class="token comment"># 掷骰子多次，并将结果存储到一个列表中</span>
results <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> roll_num <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">50000</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    result <span class="token operator">=</span> die_1<span class="token punctuation">.</span>roll<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> die_2<span class="token punctuation">.</span>roll<span class="token punctuation">(</span><span class="token punctuation">)</span>
    results<span class="token punctuation">.</span>append<span class="token punctuation">(</span>result<span class="token punctuation">)</span>
    
<span class="token comment"># 分析结果</span>
frequencies <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
max_result <span class="token operator">=</span> die_1<span class="token punctuation">.</span>num_sides <span class="token operator">+</span> die_2<span class="token punctuation">.</span>num_sides
<span class="token keyword">for</span> value <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> max_result<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    frequency <span class="token operator">=</span> results<span class="token punctuation">.</span>count<span class="token punctuation">(</span>value<span class="token punctuation">)</span>
    frequencies<span class="token punctuation">.</span>append<span class="token punctuation">(</span>frequency<span class="token punctuation">)</span>
    
<span class="token comment"># 可视化结果</span>
bar <span class="token operator">=</span> pygal<span class="token punctuation">.</span>Bar<span class="token punctuation">(</span><span class="token punctuation">)</span>

bar<span class="token punctuation">.</span>title <span class="token operator">=</span> <span class="token string">"Results of rolling a D6 and a D10 50,000 times."</span>
bar<span class="token punctuation">.</span>x_labels <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token keyword">for</span> value <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
bar<span class="token punctuation">.</span>x_title <span class="token operator">=</span> <span class="token string">"Result"</span>
bar<span class="token punctuation">.</span>y_title <span class="token operator">=</span> <span class="token string">"Frequency of Result"</span>

bar<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token string">'D6 + D10'</span><span class="token punctuation">,</span> frequencies<span class="token punctuation">)</span>
bar<span class="token punctuation">.</span>render_to_file<span class="token punctuation">(</span><span class="token string">'dice_visual.svg'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li>通过<strong>列表解析</strong>调整x轴标签</li>
</ul>
<hr>
<h2 id="下载数据"><a href="#下载数据" class="headerlink" title="下载数据"></a>下载数据</h2><p>网上的数据多得难以置信，且大多未经过仔细检查。如果能够对这些数据进行分析，你就能发现别人没有发现的规律和关联。</p>
<h3 id="CSV-文件格式"><a href="#CSV-文件格式" class="headerlink" title="CSV 文件格式"></a>CSV 文件格式</h3><p>要在<strong>文本文件</strong>中存储数据，最简单的方式是<strong>将数据作为一系列以逗号分隔的值</strong>(<strong>CSV</strong>, Comma-Separated Values)写入文件，这样的文件称为<strong>CSV文件</strong>。</p>
<p>例如，下面是一行CSV格式的天气数据：</p>
<p><code>2014-1-5,61,44,26,18,7,-1,56,30,9,30.34,30.27,30.15,,,,10,4,,0.00,0,,195</code></p>
<p>CSV文件对人来说阅读起来比较麻烦，但程序可轻松地提取并处理其中的值，这有助于加快数据分析过程。</p>
<ul>
<li>最好<strong>使用用文字编辑器打开csv文件查看</strong>，<strong>Excel可能会更改显示格式</strong></li>
</ul>
<h4 id="分析-CSV-文件头"><a href="#分析-CSV-文件头" class="headerlink" title="分析 CSV 文件头"></a>分析 CSV 文件头</h4><p>csv模块包含在Python标准库中，可用于分析CSV文件中的数据行，让我们能够快速提取感兴趣的值。下面先来看一下<code>sitka_weather_07-2014.csv</code>文件的<strong>第一行</strong>，其中<strong>包含一系列有关数据的描述</strong>：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> csv

filename <span class="token operator">=</span> <span class="token string">'sitka_weather_07-2014.csv'</span>
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
    reader <span class="token operator">=</span> csv<span class="token punctuation">.</span>reader<span class="token punctuation">(</span>f<span class="token punctuation">)</span>
    header_row <span class="token operator">=</span> <span class="token builtin">next</span><span class="token punctuation">(</span>reader<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>header_row<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li>调用<code>csv.reader()</code>，并将前面存储的<strong>文件对象作为实参传入</strong>，从而创建一个与该文件相关联的<strong>阅读器对象</strong></li>
<li><strong>模块csv的reader类</strong>包含<code>next()</code>方法，调用<strong>内置函数<code>next()</code><strong>并</strong>将一个阅读器对象作为参数传入，将调用阅读器对象的<code>next()</code>方法，从而返回文件中的下一行</strong>。</li>
<li>reader处理文件中<strong>以逗号分隔的第一行数据</strong>，并<strong>将每项数据都作为一个元素存储在列表中</strong>。</li>
</ul>
<p>注意：文件头的格式并非总是一致的， <strong>空格和单位可能出现在奇怪的地方，但不会带来任何问题</strong>。</p>
<hr>
<h4 id="打印文件头及其位置"><a href="#打印文件头及其位置" class="headerlink" title="打印文件头及其位置"></a>打印文件头及其位置</h4><p>为让文件头数据更容易理解，将列表中的<strong>每个文件头及其位置</strong>打印出来：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">-</span><span class="token operator">-</span>snip<span class="token operator">-</span><span class="token operator">-</span>
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
    reader <span class="token operator">=</span> csv<span class="token punctuation">.</span>reader<span class="token punctuation">(</span>f<span class="token punctuation">)</span>
    header_row <span class="token operator">=</span> <span class="token builtin">next</span><span class="token punctuation">(</span>reader<span class="token punctuation">)</span>
    
    <span class="token keyword">for</span> index<span class="token punctuation">,</span> column_header <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>header_row<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span> column_header<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li>对列表调用了<code>enumerate()</code>(<strong>枚举</strong>)来获取每个元素的<strong>索引及其值</strong>。</li>
</ul>
<hr>
<h4 id="提取并读取数据"><a href="#提取并读取数据" class="headerlink" title="提取并读取数据"></a>提取并读取数据</h4><p>首先读取<strong>每天的最高气温</strong>：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> csv

<span class="token comment"># 从文件中获取最高气温</span>
filename <span class="token operator">=</span> <span class="token string">'sitka_weather_07-2014.csv'</span>
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
    reader <span class="token operator">=</span> csv<span class="token punctuation">.</span>reader<span class="token punctuation">(</span>f<span class="token punctuation">)</span>
    header_row <span class="token operator">=</span> <span class="token builtin">next</span><span class="token punctuation">(</span>reader<span class="token punctuation">)</span>
    
    highs <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> row <span class="token keyword">in</span> reader<span class="token punctuation">:</span>
        highs<span class="token punctuation">.</span>append<span class="token punctuation">(</span>row<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        
    <span class="token keyword">print</span><span class="token punctuation">(</span>highs<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li><p><code>for row in reader</code>：<strong>遍历</strong>文件中余下的<strong>各行</strong></p>
<p>  每次执行上述循环，我们都将<strong>索引1处</strong>(<strong>第2列</strong>)的数据附加到highs末尾。</p>
</li>
</ul>
<p>下面使用<code>int()</code><strong>将这些字符串转换为数字</strong>，<strong>让matplotlib能够读取它们</strong>：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">-</span><span class="token operator">-</span>snip<span class="token operator">-</span><span class="token operator">-</span>
	highs <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> row <span class="token keyword">in</span> reader<span class="token punctuation">:</span>
        high <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>row<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        highs<span class="token punctuation">.</span>append<span class="token punctuation">(</span>high<span class="token punctuation">)</span>
        
    <span class="token keyword">print</span><span class="token punctuation">(</span>highs<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h4 id="绘制气温图表"><a href="#绘制气温图表" class="headerlink" title="绘制气温图表"></a>绘制气温图表</h4><p>为可视化这些气温数据，我们首先使用matplotlib创建一个<strong>显示每日最高气温的简单图形</strong>：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> csv

<span class="token keyword">from</span> matplotlib <span class="token keyword">import</span> pyplot <span class="token keyword">as</span> plt

<span class="token comment"># 从文件中获取最高气温</span>
<span class="token operator">-</span><span class="token operator">-</span>snip<span class="token operator">-</span><span class="token operator">-</span>

<span class="token comment"># 根据数据绘制图形</span>
plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>dpi<span class="token operator">=</span><span class="token number">128</span><span class="token punctuation">,</span> figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>highs<span class="token punctuation">,</span> c<span class="token operator">=</span><span class="token string">'red'</span><span class="token punctuation">)</span>

<span class="token comment"># 设置图形的格式</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">"Daily high temperatures, July 2014"</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">24</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">16</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">"Temperature (F)"</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">16</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>tick_params<span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token string">'both'</span><span class="token punctuation">,</span> which<span class="token operator">=</span><span class="token string">'major'</span><span class="token punctuation">,</span> labelsize<span class="token operator">=</span><span class="token number">16</span><span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li><p><strong>鉴于还没有添加日期，因此没有给x轴添加标签</strong></p>
</li>
<li><p><code>tick_params()</code>：</p>
<p>  which一共3个参数：[‘major’ , ‘minor’. ‘both’]<br>  默认是major，表示<strong>主刻度</strong>，后面分布为<strong>次刻度</strong>及<strong>主次刻度都显示.</strong></p>
</li>
<li><p><strong>调整x轴日期的显示间隔</strong></p>
  <pre class="line-numbers language-python" data-language="python"><code class="language-python">plt<span class="token punctuation">.</span>xticks<span class="token punctuation">(</span>pd<span class="token punctuation">.</span>date_range<span class="token punctuation">(</span><span class="token string">'1997-01-01'</span><span class="token punctuation">,</span> <span class="token string">'1997-04-01'</span><span class="token punctuation">,</span> freq<span class="token operator">=</span><span class="token string">'10d'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li>
</ul>
<hr>
<h4 id="模块-datetime"><a href="#模块-datetime" class="headerlink" title="模块 datetime"></a>模块 datetime</h4><p>下面<strong>在图表中添加日期</strong>。在天气数据文件中，<strong>第一个日期在第二行</strong>：</p>
<p><strong>获取日期数据时，获得的是一个字符串</strong>，因此需要将字符串<code>&#39;2014-7-1&#39;</code><strong>转换为一个表示相应日期的对象</strong>。可使用<strong>模块datetime</strong>中的方法<code>strptime()</code>：</p>
<pre class="line-numbers language-none"><code class="language-none">&gt;&gt;&gt; from datetime import datetime
&gt;&gt;&gt; first_date &#x3D; datetime.strptime(&#39;2014-7-1&#39;, &#39;%Y-%m-%d&#39;)
&gt;&gt;&gt; print(first_date)
2014-07-01 00:00:00<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li><p>传入方法<code>strptime()</code>的<strong>第2个实参</strong>告诉Python如何<strong>设置日期的格式</strong>。</p>
<ul>
<li><code>%Y-</code>让Python将字符串中<strong>第一个连字符前面的部分</strong>视为<strong>4位的年份</strong></li>
<li><code>%m-</code>让Python将<strong>第二个连字符前面的部分</strong>视为<strong>表示月份的数字</strong></li>
<li><code>%d</code>让Python将<strong>最后一部分</strong>视为<strong>月份中的一天</strong></li>
</ul>
</li>
<li><p>方法<code>strptime()</code>可接受各种实参，并根据它们来决定如何解读日期：</p>
<table>
<thead>
<tr>
<th>实参</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td>%<strong>A</strong></td>
<td><strong>星期</strong>的名称，如Monday</td>
</tr>
<tr>
<td>%<strong>B</strong></td>
<td><strong>月份</strong>名，如January</td>
</tr>
<tr>
<td>%m</td>
<td>用<strong>数字表示的月份</strong> (<strong>0</strong>1~12)</td>
</tr>
<tr>
<td>%d</td>
<td>用<strong>数字表示</strong>月份中的<strong>一天</strong> (<strong>0</strong>1~31)</td>
</tr>
<tr>
<td>%<strong>Y</strong></td>
<td><strong>四位</strong>的年份，如2015</td>
</tr>
<tr>
<td>%<strong>y</strong></td>
<td><strong>两位</strong>的年份，如15</td>
</tr>
<tr>
<td>%<strong>H</strong></td>
<td><strong>24小时制</strong>的小时数 (<strong>0</strong>0-23)</td>
</tr>
<tr>
<td>%<strong>I</strong></td>
<td><strong>12小时制</strong>的小时数 (<strong>0</strong>1~12)</td>
</tr>
<tr>
<td>%<strong>p</strong></td>
<td>am或pm</td>
</tr>
<tr>
<td>%<strong>M</strong></td>
<td>分钟数 (<strong>0</strong>0~59)</td>
</tr>
<tr>
<td>%<strong>S</strong></td>
<td>秒数 (<strong>0</strong>0~<strong>61</strong>)</td>
</tr>
</tbody></table>
</li>
</ul>
<hr>
<h4 id="在图表中添加日期"><a href="#在图表中添加日期" class="headerlink" title="在图表中添加日期"></a>在图表中添加日期</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> csv
<span class="token keyword">from</span> datetime <span class="token keyword">import</span> datetime

<span class="token keyword">from</span> matplotlib <span class="token keyword">import</span> pyplot <span class="token keyword">as</span> plt

<span class="token comment"># 从文件中获取日期和最高气温</span>
filename <span class="token operator">=</span> <span class="token string">'sitka_weather_07-2014.csv'</span>
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
    reader <span class="token operator">=</span> csv<span class="token punctuation">.</span>reader<span class="token punctuation">(</span>f<span class="token punctuation">)</span>
    header_row <span class="token operator">=</span> <span class="token builtin">next</span><span class="token punctuation">(</span>reader<span class="token punctuation">)</span>
        
    dates<span class="token punctuation">,</span> highs <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> row <span class="token keyword">in</span> reader<span class="token punctuation">:</span>
        current_date <span class="token operator">=</span> datetime<span class="token punctuation">.</span>strptime<span class="token punctuation">(</span>row<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">"%Y-%m-%d"</span><span class="token punctuation">)</span>
        dates<span class="token punctuation">.</span>append<span class="token punctuation">(</span>current_date<span class="token punctuation">)</span>
        
        high <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>row<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        highs<span class="token punctuation">.</span>append<span class="token punctuation">(</span>high<span class="token punctuation">)</span>

<span class="token comment"># 根据数据绘制图形</span>
plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>dpi<span class="token operator">=</span><span class="token number">128</span><span class="token punctuation">,</span> figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>dates<span class="token punctuation">,</span> highs<span class="token punctuation">,</span> c<span class="token operator">=</span><span class="token string">'red'</span><span class="token punctuation">)</span>

<span class="token comment"># 设置图形的格式</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">"Daily high temperatures, July 2014"</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">24</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">16</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>gcf<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>autofmt_xdate<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 绘制斜的日期标签，以免它们彼此重叠</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">"Temperature (F)"</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">16</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>tick_params<span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token string">'both'</span><span class="token punctuation">,</span> which<span class="token operator">=</span><span class="token string">'major'</span><span class="token punctuation">,</span> labelsize<span class="token operator">=</span><span class="token number">16</span><span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li>创建了两个空列表：<code>dates, highs = [], []</code></li>
<li>将包含日期信息的数据转换为datetime对象：<code>datetime.strptime(row[0], &quot;%Y-%m-%d&quot;)</code></li>
<li>将日期和最高气温值传给<code>plot()</code>：<code>plt.plot(dates, highs, c=&#39;red&#39;)</code></li>
</ul>
<hr>
<h4 id="涵盖更长的时间"><a href="#涵盖更长的时间" class="headerlink" title="涵盖更长的时间"></a>涵盖更长的时间</h4><p>创建<strong>覆盖整年</strong>的天气图：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">-</span><span class="token operator">-</span>snip<span class="token operator">-</span><span class="token operator">-</span>
<span class="token comment"># 从文件中获取日期和最高气温</span>
filename <span class="token operator">=</span> <span class="token string">'stika_weather_2014.csv'</span>
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
<span class="token operator">-</span><span class="token operator">-</span>snip<span class="token operator">-</span><span class="token operator">-</span>
<span class="token comment"># 设置图形的格式</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">"Daily high temperatures - 2014"</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">24</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">16</span><span class="token punctuation">)</span>
<span class="token operator">-</span><span class="token operator">-</span>snip<span class="token operator">-</span><span class="token operator">-</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h4 id="再绘制一个数据系列"><a href="#再绘制一个数据系列" class="headerlink" title="再绘制一个数据系列"></a>再绘制一个数据系列</h4><p>从数据文件中提取最低气温，并添加到图表中：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">-</span><span class="token operator">-</span>snip<span class="token operator">-</span><span class="token operator">-</span>
<span class="token comment"># 从文件中获取日期、最高气温和最低气温</span>
filename <span class="token operator">=</span> <span class="token string">'sitka_weather_2014.csv'</span>
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
    reader <span class="token operator">=</span> csv<span class="token punctuation">.</span>reader<span class="token punctuation">(</span>f<span class="token punctuation">)</span>
    header_row <span class="token operator">=</span> <span class="token builtin">next</span><span class="token punctuation">(</span>reader<span class="token punctuation">)</span>
    
    dates<span class="token punctuation">,</span> highs<span class="token punctuation">,</span> lows <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> row <span class="token keyword">in</span> reader<span class="token punctuation">:</span>
        current_date <span class="token operator">=</span> datetime<span class="token punctuation">.</span>strptime<span class="token punctuation">(</span>row<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">"%Y-%m-%d"</span><span class="token punctuation">)</span>
        dates<span class="token punctuation">.</span>append<span class="token punctuation">(</span>current_date<span class="token punctuation">)</span>
        
        high <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>row<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        highs<span class="token punctuation">.</span>append<span class="token punctuation">(</span>high<span class="token punctuation">)</span>
        
        low <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>rpw<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        lows<span class="token punctuation">.</span>append<span class="token punctuation">(</span>low<span class="token punctuation">)</span>
        
<span class="token comment"># 根据数据绘制图形</span>
plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>dpi<span class="token operator">=</span><span class="token number">128</span><span class="token punctuation">,</span> figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>dates<span class="token punctuation">,</span> highs<span class="token punctuation">,</span> c<span class="token operator">=</span><span class="token string">'red'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>dates<span class="token punctuation">,</span> lows<span class="token punctuation">,</span> c<span class="token operator">=</span><span class="token string">'blue'</span><span class="token punctuation">)</span>

<span class="token comment"># 设置图形的格式</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">"Daily high and low temperatures - 2014"</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">24</span><span class="token punctuation">)</span>
<span class="token operator">-</span><span class="token operator">-</span>snip<span class="token operator">-</span><span class="token operator">-</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h4 id="给图表区域着色"><a href="#给图表区域着色" class="headerlink" title="给图表区域着色"></a>给图表区域着色</h4><p><strong>通过着色来呈现每天的气温范围</strong>，为此使用方法<code>fill_between()</code>，它<strong>接受一个x值系列和两个y值系列，并填充两个y值系列之间的空间</strong>：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">-</span><span class="token operator">-</span>snip<span class="token operator">-</span><span class="token operator">-</span>
<span class="token comment"># 根据数据绘制图形</span>
fig <span class="token operator">=</span> plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>dpi<span class="token operator">=</span><span class="token number">128</span><span class="token punctuation">,</span> figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>dates<span class="token punctuation">,</span> highs<span class="token punctuation">,</span> c<span class="token operator">=</span><span class="token string">'red'</span><span class="token punctuation">.</span> alpha<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>dates<span class="token punctuation">,</span> lows<span class="token punctuation">,</span> c<span class="token operator">=</span><span class="token string">'blue'</span><span class="token punctuation">.</span> alpha<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>fill_between<span class="token punctuation">(</span>dates<span class="token punctuation">,</span> highs<span class="token punctuation">,</span> lows<span class="token punctuation">,</span> facecolor<span class="token operator">=</span><span class="token string">'blue'</span><span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">0.1</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li>实参<code>alpha</code>指定<strong>颜色的透明度</strong><ul>
<li><strong>0</strong>表示完全<strong>透明</strong></li>
<li><strong>1(默认)<strong>表示完全</strong>不透明</strong></li>
</ul>
</li>
<li><code>fill_between()</code><ul>
<li>实参<code>facecolor</code>指定了<strong>填充区域的颜色</strong></li>
</ul>
</li>
</ul>
<hr>
<h4 id="错误检查"><a href="#错误检查" class="headerlink" title="错误检查"></a>错误检查</h4><p>我们应该能够使用有关任何地方的天气数据来运行highs_lows.py中的代码，但<strong>有些气象站会偶尔出现故障，未能收集部分或全部其应该收集的数据</strong>。<strong>缺失数据可能会引发异常，如果不妥善地处理，还可能导致程序崩溃</strong>。</p>
<p>例如，我们来看看生成加利福尼亚死亡谷的气温图时出现的情况：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">-</span><span class="token operator">-</span>snip<span class="token operator">-</span><span class="token operator">-</span>
<span class="token comment"># 从文件中获取日期、最高气温和最低气温</span>
filename <span class="token operator">=</span> <span class="token string">'death_valley_2014.csv'</span>
withj <span class="token builtin">open</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
<span class="token operator">-</span><span class="token operator">-</span>snip<span class="token operator">-</span><span class="token operator">-</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>运行结果：</p>
<pre class="line-numbers language-none"><code class="language-none">Traceback (most recent call last):
  File &quot;highs_lows.py&quot;, line 17, in &lt;module&gt;
    high &#x3D; int(row[1])
ValueError: invalid literal for int() with base 10: &#39;&#39;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>查看文件可知，没有记录<strong>2014年2月16日</strong>的数据，<strong>表示最高温度的字符串为空</strong>。为解决这种问题，我们<strong>从CSV文件中读取值时执行错误检查代码，对分析数据集时可能出现的异常进行处理</strong>：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">-</span><span class="token operator">-</span>snip<span class="token operator">-</span><span class="token operator">-</span>
<span class="token comment"># 从文件中获取日期、最高气温和最低气温</span>
filename <span class="token operator">=</span> <span class="token string">'death_valley_2014.csv'</span>
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
    reader <span class="token operator">=</span> csv<span class="token punctuation">.</span>reader<span class="token punctuation">(</span>f<span class="token punctuation">)</span>
    header_row <span class="token operator">=</span> <span class="token builtin">next</span><span class="token punctuation">(</span>reader<span class="token punctuation">)</span>
        
    dates<span class="token punctuation">,</span> highs<span class="token punctuation">,</span> lows <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> row <span class="token keyword">in</span> reader<span class="token punctuation">:</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
	        current_date <span class="token operator">=</span> datetime<span class="token punctuation">.</span>strptime<span class="token punctuation">(</span>row<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">"%Y-%m-%d"</span><span class="token punctuation">)</span>
        	high <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>row<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            low <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>row<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token keyword">except</span> ValueError<span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>current_date<span class="token punctuation">,</span> <span class="token string">'missing data'</span><span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            dates<span class="token punctuation">.</span>append<span class="token punctuation">(</span>current_date<span class="token punctuation">)</span>
	        highs<span class="token punctuation">.</span>append<span class="token punctuation">(</span>high<span class="token punctuation">)</span>
            lows<span class="token punctuation">.</span>append<span class="token punctuation">(</span>low<span class="token punctuation">)</span>
            
<span class="token comment"># 根据数据绘制图形</span>
<span class="token operator">-</span><span class="token operator">-</span>snip<span class="token operator">-</span><span class="token operator">-</span>

<span class="token comment"># 设置图形的格式</span>
title <span class="token operator">=</span> <span class="token string">"Daily high and low temperatures - 2014\nDeath Valley, CA"</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span>title<span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">)</span>
<span class="token operator">-</span><span class="token operator">-</span>snip<span class="token operator">-</span><span class="token operator">-</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>在有些情况下，需要<strong>使用continue来跳过一些数据</strong>，或者<strong>使用<code>remove()</code>(删除列表值)或<code>del</code>(删除 键-值 对)将已提取的数据删除</strong>。可采用任何管用的方法，只要能进行精确而有意义的可视化就好。</p>
<hr>
<h3 id="16-2-比较锡特卡和死亡谷的气温："><a href="#16-2-比较锡特卡和死亡谷的气温：" class="headerlink" title="16-2  比较锡特卡和死亡谷的气温："></a>16-2  比较锡特卡和死亡谷的气温：</h3><p>为准确地比较锡特卡和死亡谷的气温范围，<strong>在y轴上使用相同的刻度</strong>，对两地的气温范围进行直接比较：</p>
<ul>
<li>pyplot的方法<code>ylim()</code>可以<strong>对y轴的刻度做限制</strong>；<code>xlim()</code>则可以对x轴的刻度做限制。</li>
</ul>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 设置图形的格式</span>
<span class="token operator">-</span><span class="token operator">-</span>snip<span class="token operator">-</span><span class="token operator">-</span>
plt<span class="token punctuation">.</span>ylim<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">120</span><span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>尝试<strong>在一个图表中呈现这两个数据集</strong>：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> csv
<span class="token keyword">from</span> datetime <span class="token keyword">import</span> datetime

<span class="token keyword">from</span> matplotlib <span class="token keyword">import</span> pyplot <span class="token keyword">as</span> plt

<span class="token keyword">def</span> <span class="token function">get_weather_data</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> dates<span class="token punctuation">,</span> highs<span class="token punctuation">,</span> lows<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""从文件中获取日期、最高气温和最低气温"""</span>
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
        reader <span class="token operator">=</span> csv<span class="token punctuation">.</span>reader<span class="token punctuation">(</span>f<span class="token punctuation">)</span>
        header_row <span class="token operator">=</span> <span class="token builtin">next</span><span class="token punctuation">(</span>reader<span class="token punctuation">)</span>
        
        <span class="token keyword">for</span> row <span class="token keyword">in</span> reader<span class="token punctuation">:</span>
            <span class="token keyword">try</span><span class="token punctuation">:</span>
                current_date <span class="token operator">=</span> datetime<span class="token punctuation">.</span>strptime<span class="token punctuation">(</span>row<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">"%Y-%m-%d"</span><span class="token punctuation">)</span>
                high <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>row<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
                low <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>row<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            <span class="token keyword">except</span> ValueError<span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span>current_date<span class="token punctuation">,</span> <span class="token string">'missing data'</span><span class="token punctuation">)</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                dates<span class="token punctuation">.</span>append<span class="token punctuation">(</span>current_date<span class="token punctuation">)</span>
                highs<span class="token punctuation">.</span>append<span class="token punctuation">(</span>high<span class="token punctuation">)</span>
                lows<span class="token punctuation">.</span>append<span class="token punctuation">(</span>low<span class="token punctuation">)</span>

<span class="token comment"># 获取锡特卡的气温数据</span>
dates<span class="token punctuation">,</span> highs<span class="token punctuation">,</span> lows <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
get_weather_data<span class="token punctuation">(</span><span class="token string">'stika_weather_2014.csv'</span><span class="token punctuation">,</span> dates<span class="token punctuation">,</span> highs<span class="token punctuation">,</span> lows<span class="token punctuation">)</span>

<span class="token comment"># 根据锡特卡数据绘制图形</span>
plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>dpi<span class="token operator">=</span><span class="token number">128</span><span class="token punctuation">,</span> figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>dates<span class="token punctuation">,</span> highs<span class="token punctuation">,</span> c<span class="token operator">=</span><span class="token string">'red'</span><span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">0.6</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>dates<span class="token punctuation">,</span> lows<span class="token punctuation">,</span> c<span class="token operator">=</span><span class="token string">'blue'</span><span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">0.6</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>fill_between<span class="token punctuation">(</span>dates<span class="token punctuation">,</span> highs<span class="token punctuation">,</span> lows<span class="token punctuation">,</span> facecolor<span class="token operator">=</span><span class="token string">'blue'</span><span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">0.15</span><span class="token punctuation">)</span>

<span class="token comment"># 获取死亡谷的气温数据</span>
dates<span class="token punctuation">,</span> highs<span class="token punctuation">,</span> lows <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
get_weather_data<span class="token punctuation">(</span><span class="token string">'death_valley_2014.csv'</span><span class="token punctuation">,</span> dates<span class="token punctuation">,</span> highs<span class="token punctuation">,</span> lows<span class="token punctuation">)</span>

<span class="token comment"># 将死亡谷数据的图形 添加到当前的绘制中</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>dates<span class="token punctuation">,</span> highs<span class="token punctuation">,</span> c<span class="token operator">=</span><span class="token string">'red'</span><span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">0.3</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>dates<span class="token punctuation">,</span> lows<span class="token punctuation">,</span> c<span class="token operator">=</span><span class="token string">'blue'</span><span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">0.3</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>fill_between<span class="token punctuation">(</span>dates<span class="token punctuation">,</span> highs<span class="token punctuation">,</span> lows<span class="token punctuation">,</span> facecolor<span class="token operator">=</span><span class="token string">'blue'</span><span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">0.05</span><span class="token punctuation">)</span>

<span class="token comment"># 设置图形的格式</span>
title <span class="token operator">=</span> <span class="token string">"Daily high and low temperatures - 2014"</span>
title <span class="token operator">+=</span> <span class="token string">"\nSitka, AK and Death Valley, CA"</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span>title<span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">16</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>gcf<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>autofmt_xdate<span class="token punctuation">(</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">"Temperature (F)"</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">16</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>tick_params<span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token string">'both'</span><span class="token punctuation">,</span> which<span class="token operator">=</span><span class="token string">'major'</span><span class="token punctuation">,</span> labelsize<span class="token operator">=</span><span class="token number">16</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>ylim<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">120</span><span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h3 id="制作交易收盘价走势图：-JSON-格式"><a href="#制作交易收盘价走势图：-JSON-格式" class="headerlink" title="制作交易收盘价走势图： JSON 格式"></a>制作交易收盘价走势图： JSON 格式</h3><h4 id="下载收盘价数据"><a href="#下载收盘价数据" class="headerlink" title="下载收盘价数据"></a>下载收盘价数据</h4><p>btc_close_2017.json实际是一个很长的<strong>Python列表</strong>，其中<strong>每个元素都是一个包含五个键的字典</strong>：统计日期、月份、周数、周几以及收盘价。由于2017年1月1日是周日，作为2017年的第一周实在太短，。因此被计入2016年的第52周。于是2017年的第一周是从1月2日开始的。</p>
<p>可以将<a target="_blank" rel="noopener" href="https://raw.githubusercontent.com/muxuezi/btc/master/btc_close_2017.json">收盘价数据文件</a>直接下载到程序所在的文件夹中，也可以用Python <strong>2.x</strong>标准库中模块<strong>urllib2</strong>(Python <strong>3.x</strong>版本使用<strong>urllib</strong>)的函数<code>urlopen()</code>来做，还可以通过Python的<strong>第三方模块requests</strong>下载数据。</p>
<p>如果采用函数<code>urlopen()</code>来下载数据，可以使用如下代码：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> __future__ <span class="token keyword">import</span> <span class="token punctuation">(</span>absolute_import<span class="token punctuation">,</span> division<span class="token punctuation">,</span> print_function<span class="token punctuation">,</span> unicode_literals<span class="token punctuation">)</span>

<span class="token keyword">try</span><span class="token punctuation">:</span>
    <span class="token comment"># Python 2.x 版本</span>
    <span class="token keyword">from</span> urllib2 <span class="token keyword">import</span> urlopen
<span class="token keyword">except</span> ImportError<span class="token punctuation">:</span>
    <span class="token comment"># Python 3.x 版本</span>
    <span class="token keyword">from</span> urllib<span class="token punctuation">.</span>request <span class="token keyword">import</span> urlopen
<span class="token keyword">import</span> json

json_url <span class="token operator">=</span> <span class="token string">'https://raw.githubusercontent.com/muxuezi/btc/master/btc_close_2017.json'</span>
response <span class="token operator">=</span> urlopen<span class="token punctuation">(</span>json_url<span class="token punctuation">)</span>
<span class="token comment"># 读取数据</span>
req <span class="token operator">=</span> response<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># 将数据写入文件</span>
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'btc_close_2017_urllib.json'</span><span class="token punctuation">,</span> <span class="token string">'wb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
    f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>req<span class="token punctuation">)</span>
<span class="token comment"># 加载json格式</span>
file_urllib <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>req<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>file_urllib<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/yizhuanlu9607/article/details/78084266">python打开文件时w与wb的区别,r与rb的区别</a></p>
<p>  在<strong>Windows</strong>中的<strong>换行符</strong>是<code>\r\n</code>。</p>
<ul>
<li>以<strong>文本方式</strong>(<code>&#39;w&#39;</code>)<strong>写入</strong>，遇到<code>\n</code>会<strong>自动替换</strong>为<code>\r\n</code></li>
<li>以<strong>二进制文本方式</strong>(<code>&#39;wb&#39;</code>)写入，遇到<code>\n</code><strong>仍然按</strong><code>\n</code>记录</li>
</ul>
</li>
<li><p><code>json</code></p>
<ul>
<li><p><code>load()</code></p>
<p>  载入<strong>json文件</strong></p>
</li>
<li><p><code>loads()</code></p>
<p>  载入JSON格式的<strong>字符串</strong></p>
</li>
</ul>
</li>
</ul>
<p>函数urlopen的代码稍微复杂一些，<strong>第三方模块requests</strong>封装了许多常用的方法，<strong>让数据下载和读取方式变得非常简单</strong>：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests

json_url <span class="token operator">=</span> <span class="token string">'https://raw.githubusercontent.com/muxuezi/btc/master/btc_close_2017.json'</span>
req <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>json_url<span class="token punctuation">)</span>
<span class="token comment"># 将数据写入文件</span>
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'btc_close_2017_request.json'</span><span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
    f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>req<span class="token punctuation">.</span>text<span class="token punctuation">)</span>
file_requests <span class="token operator">=</span> req<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li><code>req.text</code>属性可以<strong>直接读取文件数据</strong>，<strong>返回格式是字符串</strong></li>
<li><code>req.json()</code>可以将json文件的数据<strong>转换为Python列表</strong>，与之前的<code>file_urllib</code><strong>内容相同</strong></li>
</ul>
<hr>
<h4 id="提取相关的数据"><a href="#提取相关的数据" class="headerlink" title="提取相关的数据"></a>提取相关的数据</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> json

<span class="token comment"># 将数据加载到一个列表中</span>
filename <span class="token operator">=</span> <span class="token string">'btc_close_2017.json'</span>
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
    btc_data <span class="token operator">=</span> json<span class="token punctuation">.</span>load<span class="token punctuation">(</span>f<span class="token punctuation">)</span>
<span class="token comment"># 打印每一天的信息</span>
<span class="token keyword">for</span> btc_dict <span class="token keyword">in</span> btc_data<span class="token punctuation">:</span>
    date <span class="token operator">=</span> btc_dict<span class="token punctuation">[</span><span class="token string">'date'</span><span class="token punctuation">]</span>
    month <span class="token operator">=</span> btc_dict<span class="token punctuation">[</span><span class="token string">'month'</span><span class="token punctuation">]</span>
    week <span class="token operator">=</span> btc_dict<span class="token punctuation">[</span><span class="token string">'week'</span><span class="token punctuation">]</span>
    weekday <span class="token operator">=</span> btc_dict<span class="token punctuation">[</span><span class="token string">'weekday'</span><span class="token punctuation">]</span>
    close <span class="token operator">=</span> btc_dict<span class="token punctuation">[</span><span class="token string">'close'</span><span class="token punctuation">]</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"&#123;&#125; is month &#123;&#125; week &#123;&#125;, &#123;&#125;, the close price is &#123;&#125; RMB"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>date<span class="token punctuation">,</span> month<span class="token punctuation">,</span> week<span class="token punctuation">,</span> weekday<span class="token punctuation">,</span> close<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h4 id="将字符串转换为数字值"><a href="#将字符串转换为数字值" class="headerlink" title="将字符串转换为数字值"></a>将字符串转换为数字值</h4><p>btc_close_2017.json中的每个键和值都是字符串。为了能在后边的内容中<strong>对交易数据进行计算</strong>，需要先将<strong>表示周数和收盘价的字符串转换为数值</strong>，因此使用函数<code>int()</code>：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">-</span><span class="token operator">-</span>snip<span class="token operator">-</span><span class="token operator">-</span>

<span class="token comment"># 打印每一天的信息</span>
<span class="token keyword">for</span> btc_dict <span class="token keyword">in</span> btc_data<span class="token punctuation">:</span>
    date <span class="token operator">=</span> btc_dict<span class="token punctuation">[</span><span class="token string">'date'</span><span class="token punctuation">]</span>
    month <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>btc_dict<span class="token punctuation">[</span><span class="token string">'month'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    week <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>btc_dict<span class="token punctuation">[</span><span class="token string">'week'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    weekday <span class="token operator">=</span> btc_dict<span class="token punctuation">[</span><span class="token string">'weekday'</span><span class="token punctuation">]</span>
    close <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">float</span><span class="token punctuation">(</span>btc_dict<span class="token punctuation">[</span><span class="token string">'close'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"&#123;&#125; is month &#123;&#125; week &#123;&#125;, &#123;&#125;, the close price is &#123;&#125; RMB"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>date<span class="token punctuation">,</span> month<span class="token punctuation">,</span> week<span class="token punctuation">,</span> weekday<span class="token punctuation">,</span> close<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li><strong>在实际工作中，原始数据的格式经常是不统一的</strong>。此类数值类型转换造成的<strong>ValueError异常十分普遍</strong>。该例子中，<strong>无法将包含小数点的字符串转换为整数</strong>，因此需要<strong>先转换为浮点数再转换为整数</strong>：<code>int(float(btc_dict[&#39;close&#39;]))</code></li>
</ul>
<p>有了这些数据之后，可以<strong>结合Pygal的可视化功能来探索一些有趣的信息</strong>。</p>
<hr>
<h4 id="绘制收盘价折线图"><a href="#绘制收盘价折线图" class="headerlink" title="绘制收盘价折线图"></a>绘制收盘价折线图</h4><p>之前章节介绍过<strong>用Pygal绘制条形图(bar chart)<strong>的方法，也介绍了</strong>用matplotlib绘制折线图(line chart)<strong>的方法。下面用</strong>Pygal</strong>来实现收盘价的<strong>折线图</strong>。</p>
<p>绘制折线图之前，需要<strong>获取x轴与y轴数据</strong>，因此我们<strong>创建了几个列表来存储数据</strong>：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">-</span><span class="token operator">-</span>snip<span class="token operator">-</span><span class="token operator">-</span>

<span class="token comment"># 创建5个列表，分别存储日期和收盘价</span>
dates <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
months <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
weeks <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
weekdays <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
close <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token comment"># 每一天的信息</span>
<span class="token keyword">for</span> btc_dict <span class="token keyword">in</span> btc_data<span class="token punctuation">:</span>
    dates<span class="token punctuation">.</span>append<span class="token punctuation">(</span>btc_dict<span class="token punctuation">[</span><span class="token string">'date'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    months<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>btc_dict<span class="token punctuation">[</span><span class="token string">'month'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    weeks<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>btc_dict<span class="token punctuation">[</span><span class="token string">'week'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    weekdays<span class="token punctuation">.</span>append<span class="token punctuation">(</span>btc_dict<span class="token punctuation">[</span><span class="token string">'weekday'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    close<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">float</span><span class="token punctuation">(</span>btc_dict<span class="token punctuation">[</span><span class="token string">'close'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>由于<strong>数据点比较多，x轴要显示346个日期，因此需要利用Pygal的配置参数，对图形进行适当的调整</strong>：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">-</span><span class="token operator">-</span>snip<span class="token operator">-</span><span class="token operator">-</span>

<span class="token keyword">import</span> pygal

line_chart <span class="token operator">=</span> pygal<span class="token punctuation">.</span>Line<span class="token punctuation">(</span>x_label_rotation<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">,</span> show_mirror_x_labels<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
line_chart<span class="token punctuation">.</span>title <span class="token operator">=</span> <span class="token string">'收盘价（￥）'</span>
line_chart<span class="token punctuation">.</span>x_labels <span class="token operator">=</span> dates
N <span class="token operator">=</span> <span class="token number">20</span> <span class="token comment"># x轴坐标每隔20天显示一次</span>
line_chart<span class="token punctuation">.</span>x_labels_major <span class="token operator">=</span> dates<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span>N<span class="token punctuation">]</span>
line_chart<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token string">'收盘价'</span><span class="token punctuation">,</span> close<span class="token punctuation">)</span>
line_chart<span class="token punctuation">.</span>render_to_file<span class="token punctuation">(</span><span class="token string">'收盘价折线图（￥）.svg'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li><code>pygal.Line()</code>创建Line实例<ul>
<li><code>x_label_rotation=20</code>：让x轴上的标签<strong>顺时针旋转20°</strong></li>
<li><code>show_mirror_x_labels=False</code>：告诉图形<strong>不用显示所有的x轴标签</strong></li>
</ul>
</li>
<li><code>line_chart.x_labels_major = dates[:20]</code>：x轴坐标<strong>每隔20天显示一次</strong></li>
</ul>
<p>下面<strong>对价格做一些简单的探索</strong></p>
<hr>
<h4 id="时间序列特征初探"><a href="#时间序列特征初探" class="headerlink" title="时间序列特征初探"></a>时间序列特征初探</h4><p>进行<strong>时间序列分析</strong>总是期望发现<strong>趋势(trend)</strong>、<strong>周期性(seasonality)<strong>和</strong>噪声(noise)</strong>，从而能够<strong>描述事实、预测未来、做出决策</strong>。</p>
<p>从收盘价的折线图可以看出，2017年的<strong>总体趋势</strong>时非线性的，而且增长幅度不断增大，似乎呈<strong>指数分布</strong>。但是，在<strong>每个季度末</strong>(3月、6月、9月)似乎<strong>有一些相似的波动</strong>，<strong>为了验证周期性的假设，需要先将非线性的趋势(指数增长部分)消除</strong>。**对数变换(log transformation)**是常用的处理方法之一。</p>
<p>用<strong>Python标准库的数学模块math</strong>来解决这个问题。math里有许多常用的数学函数，这里<strong>以10为底的对数函数math.log10计算收盘价</strong>，日期仍然保持不变——这种方式称为<strong>半对数(semi-logarithmic)变换</strong>。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">-</span><span class="token operator">-</span>snip<span class="token operator">-</span><span class="token operator">-</span>

<span class="token keyword">import</span> pygal
<span class="token keyword">import</span> math

line_chart <span class="token operator">=</span> pygal<span class="token punctuation">.</span>Line<span class="token punctuation">(</span>x_label_rotation<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">,</span> show_mirror_x_labels<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
line_chart<span class="token punctuation">.</span>title <span class="token operator">=</span> <span class="token string">'收盘价对数变换（￥）'</span>
line_chart<span class="token punctuation">.</span>x_labels <span class="token operator">=</span> dates
N <span class="token operator">=</span> <span class="token number">20</span> <span class="token comment"># x轴坐标每隔20天显示一次</span>
line_chart<span class="token punctuation">.</span>x_labels_major <span class="token operator">=</span> dates<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span>N<span class="token punctuation">]</span>
close_log <span class="token operator">=</span> <span class="token punctuation">[</span>math<span class="token punctuation">.</span>log10<span class="token punctuation">(</span>_<span class="token punctuation">)</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> close<span class="token punctuation">]</span>
line_chart<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token string">'log收盘价'</span><span class="token punctuation">,</span> close_log<span class="token punctuation">)</span>
line_chart<span class="token punctuation">.</span>render_to_file<span class="token punctuation">(</span><span class="token string">'收盘价对数变换折线图（￥）.svg'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>剔除非线性趋势</strong>之后，<strong>整体的趋势更接近线性增长</strong>，且收盘价在每个季度末似乎有<strong>显著的周期性</strong>。那么，12月会不会再现这一场景？下面来看看收盘价的<strong>月日均值</strong>与<strong>周日均值</strong>的表现。</p>
<hr>
<h4 id="收盘价均值"><a href="#收盘价均值" class="headerlink" title="收盘价均值"></a>收盘价均值</h4><p>再利用btc_close_2017.json文件中的数据，绘制2017年<strong>前11个月</strong>的日均值、<strong>前49周(01-02~12-10)<strong>的日均值，以及</strong>每周各天</strong>的日均值。虽然这些日均值的数值不同，但都是一段时间的均值，计算方法都是一样的。因此，可以<strong>将绘图代码封装成函数</strong>，以便重复使用。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">-</span><span class="token operator">-</span>snip<span class="token operator">-</span><span class="token operator">-</span>

<span class="token keyword">from</span> itertools <span class="token keyword">import</span> groupby

<span class="token keyword">def</span> <span class="token function">draw_line</span><span class="token punctuation">(</span>x_data<span class="token punctuation">,</span> y_data<span class="token punctuation">,</span> title<span class="token punctuation">,</span> y_legend<span class="token punctuation">)</span><span class="token punctuation">:</span>
    xy_map <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> x<span class="token punctuation">,</span> y <span class="token keyword">in</span> groupby<span class="token punctuation">(</span><span class="token builtin">sorted</span><span class="token punctuation">(</span><span class="token builtin">zip</span><span class="token punctuation">(</span>x_data<span class="token punctuation">,</span> y_data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> key<span class="token operator">=</span><span class="token keyword">lambda</span> <span class="token keyword">_</span><span class="token punctuation">:</span> _<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    y_list <span class="token operator">=</span> <span class="token punctuation">[</span>v <span class="token keyword">for</span> _<span class="token punctuation">,</span> v <span class="token keyword">in</span> y<span class="token punctuation">]</span>
    xy_map<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">[</span>x<span class="token punctuation">,</span> <span class="token builtin">sum</span><span class="token punctuation">(</span>y_list<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token builtin">len</span><span class="token punctuation">(</span>y_list<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
x_unique<span class="token punctuation">,</span> y_mean <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">*</span><span class="token builtin">zip</span><span class="token punctuation">(</span><span class="token operator">*</span>xy_map<span class="token punctuation">)</span><span class="token punctuation">]</span>
line_chart <span class="token operator">=</span> pygal<span class="token punctuation">.</span>Line<span class="token punctuation">(</span><span class="token punctuation">)</span>
line_chart<span class="token punctuation">.</span>title <span class="token operator">=</span> title
line_chart<span class="token punctuation">.</span>x_labels <span class="token operator">=</span> x_unique
line_chart<span class="token punctuation">.</span>add<span class="token punctuation">(</span>y_legend<span class="token punctuation">,</span> y_mean<span class="token punctuation">)</span>
line_chart<span class="token punctuation">.</span>render_to_file<span class="token punctuation">(</span>title<span class="token operator">+</span><span class="token string">'.svg'</span><span class="token punctuation">)</span>
<span class="token keyword">return</span> line_chart<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li>由于<strong>需要将数据按月份、周数、周几分组，再计算每组的均值</strong>，因此导入<strong>Python标准库中模块itertools的函数groupby</strong>。</li>
<li>将x轴与y轴的<strong>数据合并</strong>、<strong>排序</strong>，再<strong>用函数groupby分组</strong></li>
<li>分组之后，求出每组的平均值，存储到xy_map中</li>
<li>最后，将xy_map中存储的x轴与y轴数据分离，就可以像之前一样用Pygal画图了</li>
</ul>
<p>下面画出收盘价<strong>月日均值</strong>，由于12月的数据不完整，只取1月到11月的数据。<strong>通过dates查找2017-12-01索引的位置，确定周数和收盘价的取值范围</strong>：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">idx_month <span class="token operator">=</span> dates<span class="token punctuation">.</span>index<span class="token punctuation">(</span><span class="token string">'2017-12-01'</span><span class="token punctuation">)</span>
line_chart_month <span class="token operator">=</span> draw_line<span class="token punctuation">(</span>months<span class="token punctuation">[</span><span class="token punctuation">:</span>idx_month<span class="token punctuation">]</span><span class="token punctuation">,</span> close<span class="token punctuation">[</span><span class="token punctuation">:</span>idx_month<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'收盘价月日均值（￥）'</span><span class="token punctuation">,</span>
                            <span class="token string">'月日均值'</span><span class="token punctuation">)</span>
line_chart_month<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>





<hr>
<h4 id="收盘价数据仪表盘"><a href="#收盘价数据仪表盘" class="headerlink" title="收盘价数据仪表盘"></a>收盘价数据仪表盘</h4><p>每个SVG文件打开之后都是独立的页面，如果能<strong>整合</strong>在一起，就可以方便地进行<strong>长期管理、监测和分析</strong>。另外，<strong>新的图表也可以方便地加入进来</strong>，这样就形成了一个<strong>数据仪表盘</strong>(<strong>dashboard</strong>)。下面，将之前绘制的图整合起来，做一个收盘价数据仪表盘：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">-</span><span class="token operator">-</span>snip<span class="token operator">-</span><span class="token operator">-</span>

<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'收盘价Dashboard.html'</span><span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">'utf8'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> html_file<span class="token punctuation">:</span>
    html_file<span class="token punctuation">.</span>write<span class="token punctuation">(</span>
        <span class="token string">'&lt;html>&lt;head>&lt;title>收盘价Dashboard&lt;/title>&lt;meta charset="utf-8">&lt;/head>&lt;body>\n'</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> svg <span class="token keyword">in</span> <span class="token punctuation">[</span>
        <span class="token string">'收盘价折线图（¥）.svg'</span><span class="token punctuation">,</span> <span class="token string">'收盘价对数变换折线图（¥）.svg'</span><span class="token punctuation">,</span> <span class="token string">'收盘价月日均值（¥）.svg'</span><span class="token punctuation">,</span>
        <span class="token string">'收盘价周日均值（¥）.svg'</span><span class="token punctuation">,</span> <span class="token string">'收盘价星期均值（¥）.svg'</span>
    <span class="token punctuation">]</span><span class="token punctuation">:</span>
        html_file<span class="token punctuation">.</span>write<span class="token punctuation">(</span>
            <span class="token string">'    &lt;object type="image/svg+xml" data="&#123;0&#125;" height=500>&lt;/object>\n'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>svg<span class="token punctuation">)</span><span class="token punctuation">)</span>
    html_file<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">'&lt;/body>&lt;/html>'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>和常见网络应用的数据仪表盘一样，这个数据仪表盘也是一个完整的网页。</p>
<hr>
<h2 id="使用-API"><a href="#使用-API" class="headerlink" title="使用 API"></a>使用 API</h2><h3 id="使用-Web-API"><a href="#使用-Web-API" class="headerlink" title="使用 Web API"></a>使用 Web API</h3><p>Web API是网站的一部分，用于 与使用非常具体的URL<strong>请求特定信息</strong>的程序 <strong>交互</strong>。这种请求称为<strong>API调用</strong>。请求的数据将<strong>以易于处理的格式(如JSON或CSV)返回</strong>。</p>
<p><strong>依赖于外部数据源</strong>的大多数应用程序都<strong>依赖于API调用</strong>，如集成社交媒体网站的应用程序。</p>
<h4 id="Git-和-GitHub"><a href="#Git-和-GitHub" class="headerlink" title="Git 和 GitHub"></a>Git 和 GitHub</h4><p>本章的可视化将基于来自GitHub的信息。我们将<strong>使用GitHub的API来请求有关该网站中Python项目的信息</strong>，然后<strong>使用Pygal生成交互式可视化，以呈现这些项目的受欢迎程度</strong>。</p>
<p>本章将编写一个程序，它<strong>自动下载GitHub上星级最高的Python项目的信息，并对这些信息进行可视化</strong>。</p>
<hr>
<h4 id="使用-API-调用请求数据"><a href="#使用-API-调用请求数据" class="headerlink" title="使用 API 调用请求数据"></a>使用 API 调用请求数据</h4><p>GitHub的API让你能够通过API调用来请求各种信息。要知道API调用是什么样的，在浏览器中访问如下地址：</p>
<pre class="line-numbers language-none"><code class="language-none">https:&#x2F;&#x2F;api.github.com&#x2F;search&#x2F;repositories?q&#x3D;language:python&amp;sort&#x3D;starshttps:&#x2F;&#x2F;api.github.com&#x2F;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<ul>
<li>第一部分<code>https://api.github.com/</code>：将请求发送到GitHub网站中响应API调用的部分</li>
<li>接下来的部分<code>search/repositories</code>：让API<strong>搜索GitHub上的所有仓库</strong></li>
<li>repositories后面的<strong>问号</strong>指出我们<strong>要传递一个实参</strong>。<ul>
<li><code>q=</code>：<strong>q</strong>表示<strong>查询</strong>，<strong>等号</strong>让我们能够开始<strong>指定查询</strong></li>
<li>通过使用<code>language:python</code>，我们指出<strong>只想获取主要语言为Python的仓库的信息</strong></li>
</ul>
</li>
<li>最后一部分<code>&amp;sort=stars</code>：指定将<strong>项目按其获得的星级排序</strong></li>
</ul>
<hr>
<h4 id="安装-requests"><a href="#安装-requests" class="headerlink" title="安装 requests"></a>安装 requests</h4><p><strong>requests包</strong>让Python程序能够<strong>轻松地向网站请求信息以及检查返回的响应</strong>。要安装requests，执行：</p>
<pre class="line-numbers language-none"><code class="language-none">pip install --user requests<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<hr>
<h4 id="处理-API-响应"><a href="#处理-API-响应" class="headerlink" title="处理 API 响应"></a>处理 API 响应</h4><p>下面来编写一个程序，它执行API调用并处理结果，找出GitHub上星级最高的Python项目：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests

<span class="token comment"># 执行API调用并存储响应</span>
url <span class="token operator">=</span> <span class="token string">'https://api.github.com/search/repositories?=language:python&amp;sort=stars'</span>
r <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Status code:"</span><span class="token punctuation">,</span> r<span class="token punctuation">.</span>status_code<span class="token punctuation">)</span>

<span class="token comment"># 将API响应存储在一个变量中</span>
response_dict <span class="token operator">=</span> r<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 处理结果</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>response_dict<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li><p>使用<code>requests.get()</code>执行<strong>API调用</strong></p>
<p>  <strong>响应对象包含</strong>一个名为<code>status_code</code>的属性</p>
<ul>
<li>状态码<strong>200</strong>表示<strong>请求成功</strong></li>
</ul>
</li>
<li><p>这个API返回JSON格式的信息。因此我们<strong>使用方法<code>json()</code>将这些信息转换为一个Python字典</strong></p>
</li>
</ul>
<hr>
<h4 id="处理响应字典"><a href="#处理响应字典" class="headerlink" title="处理响应字典"></a>处理响应字典</h4><p>下面来生成一些概述API调用返回的信息的输出：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests

<span class="token comment"># 执行API调用并存储响应</span>
url <span class="token operator">=</span> <span class="token string">'https://api.github.com/search/repositories?q=language:python&amp;sort=stars'</span>
r <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Status code:"</span><span class="token punctuation">,</span> r<span class="token punctuation">.</span>status_code<span class="token punctuation">)</span>

<span class="token comment"># 将API响应存储在一个变量中</span>
response_dict <span class="token operator">=</span> r<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Total repositories:"</span><span class="token punctuation">,</span> response_dict<span class="token punctuation">[</span><span class="token string">'total_count'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment"># 探索有关仓库的信息</span>
repo_dicts <span class="token operator">=</span> response_dict<span class="token punctuation">[</span><span class="token string">'items'</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Repositories returned:"</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>repo_dicts<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># 研究第一个仓库</span>
repo_dict <span class="token operator">=</span> repo_dicts<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\nKeys:"</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>repo_dict<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> key <span class="token keyword">in</span> <span class="token builtin">sorted</span><span class="token punctuation">(</span>repo_dict<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li>与<code>&#39;items&#39;</code>关联的值是<strong>一个列表</strong>，其中包含很多字典，<strong>每个字典都包含有关一个Python仓库的信息</strong>。</li>
</ul>
<p>下面来提取repo_dict中与一些键相关联的值：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">-</span><span class="token operator">-</span>snip<span class="token operator">-</span><span class="token operator">-</span>

<span class="token comment"># 研究第一个仓库</span>
repo_dict <span class="token operator">=</span> repo_dicts<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\nSelected information about first repository:"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Name:'</span><span class="token punctuation">,</span> repo_dict<span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Owner:'</span><span class="token punctuation">,</span> repo_dict<span class="token punctuation">[</span><span class="token string">'owner'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'login'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Stars:'</span><span class="token punctuation">,</span> repo_dict<span class="token punctuation">[</span><span class="token string">'stargazers_count'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Reposiory:'</span><span class="token punctuation">,</span> repo_dict<span class="token punctuation">[</span><span class="token string">'html_url'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Created:'</span><span class="token punctuation">,</span> repo_dict<span class="token punctuation">[</span><span class="token string">'created_at'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Updated:'</span><span class="token punctuation">,</span> repo_dict<span class="token punctuation">[</span><span class="token string">'updated_at'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Description:'</span><span class="token punctuation">,</span> repo_dict<span class="token punctuation">[</span><span class="token string">'description'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h4 id="概述最受欢迎的仓库"><a href="#概述最受欢迎的仓库" class="headerlink" title="概述最受欢迎的仓库"></a>概述最受欢迎的仓库</h4><p>对这些数据进行<strong>可视化</strong>时，我们需要<strong>涵盖多个仓库</strong>。下面就来编写一个循环，打印API调用返回的每个仓库的特定信息，以便能够在可视化中包含所有这些信息：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">-</span><span class="token operator">-</span>snip<span class="token operator">-</span><span class="token operator">-</span>
<span class="token comment"># 研究有关仓库的信息</span>
repo_dicts <span class="token operator">=</span> response_dict<span class="token punctuation">[</span><span class="token string">'items'</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Repositories returned:"</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>repo_dicts<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\nSelected information about each repository:"</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> repo_dict <span class="token keyword">in</span> repo_dicts<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'\nName:'</span><span class="token punctuation">,</span> repo_dict<span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Owner:'</span><span class="token punctuation">,</span> repo_dict<span class="token punctuation">[</span><span class="token string">'owner'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'login'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Stars:'</span><span class="token punctuation">,</span> repo_dict<span class="token punctuation">[</span><span class="token string">'stargazers_count'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Reposiory:'</span><span class="token punctuation">,</span> repo_dict<span class="token punctuation">[</span><span class="token string">'html_url'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Description:'</span><span class="token punctuation">,</span> repo_dict<span class="token punctuation">[</span><span class="token string">'description'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h4 id="监视-API-的速率限制"><a href="#监视-API-的速率限制" class="headerlink" title="监视 API 的速率限制"></a>监视 API 的速率限制</h4><p>大多数API都存在<strong>速率限制</strong>，即你<strong>在特定时间内可执行的请求数存在限制</strong>。要获悉你是否接近了GitHub的限制，在浏览器中输入<code>https://api.github.com/rate_limit</code>，将得到类似于下面的响应：</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>
    <span class="token property">"resources"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span>
        <span class="token property">"core"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span>
            <span class="token property">"limit"</span><span class="token operator">:</span><span class="token number">60</span><span class="token punctuation">,</span>
            <span class="token property">"remaining"</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span>
            <span class="token property">"reset"</span><span class="token operator">:</span><span class="token number">1593698255</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token property">"graphql"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span>
            <span class="token property">"limit"</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span>
            <span class="token property">"remaining"</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span>
            <span class="token property">"reset"</span><span class="token operator">:</span><span class="token number">1593700880</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token property">"integration_manifest"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span>
            <span class="token property">"limit"</span><span class="token operator">:</span><span class="token number">5000</span><span class="token punctuation">,</span>
            <span class="token property">"remaining"</span><span class="token operator">:</span><span class="token number">5000</span><span class="token punctuation">,</span>
            <span class="token property">"reset"</span><span class="token operator">:</span><span class="token number">1593700880</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token property">"search"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span>
            <span class="token property">"limit"</span><span class="token operator">:</span><span class="token number">10</span><span class="token punctuation">,</span>
            <span class="token property">"remaining"</span><span class="token operator">:</span><span class="token number">10</span><span class="token punctuation">,</span>
            <span class="token property">"reset"</span><span class="token operator">:</span><span class="token number">1593697340</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token property">"rate"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span>
        <span class="token property">"limit"</span><span class="token operator">:</span><span class="token number">60</span><span class="token punctuation">,</span>
        <span class="token property">"remaining"</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span>
        <span class="token property">"reset"</span><span class="token operator">:</span><span class="token number">1593698255</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>我们关心的信息是<strong>搜索API</strong>的速率限制。从18~22行可知，极限为<strong>每分钟</strong>10个请求；当前这一分钟内，还可执行10个请求；<code>reset</code>值指的是<strong>配额将重置的Unix时间或新纪元时间(1970-01-01午夜后多少秒)</strong>。用完配额后，将收到一条简单的响应，由此知道已到达API极限。<strong>到达极限后</strong>，<strong>必须等待配额重置</strong>。</p>
<p>注意：<strong>很多API都要求你注册获得密钥后才能执行API调用</strong>。GitHub没有这样的要求，但获得API密钥后，配额将高得多。</p>
<hr>
<h3 id="使用-Pygal-可视化仓库"><a href="#使用-Pygal-可视化仓库" class="headerlink" title="使用 Pygal 可视化仓库"></a>使用 Pygal 可视化仓库</h3><p>我们来进行可视化，<strong>呈现GitHub上Python项目的受欢迎程度</strong>。创建一个交互式条形图，<strong>条形的高度表示项目获得了多少颗星。单击条形将进入项目在GitHub上的主页</strong>。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests
<span class="token keyword">import</span> pygal
<span class="token keyword">from</span> pygal<span class="token punctuation">.</span>style <span class="token keyword">import</span> LightColorizedStyle <span class="token keyword">as</span> LCS<span class="token punctuation">,</span> LightenStyle <span class="token keyword">as</span> LS

<span class="token comment"># 执行API调用并存储响应</span>
url <span class="token operator">=</span> <span class="token string">'https://api.github.com/search/repositories?q=language:python&amp;sort=stars'</span>
r <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Status code:"</span><span class="token punctuation">,</span> r<span class="token punctuation">.</span>status_code<span class="token punctuation">)</span>

<span class="token comment"># 将API响应存储在一个变量中</span>
response_dict <span class="token operator">=</span> r<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Total repositories:"</span><span class="token punctuation">,</span> response_dict<span class="token punctuation">[</span><span class="token string">'total_count'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment"># 研究有关仓库的信息</span>
repo_dicts <span class="token operator">=</span> response_dict<span class="token punctuation">[</span><span class="token string">'items'</span><span class="token punctuation">]</span>

names<span class="token punctuation">,</span> stars <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> repo_dict <span class="token keyword">in</span> repo_dicts<span class="token punctuation">:</span>
    names<span class="token punctuation">.</span>append<span class="token punctuation">(</span>repo_dict<span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    stars<span class="token punctuation">.</span>append<span class="token punctuation">(</span>repo_dict<span class="token punctuation">[</span><span class="token string">'stargazers_count'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    
<span class="token comment"># 可视化</span>
my_style <span class="token operator">=</span> LS<span class="token punctuation">(</span><span class="token string">'#333366'</span><span class="token punctuation">,</span> base_style<span class="token operator">=</span>LCS<span class="token punctuation">)</span>
chart <span class="token operator">=</span> pygal<span class="token punctuation">.</span>Bar<span class="token punctuation">(</span>style<span class="token operator">=</span>my_style<span class="token punctuation">,</span> x_label_rotation<span class="token operator">=</span><span class="token number">45</span><span class="token punctuation">,</span> show_legend<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
chart<span class="token punctuation">.</span>title <span class="token operator">=</span> <span class="token string">'Most-Starred Python Projects on GitHub'</span>
chart<span class="token punctuation">.</span>x_labels <span class="token operator">=</span> names

chart<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">,</span> stars<span class="token punctuation">)</span>
chart<span class="token punctuation">.</span>render_to_file<span class="token punctuation">(</span><span class="token string">'python_repos.svg'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li><code>LS(&#39;#333366&#39;, base_style=LCS)</code>：使用<strong>LightenStyle</strong>(别名LS)<strong>定义了一种样式</strong>，并将<strong>基色设置为深蓝色</strong>；还传递了实参<code>base_style</code>，以<strong>使用LightColorizedStyle类</strong>(别名LCS)</li>
<li><code>show_legend=False</code>隐藏了图例，因为只在图表中绘制一个数据系列</li>
<li>由于<strong>不需要给这个数据系列添加标签</strong>，因此<strong>添加数据时，将标签设置成了空字符串</strong>。</li>
</ul>
<h4 id="改进-Pygal-图表"><a href="#改进-Pygal-图表" class="headerlink" title="改进 Pygal 图表"></a>改进 Pygal 图表</h4><p>我们将进行多个方面的定制，因此先来稍微调整代码结构，<strong>创建一个配置对象</strong>，其中包含要传递给<code>Bar()</code>的所有定制：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">-</span><span class="token operator">-</span>snip<span class="token operator">-</span><span class="token operator">-</span>

<span class="token comment"># 可视化</span>
my_style <span class="token operator">=</span> LS<span class="token punctuation">(</span><span class="token string">'#333366'</span><span class="token punctuation">,</span> base_style<span class="token operator">=</span>LCS<span class="token punctuation">)</span>

my_config <span class="token operator">=</span> pygal<span class="token punctuation">.</span>Config<span class="token punctuation">(</span><span class="token punctuation">)</span>
my_config<span class="token punctuation">.</span>x_label_rotation <span class="token operator">=</span> <span class="token number">45</span>
my_config<span class="token punctuation">.</span>show_legend <span class="token operator">=</span> <span class="token boolean">False</span>
my_config<span class="token punctuation">.</span>title_font_size <span class="token operator">=</span> <span class="token number">24</span>
my_config<span class="token punctuation">.</span>label_font_size <span class="token operator">=</span> <span class="token number">14</span>
my_config<span class="token punctuation">.</span>major_label_font_size <span class="token operator">=</span> <span class="token number">18</span>
my_config<span class="token punctuation">.</span>truncate_label <span class="token operator">=</span> <span class="token number">15</span>
my_config<span class="token punctuation">.</span>show_y_guides <span class="token operator">=</span> <span class="token boolean">False</span>
my_config<span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token number">1000</span>

chart <span class="token operator">=</span> pygal<span class="token punctuation">.</span>Bar<span class="token punctuation">(</span>my_config<span class="token punctuation">,</span> style<span class="token operator">=</span>my_style<span class="token punctuation">)</span>
chart<span class="token punctuation">.</span>title <span class="token operator">=</span> <span class="token string">'Most-Starred Python Projects on GitHub'</span>
chart<span class="token punctuation">.</span>x_labels <span class="token operator">=</span> names

chart<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">,</span> stars<span class="token punctuation">)</span>
chart<span class="token punctuation">.</span>render_to_file<span class="token punctuation">(</span><span class="token string">'python_repos.svg'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li><p>9~11行设置了图表标题、副标签和主标签的字体大小。</p>
<p>  在<strong>这个图表中</strong>，<strong>副标签</strong>是x轴上的项目名和y轴上的<strong>大部分</strong>数字；<strong>主标签</strong>是y轴上为<strong>5000整数倍的刻度</strong>，这些标签更大，以与副标签区分开。</p>
</li>
<li><p><code>truncate_label=15</code><strong>将较长的项目缩短</strong>为15个字符(将鼠标指向被截短的项目名，将显示完整的项目名)</p>
</li>
<li><p><code>show_y_guides=False</code>：<strong>隐藏图表中的水平线</strong>。</p>
</li>
<li><p><code>width=1000</code>：自定义的宽度，让图表更充分地利用浏览器中的可用空间</p>
</li>
</ul>
<hr>
<h4 id="添加自定义工具提示"><a href="#添加自定义工具提示" class="headerlink" title="添加自定义工具提示"></a>添加自定义工具提示</h4><p>在Python中，<strong>将鼠标指向条形将显示它表示的信息</strong>，这通常称为<strong>工具提示</strong>。下面来创建一个自定义工具提示，以同时显示项目的描述。</p>
<p>来看一个简单的示例，它可视化前三个项目，并给每个项目对应的条形都指定自定义标签。为此，我们向<code>add()</code><strong>传递一个字典列表</strong>，而不是值列表：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> pygal
<span class="token keyword">from</span> pygal<span class="token punctuation">.</span>style <span class="token keyword">import</span> LightColorizedStyle <span class="token keyword">as</span> LCS<span class="token punctuation">,</span> LightenStyle <span class="token keyword">as</span> LS

my_style <span class="token operator">=</span> LS<span class="token punctuation">(</span><span class="token string">'#333366'</span><span class="token punctuation">,</span> base_style<span class="token operator">=</span>LCS<span class="token punctuation">)</span>
chart <span class="token operator">=</span> pygal<span class="token punctuation">.</span>Bar<span class="token punctuation">(</span>style<span class="token operator">=</span>my_style<span class="token punctuation">,</span> x_label_rotation<span class="token operator">=</span><span class="token number">45</span><span class="token punctuation">,</span> show_legend<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>

chart<span class="token punctuation">.</span>title <span class="token operator">=</span> <span class="token string">'Python Projects'</span>
chart<span class="token punctuation">.</span>x_labels <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'httpie'</span><span class="token punctuation">,</span> <span class="token string">'django'</span><span class="token punctuation">,</span> <span class="token string">'flask'</span><span class="token punctuation">]</span>

plot_dicts <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token punctuation">&#123;</span><span class="token string">'value'</span><span class="token punctuation">:</span> <span class="token number">16101</span>， <span class="token string">'label'</span><span class="token punctuation">:</span> <span class="token string">'Description of httpie.'</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token punctuation">&#123;</span><span class="token string">'value'</span><span class="token punctuation">:</span> <span class="token number">15028</span><span class="token punctuation">,</span> <span class="token string">'label'</span><span class="token punctuation">:</span> <span class="token string">'Description of django.'</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token punctuation">&#123;</span><span class="token string">'value'</span><span class="token punctuation">:</span> <span class="token number">14798</span><span class="token punctuation">,</span> <span class="token string">'label'</span><span class="token punctuation">:</span> <span class="token string">'Description of flask.'</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>

chart<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">,</span> plot_dicts<span class="token punctuation">)</span>
chart<span class="token punctuation">.</span>render_to_file<span class="token punctuation">(</span><span class="token string">'bar_descriptions.svg'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li>plot_dicts列表包含三个字典，<code>&#39;value&#39;</code>对应的值<strong>确定条形高度</strong>；<code>&#39;label&#39;</code>对应的值给条形<strong>创建工具提示</strong>。</li>
</ul>
<hr>
<h4 id="根据数据绘图"><a href="#根据数据绘图" class="headerlink" title="根据数据绘图"></a>根据数据绘图</h4><p>为根据数据绘图，我们将自动生成plot_dicts。其中包含API调用返回的30个项目的信息：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">-</span><span class="token operator">-</span>snip<span class="token operator">-</span><span class="token operator">-</span>
<span class="token comment"># 研究有关仓库的信息</span>
repo_dicts <span class="token operator">=</span> response_dict<span class="token punctuation">[</span><span class="token string">'items'</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Number of items:"</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>repo_dicts<span class="token punctuation">)</span><span class="token punctuation">)</span>

names<span class="token punctuation">,</span> plot_dicts <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> repo_dict <span class="token keyword">in</span> repo_dicts<span class="token punctuation">:</span>
    names<span class="token punctuation">.</span>append<span class="token punctuation">(</span>repo_dict<span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    
    plot_dict <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
        <span class="token string">'value'</span><span class="token punctuation">:</span> repo_dict<span class="token punctuation">[</span><span class="token string">'stargazers_count'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token string">'label'</span><span class="token punctuation">:</span> repo_dict<span class="token punctuation">[</span><span class="token string">'description'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">&#125;</span>
    plot_dicts<span class="token punctuation">.</span>append<span class="token punctuation">(</span>plot_dict<span class="token punctuation">)</span>
    
<span class="token comment"># 可视化</span>
my_style <span class="token operator">=</span> LS<span class="token punctuation">(</span><span class="token string">'#333366'</span><span class="token punctuation">,</span> base_style<span class="token operator">=</span>LCS<span class="token punctuation">)</span>
<span class="token operator">-</span><span class="token operator">-</span>snip<span class="token operator">-</span><span class="token operator">-</span>

chart<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">,</span> plot_dicts<span class="token punctuation">)</span>
chart<span class="token punctuation">.</span>render_to_file<span class="token punctuation">(</span><span class="token string">'python_repos.svg'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h4 id="在图表中添加可单击的链接"><a href="#在图表中添加可单击的链接" class="headerlink" title="在图表中添加可单击的链接"></a>在图表中添加可单击的链接</h4><p>Pygal还允许<strong>将图表中的每个条形用作网站的链接</strong>。为此，在为每个项目创建的字典中，添加一个键为<code>&#39;xlink&#39;</code>的 键-值 对：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">-</span><span class="token operator">-</span>snip<span class="token operator">-</span><span class="token operator">-</span>
names<span class="token punctuation">,</span> plot_dicts <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> repo_dict <span class="token keyword">in</span> repo_dicts<span class="token punctuation">:</span>
    names<span class="token punctuation">.</span>append<span class="token punctuation">(</span>repo_dict<span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    
    plot_dict <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
        <span class="token string">'value'</span><span class="token punctuation">:</span> repo_dict<span class="token punctuation">[</span><span class="token string">'stargazers_count'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token string">'label'</span><span class="token punctuation">:</span> repo_dict<span class="token punctuation">[</span><span class="token string">'description'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token string">'xlink'</span><span class="token punctuation">:</span> repo_dict<span class="token punctuation">[</span><span class="token string">'html_url'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">&#125;</span>
    plot_dicts<span class="token punctuation">.</span>append<span class="token punctuation">(</span>plot_dict<span class="token punctuation">)</span>
<span class="token operator">-</span><span class="token operator">-</span>snip<span class="token operator">-</span><span class="token operator">-</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>单击图表中的任何条形，都将在浏览器中打开一个新的标签页，并在其中显示相应项目的GitHub页面。</p>
<hr>
<h3 id="Hacker-News-API"><a href="#Hacker-News-API" class="headerlink" title="Hacker News API"></a>Hacker News API</h3><p><del>为探索如何使用其他网站的API调用，我们来看看</del></p>
<p><del>Hacker News网站，用户分享编程和技术方面的文章，并就这些文章展开积极的讨论。Hacker News的API让你能够访问有关该网站所有文章和评论的信息，且不要求通过注册获得密钥。</del></p>
<p>已被墙。</p>
<hr>
<h2 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h2><h3 id="Jupyter-Notebook-用matplotlib作图显示中文乱码"><a href="#Jupyter-Notebook-用matplotlib作图显示中文乱码" class="headerlink" title="Jupyter Notebook 用matplotlib作图显示中文乱码"></a>Jupyter Notebook 用matplotlib作图显示中文乱码</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python">plt<span class="token punctuation">.</span>rc<span class="token punctuation">(</span><span class="token string">'font'</span><span class="token punctuation">,</span> family<span class="token operator">=</span><span class="token string">'SimHei'</span><span class="token punctuation">,</span> size<span class="token operator">=</span><span class="token number">7</span><span class="token punctuation">)</span>  <span class="token comment">##显示中文，字体大小根据需要调整</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<hr>
<h3 id="存在极端值干扰"><a href="#存在极端值干扰" class="headerlink" title="存在极端值干扰"></a>存在极端值干扰</h3><ul>
<li><p>使用<code>query()</code>做范围的筛选</p>
</li>
<li><p>根据<strong>切比雪夫定理</strong>做筛选：</p>
<ul>
<li>所有数据中，至少有75%的数据位于<strong>平均数</strong>2个<strong>标准差</strong>范围内</li>
</ul>
</li>
<li><p>所有数据中，至少有88.9%的数据位于平均数3个标准差范围内</p>
<ul>
<li>所有数据中，至少有96%的数据位于平均数5个标准差范围内</li>
</ul>
</li>
</ul>
<hr>
<h3 id="条形图和直方图的区别"><a href="#条形图和直方图的区别" class="headerlink" title="条形图和直方图的区别"></a>条形图和直方图的区别</h3><ul>
<li><p><strong>条形图</strong>(<strong>bar</strong> chart)</p>
<ol>
<li>用<strong>条形的高度</strong>表示<strong>各类别频数的多少</strong>，其<strong>宽度</strong>(<strong>表示类别</strong>)则是<strong>固定</strong>的；</li>
<li>条形图各矩形<strong>分开排列(有间隙)</strong></li>
<li>主要用于展示<strong>分类数据</strong></li>
</ol>
</li>
<li><p><strong>直方图</strong>(<strong>Histogram</strong>)</p>
<ol>
<li>用<strong>面积</strong>表示<strong>各组频数的多少</strong>，矩形的<strong>高度</strong>表示<strong>每一组的频数或频率</strong>，<strong>宽度</strong>则表示<strong>各组的组距</strong></li>
<li><strong>分组数据具有连续性</strong>，直方图各矩形通常是<strong>连续排列</strong></li>
<li>主要用于展示<strong>数值型数据</strong></li>
</ol>
</li>
</ul>
<hr>
<h3 id="绘图时x轴-y轴的刻度标签重叠"><a href="#绘图时x轴-y轴的刻度标签重叠" class="headerlink" title="绘图时x轴&#x2F;y轴的刻度标签重叠"></a>绘图时x轴&#x2F;y轴的刻度标签重叠</h3><p><a target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/article/1441795">Matplotlib绘图时x轴标签重叠的解决办法 - 云+社区 - 腾讯云</a></p>
<ul>
<li><p>方法一：</p>
<p>  拉长画布</p>
</li>
<li><p>方法二：</p>
<p>  调整刻度标签的字体大小：<code>plt.tick_params(axis=&#39;x&#39;, labelsize=8)</code></p>
</li>
<li><p>方法三：</p>
<p>  将纵向图改为横向，如条形图：<code>plt.barh()</code></p>
</li>
<li><p><strong>方法四</strong>：</p>
<p>  <strong>旋转刻度标签的角度</strong>：<code>plt.xticks(rotation=30)</code></p>
</li>
</ul>
<hr>
<h2 id="Pandas常用图表简介"><a href="#Pandas常用图表简介" class="headerlink" title="Pandas常用图表简介"></a><a target="_blank" rel="noopener" href="https://www.kesci.com/home/project/5dc00c36080dc300371f867e">Pandas常用图表简介</a></h2><h3 id="箱线图-箱型图-盒型图"><a href="#箱线图-箱型图-盒型图" class="headerlink" title="箱线图(箱型图&#x2F;盒型图)"></a>箱线图(箱型图&#x2F;盒型图)</h3><p><strong>直方图</strong>用于显示一组数据的<strong>分布情况</strong>，而<strong>箱线图</strong>用于显示一组数据<strong>内部的分散情况</strong>。例如： <strong>最大值、最小值，中位数，4分位数、异常值</strong>等等。</p>
<ul>
<li><p>箱线图各部位的含义</p>
<p>  <img src="https://i.loli.net/2020/08/23/sQpFl2vnWYNZ4x7.png" alt="箱线图各部位的含义"></p>
<ul>
<li><p><strong>上四分位</strong>数(Q<strong>U</strong>)：第75%位数</p>
</li>
<li><p><strong>下四分位</strong>数(Q<strong>L</strong>)：第25%位数</p>
</li>
<li><p>异常值的标准：</p>
<ul>
<li><p><strong>IQR</strong>(Inter-Quatile range)：<strong>四分位距</strong></p>
<p>  <strong>IQR &#x3D; QU - QL</strong>，<strong>IQR包含了全部观察值的一半</strong></p>
</li>
<li><p><strong>过小</strong>的异常值为 $&lt;$ <strong>QL-1.5IQR</strong>的值</p>
</li>
<li><p><strong>过大</strong>的异常值 $&gt;$ <strong>QU+1.5IQR</strong>的值</p>
</li>
</ul>
</li>
</ul>
<p>  Matplotlib中绘制箱线图的函数为<code>DataFrame.boxplot()</code></p>
</li>
</ul>
<hr>
<h2 id="一文学会matplotlib绘图"><a href="#一文学会matplotlib绘图" class="headerlink" title="一文学会matplotlib绘图"></a><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/985bc26672ce">一文学会matplotlib绘图</a></h2>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://hunter1023.github.io/2020/06/17/Navicat%E4%BD%BF%E7%94%A8%E6%8A%80%E5%B7%A7/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Hunter">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Talk is cheap">
      <meta itemprop="description" content="Tough times never last, but tough people do.">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Talk is cheap">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/06/17/Navicat%E4%BD%BF%E7%94%A8%E6%8A%80%E5%B7%A7/" class="post-title-link" itemprop="url">Navicat使用技巧</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-06-17 14:51:55" itemprop="dateCreated datePublished" datetime="2020-06-17T14:51:55+08:00">2020-06-17</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-01-23 23:29:13" itemprop="dateModified" datetime="2025-01-23T23:29:13+08:00">2025-01-23</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/" itemprop="url" rel="index"><span itemprop="name">数据库</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/IDE/" itemprop="url" rel="index"><span itemprop="name">IDE</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="快捷键"><a href="#快捷键" class="headerlink" title="快捷键"></a>快捷键</h2><table>
<thead>
<tr>
<th>快捷键</th>
<th>功能</th>
</tr>
</thead>
<tbody><tr>
<td>Ctrl + R</td>
<td><strong>运行</strong>查询语句</td>
</tr>
<tr>
<td>Ctrl + F</td>
<td>查找，并有替换选项可勾选</td>
</tr>
</tbody></table>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://hunter1023.github.io/2020/06/17/SQL%E7%BB%83%E4%B9%A0%E9%A2%98/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Hunter">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Talk is cheap">
      <meta itemprop="description" content="Tough times never last, but tough people do.">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Talk is cheap">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/06/17/SQL%E7%BB%83%E4%B9%A0%E9%A2%98/" class="post-title-link" itemprop="url">SQL练习题</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-06-17 14:25:35" itemprop="dateCreated datePublished" datetime="2020-06-17T14:25:35+08:00">2020-06-17</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-01-23 23:29:13" itemprop="dateModified" datetime="2025-01-23T23:29:13+08:00">2025-01-23</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/" itemprop="url" rel="index"><span itemprop="name">数据库</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="练习一"><a href="#练习一" class="headerlink" title="练习一"></a>练习一</h2><h3 id="准备数据"><a href="#准备数据" class="headerlink" title="准备数据"></a>准备数据</h3><h4 id="建表语句"><a href="#建表语句" class="headerlink" title="建表语句"></a>建表语句</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> students
<span class="token punctuation">(</span>sno <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span> 
sname <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
ssex <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span> 
sbirthday <span class="token keyword">DATETIME</span><span class="token punctuation">,</span>
class <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> courses
<span class="token punctuation">(</span>cno <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span> 
cname <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span> 
tno <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> scores
<span class="token punctuation">(</span>sno <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
cno <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
degree <span class="token keyword">NUMERIC</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> teachers 
<span class="token punctuation">(</span>tno <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span> 
tname <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span> tsex <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span> 
tbirthday <span class="token keyword">DATETIME</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span> prof <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
depart <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h4 id="插入数据"><a href="#插入数据" class="headerlink" title="插入数据"></a>插入数据</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> STUDENTS <span class="token punctuation">(</span>sno<span class="token punctuation">,</span> sname<span class="token punctuation">,</span> ssex<span class="token punctuation">,</span> sbrithday<span class="token punctuation">,</span> class<span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">108</span> <span class="token punctuation">,</span><span class="token string">'曾华'</span> <span class="token punctuation">,</span><span class="token string">'男'</span> <span class="token punctuation">,</span><span class="token string">'1977-09-01'</span><span class="token punctuation">,</span><span class="token number">95033</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> STUDENTS <span class="token punctuation">(</span>sno<span class="token punctuation">,</span> sname<span class="token punctuation">,</span> ssex<span class="token punctuation">,</span> sbrithday<span class="token punctuation">,</span> class<span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">105</span> <span class="token punctuation">,</span><span class="token string">'匡明'</span> <span class="token punctuation">,</span><span class="token string">'男'</span> <span class="token punctuation">,</span><span class="token string">'1975-10-02'</span><span class="token punctuation">,</span><span class="token number">95031</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> STUDENTS <span class="token punctuation">(</span>sno<span class="token punctuation">,</span> sname<span class="token punctuation">,</span> ssex<span class="token punctuation">,</span> sbrithday<span class="token punctuation">,</span> class<span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">107</span> <span class="token punctuation">,</span><span class="token string">'王丽'</span> <span class="token punctuation">,</span><span class="token string">'女'</span> <span class="token punctuation">,</span><span class="token string">'1976-01-23'</span><span class="token punctuation">,</span><span class="token number">95033</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> STUDENTS <span class="token punctuation">(</span>sno<span class="token punctuation">,</span> sname<span class="token punctuation">,</span> ssex<span class="token punctuation">,</span> sbrithday<span class="token punctuation">,</span> classS<span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">101</span> <span class="token punctuation">,</span><span class="token string">'李军'</span> <span class="token punctuation">,</span><span class="token string">'男'</span> <span class="token punctuation">,</span><span class="token string">'1976-02-20'</span><span class="token punctuation">,</span><span class="token number">95033</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> STUDENTS <span class="token punctuation">(</span>sno<span class="token punctuation">,</span> sname<span class="token punctuation">,</span> ssex<span class="token punctuation">,</span> sbrithday<span class="token punctuation">,</span> class<span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">109</span> <span class="token punctuation">,</span><span class="token string">'王芳'</span> <span class="token punctuation">,</span><span class="token string">'女'</span> <span class="token punctuation">,</span><span class="token string">'1975-02-10'</span><span class="token punctuation">,</span><span class="token number">95031</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> STUDENTS <span class="token punctuation">(</span>sno<span class="token punctuation">,</span> sname<span class="token punctuation">,</span> ssex<span class="token punctuation">,</span> sbrithday<span class="token punctuation">,</span> class<span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">103</span> <span class="token punctuation">,</span><span class="token string">'陆君'</span> <span class="token punctuation">,</span><span class="token string">'男'</span> <span class="token punctuation">,</span><span class="token string">'1974-06-03'</span><span class="token punctuation">,</span><span class="token number">95031</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> COURSES<span class="token punctuation">(</span>cno<span class="token punctuation">,</span> cname<span class="token punctuation">,</span> tno<span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">'3-105'</span> <span class="token punctuation">,</span><span class="token string">'计算机导论'</span><span class="token punctuation">,</span><span class="token number">825</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> COURSES<span class="token punctuation">(</span>cno<span class="token punctuation">,</span> cname<span class="token punctuation">,</span> tno<span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">'3-245'</span> <span class="token punctuation">,</span><span class="token string">'操作系统'</span> <span class="token punctuation">,</span><span class="token number">804</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> COURSES<span class="token punctuation">(</span>cno<span class="token punctuation">,</span> cname<span class="token punctuation">,</span> tno<span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">'6-166'</span> <span class="token punctuation">,</span><span class="token string">'数据电路'</span> <span class="token punctuation">,</span><span class="token number">856</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> COURSES<span class="token punctuation">(</span>cno<span class="token punctuation">,</span> cname<span class="token punctuation">,</span> tno<span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">'9-888'</span> <span class="token punctuation">,</span><span class="token string">'高等数学'</span> <span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> SCORES<span class="token punctuation">(</span>sno<span class="token punctuation">,</span> cno<span class="token punctuation">,</span> degree<span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">103</span><span class="token punctuation">,</span><span class="token string">'3-245'</span><span class="token punctuation">,</span><span class="token number">86</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> SCORES<span class="token punctuation">(</span>sno<span class="token punctuation">,</span> cno<span class="token punctuation">,</span> degree<span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">105</span><span class="token punctuation">,</span><span class="token string">'3-245'</span><span class="token punctuation">,</span><span class="token number">75</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> SCORES<span class="token punctuation">(</span>sno<span class="token punctuation">,</span> cno<span class="token punctuation">,</span> degree<span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">109</span><span class="token punctuation">,</span><span class="token string">'3-245'</span><span class="token punctuation">,</span><span class="token number">68</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> SCORES<span class="token punctuation">(</span>sno<span class="token punctuation">,</span> cno<span class="token punctuation">,</span> degree<span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">103</span><span class="token punctuation">,</span><span class="token string">'3-105'</span><span class="token punctuation">,</span><span class="token number">92</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> SCORES<span class="token punctuation">(</span>sno<span class="token punctuation">,</span> cno<span class="token punctuation">,</span> degree<span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">105</span><span class="token punctuation">,</span><span class="token string">'3-105'</span><span class="token punctuation">,</span><span class="token number">88</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> SCORES<span class="token punctuation">(</span>sno<span class="token punctuation">,</span> cno<span class="token punctuation">,</span> degree<span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">109</span><span class="token punctuation">,</span><span class="token string">'3-105'</span><span class="token punctuation">,</span><span class="token number">76</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> SCORES<span class="token punctuation">(</span>sno<span class="token punctuation">,</span> cno<span class="token punctuation">,</span> degree<span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">101</span><span class="token punctuation">,</span><span class="token string">'3-105'</span><span class="token punctuation">,</span><span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> SCORES<span class="token punctuation">(</span>sno<span class="token punctuation">,</span> cno<span class="token punctuation">,</span> degree<span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">107</span><span class="token punctuation">,</span><span class="token string">'3-105'</span><span class="token punctuation">,</span><span class="token number">91</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> SCORES<span class="token punctuation">(</span>sno<span class="token punctuation">,</span> cno<span class="token punctuation">,</span> degree<span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">108</span><span class="token punctuation">,</span><span class="token string">'3-105'</span><span class="token punctuation">,</span><span class="token number">78</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> SCORES<span class="token punctuation">(</span>sno<span class="token punctuation">,</span> cno<span class="token punctuation">,</span> degree<span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">101</span><span class="token punctuation">,</span><span class="token string">'6-166'</span><span class="token punctuation">,</span><span class="token number">85</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> SCORES<span class="token punctuation">(</span>sno<span class="token punctuation">,</span> cno<span class="token punctuation">,</span> degree<span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">107</span><span class="token punctuation">,</span><span class="token string">'6-166'</span><span class="token punctuation">,</span><span class="token number">79</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> SCORES<span class="token punctuation">(</span>sno<span class="token punctuation">,</span> cno<span class="token punctuation">,</span> degree<span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">108</span><span class="token punctuation">,</span><span class="token string">'6-166'</span><span class="token punctuation">,</span><span class="token number">81</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> TEACHERS<span class="token punctuation">(</span>tno<span class="token punctuation">,</span> tname<span class="token punctuation">,</span> tsex<span class="token punctuation">,</span> tbirthday<span class="token punctuation">,</span> prof<span class="token punctuation">,</span> depart<span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">804</span><span class="token punctuation">,</span><span class="token string">'李诚'</span><span class="token punctuation">,</span><span class="token string">'男'</span><span class="token punctuation">,</span><span class="token string">'1958-12-02'</span><span class="token punctuation">,</span><span class="token string">'副教授'</span><span class="token punctuation">,</span><span class="token string">'计算机系'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> TEACHERS<span class="token punctuation">(</span>tno<span class="token punctuation">,</span> tname<span class="token punctuation">,</span> tsex<span class="token punctuation">,</span> tbirthday<span class="token punctuation">,</span> prof<span class="token punctuation">,</span> depart<span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">856</span><span class="token punctuation">,</span><span class="token string">'张旭'</span><span class="token punctuation">,</span><span class="token string">'男'</span><span class="token punctuation">,</span><span class="token string">'1969-03-12'</span><span class="token punctuation">,</span><span class="token string">'讲师'</span><span class="token punctuation">,</span><span class="token string">'电子工程系'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> TEACHERS<span class="token punctuation">(</span>tno<span class="token punctuation">,</span> tname<span class="token punctuation">,</span> tsex<span class="token punctuation">,</span> tbirthday<span class="token punctuation">,</span> prof<span class="token punctuation">,</span> depart<span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">825</span><span class="token punctuation">,</span><span class="token string">'王萍'</span><span class="token punctuation">,</span><span class="token string">'女'</span><span class="token punctuation">,</span><span class="token string">'1972-05-05'</span><span class="token punctuation">,</span><span class="token string">'助教'</span><span class="token punctuation">,</span><span class="token string">'计算机系'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> TEACHERS<span class="token punctuation">(</span>tno<span class="token punctuation">,</span> tname<span class="token punctuation">,</span> tsex<span class="token punctuation">,</span> tbirthday<span class="token punctuation">,</span> prof<span class="token punctuation">,</span> depart<span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">831</span><span class="token punctuation">,</span><span class="token string">'刘冰'</span><span class="token punctuation">,</span><span class="token string">'女'</span><span class="token punctuation">,</span><span class="token string">'1977-08-14'</span><span class="token punctuation">,</span><span class="token string">'助教'</span><span class="token punctuation">,</span><span class="token string">'电子工程系'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h3 id="练习题"><a href="#练习题" class="headerlink" title="练习题"></a>练习题</h3><ol>
<li><p>查询student表中的所有记录的sname、ssex和class列。</p>
<p>解答：</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SELECT</span> sname<span class="token punctuation">,</span> ssex<span class="token punctuation">,</span> class
<span class="token keyword">FROM</span> students<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
</li>
<li><p>查询教师所有的单位，即<strong>不重复</strong>的depart列。</p>
<p>解答：</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SELECT</span> <span class="token keyword">DISTINCT</span> depart
<span class="token keyword">FROM</span> teachers<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
</li>
<li><p>查询students表的<strong>所有</strong>记录。</p>
<p>解答：</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SELECT</span> <span class="token operator">*</span>
<span class="token keyword">FROM</span> students<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
</li>
<li><p>查询scores表中<strong>成绩在60到80之间</strong>的所有记录。</p>
<p>解答：</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment"># 方法一</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span>
<span class="token keyword">FROM</span> scores
<span class="token keyword">WHERE</span> degree <span class="token operator">>=</span> <span class="token number">60</span> <span class="token operator">AND</span> degree <span class="token operator">&lt;=</span> <span class="token number">80</span><span class="token punctuation">;</span>

<span class="token comment"># 方法二</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span>
<span class="token keyword">FROM</span> scores
<span class="token keyword">WHERE</span> degree <span class="token operator">BETWEEN</span> <span class="token number">60</span> <span class="token operator">AND</span> <span class="token number">80</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>★查询scores表中<strong>成绩为85，86或88的记录</strong>。</p>
<p>解答：</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment"># 方法一</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span>
<span class="token keyword">FROM</span> scores
<span class="token keyword">WHERE</span> degree <span class="token operator">IN</span> <span class="token punctuation">(</span><span class="token number">85</span><span class="token punctuation">,</span> <span class="token number">86</span><span class="token punctuation">,</span> <span class="token number">88</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment"># 方法二</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span>
<span class="token keyword">FROM</span> scores
<span class="token keyword">WHERE</span> degree <span class="token operator">=</span> <span class="token number">85</span> <span class="token operator">OR</span> degree <span class="token operator">=</span> <span class="token number">86</span> <span class="token operator">OR</span> degree <span class="token operator">=</span> <span class="token number">88</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>查询students表中**“95031”班<strong>或</strong>性别为“女”**的同学记录。</p>
<p>解答：</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SELECT</span> <span class="token operator">*</span>
<span class="token keyword">FROM</span> students
<span class="token keyword">WHERE</span> class <span class="token operator">=</span> <span class="token string">'95031'</span> <span class="token operator">OR</span> ssex <span class="token operator">=</span> <span class="token string">'女'</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>以<strong>class降序</strong>查询students表的所有记录。</p>
<p>解答：</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SELECT</span> <span class="token operator">*</span>
<span class="token keyword">FROM</span> students
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> class <span class="token keyword">DESC</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>★以<strong>cno升序</strong>、<strong>degree降序</strong>查询scores表的所有记录。</p>
<p>解答：</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SELECT</span> <span class="token operator">*</span>
<span class="token keyword">FROM</span> scores
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> con<span class="token punctuation">,</span> degree <span class="token keyword">DESC</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>查询student表中“95031”班的学生<strong>人数</strong>。</p>
<p>解答：</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> stu_num
<span class="token keyword">FROM</span> students
<span class="token keyword">WHERE</span> class <span class="token operator">=</span> <span class="token string">'95031'</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>★★★查询<strong>scores</strong>表中的<strong>最高分</strong>的学生学号和课程号。</p>
<p>解答：<strong>子查询</strong></p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SELECT</span> sno<span class="token punctuation">,</span> cno
<span class="token keyword">FROM</span> scores
<span class="token keyword">WHERE</span> degree <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> <span class="token function">MAX</span><span class="token punctuation">(</span>degree<span class="token punctuation">)</span>
                <span class="token keyword">FROM</span> scores<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>★查询scores表中‘3-105’号课程的<strong>平均分</strong>。</p>
<p>解答：</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SELECT</span> <span class="token function">AVG</span><span class="token punctuation">(</span>degree<span class="token punctuation">)</span>
<span class="token keyword">FROM</span> scores
<span class="token keyword">WHERE</span> cno <span class="token operator">=</span> <span class="token string">'3-105'</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>★★★查询scores表中<strong>至少有5名学生选修</strong>的并<strong>以3开头的课程</strong>的<strong>平均分数</strong>。</p>
<p>解答：<strong>分组</strong>（<strong>HAVING子句</strong>用于过滤分组）</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment"># 方法一</span>
<span class="token keyword">SELECT</span> cno<span class="token punctuation">,</span> <span class="token function">AVG</span><span class="token punctuation">(</span>degree<span class="token punctuation">)</span> <span class="token keyword">AS</span> avg_degree
<span class="token keyword">FROM</span> scores
<span class="token keyword">WHERE</span> cno <span class="token operator">LIKE</span> <span class="token string">'3%'</span>
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> cno
<span class="token keyword">HAVING</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token operator">>=</span> <span class="token number">5</span><span class="token punctuation">;</span>

<span class="token comment"># 方法二</span>
<span class="token keyword">SELECT</span> cno<span class="token punctuation">,</span> <span class="token function">AVG</span><span class="token punctuation">(</span>degree<span class="token punctuation">)</span> <span class="token keyword">AS</span> avg_degree
<span class="token keyword">FROM</span> scores
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> cno
<span class="token keyword">HAVING</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token operator">>=</span> <span class="token number">5</span> <span class="token operator">AND</span> cno <span class="token operator">LIKE</span> <span class="token string">'3%'</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>★★★查询scores表中<strong>最低分大于70</strong>，<strong>最高分小于90</strong>的sno列。</p>
<p>解答：</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SELECT</span> sno
<span class="token keyword">FROM</span> scores
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> sno
<span class="token keyword">HAVING</span> <span class="token function">MIN</span><span class="token punctuation">(</span>degree<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">70</span> <span class="token operator">AND</span> <span class="token function">MAX</span><span class="token punctuation">(</span>degree<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">90</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>★★查询所有学生的sname、cno和degree列。</p>
<p>解答：</p>
<ul>
<li><strong>外部</strong>联结(OUTER JOIN, <strong>OUTER可省略</strong>)</li>
<li><strong>内部</strong>联结(INNER JOIN)</li>
</ul>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment"># 方法一：外部联结, LEFT JOIN 左边的表 所有记录都会列出</span>
<span class="token keyword">SELECT</span> stu<span class="token punctuation">.</span>sname<span class="token punctuation">,</span> sco<span class="token punctuation">.</span>cno<span class="token punctuation">,</span> sco<span class="token punctuation">.</span>degree
<span class="token keyword">FROM</span> students <span class="token keyword">AS</span> stu <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> scores <span class="token keyword">AS</span> sco
<span class="token keyword">ON</span> stu<span class="token punctuation">.</span>sno <span class="token operator">=</span> sco<span class="token punctuation">.</span>sno
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> sname<span class="token punctuation">;</span>

<span class="token comment"># 方法二：内部联结， INNER JOIN 只返回两个表中联结字段相等的行</span>
<span class="token keyword">SELECT</span> stu<span class="token punctuation">.</span>sname<span class="token punctuation">,</span> sco<span class="token punctuation">.</span>cno<span class="token punctuation">,</span> sco<span class="token punctuation">.</span>degree
<span class="token keyword">FROM</span> students <span class="token keyword">AS</span> stu <span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> scores <span class="token keyword">AS</span> sco
<span class="token keyword">ON</span> stu<span class="token punctuation">.</span>sno <span class="token operator">=</span> sco<span class="token punctuation">.</span>sno
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> sname<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>★查询所有学生的sno、cname和degree列。</p>
<p>解答：外部联结</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SELECT</span> s<span class="token punctuation">.</span>sno<span class="token punctuation">,</span> c<span class="token punctuation">.</span>cname<span class="token punctuation">,</span> s<span class="token punctuation">.</span>degree
<span class="token keyword">FROM</span> scores <span class="token keyword">AS</span> s
<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> courses <span class="token keyword">AS</span> c <span class="token keyword">ON</span> s<span class="token punctuation">.</span>cno <span class="token operator">=</span> c<span class="token punctuation">.</span>cno
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> sno<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>★★★查询所有学生的sname、cname和degree列。</p>
<p>解答：外部联结</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SELECT</span> st<span class="token punctuation">.</span>sname<span class="token punctuation">,</span> c<span class="token punctuation">.</span>cname<span class="token punctuation">,</span> sc<span class="token punctuation">.</span>degree
<span class="token keyword">FROM</span> students <span class="token keyword">AS</span> st 
<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> scores <span class="token keyword">AS</span> sc <span class="token keyword">ON</span> st<span class="token punctuation">.</span>sno <span class="token operator">=</span> sc<span class="token punctuation">.</span>sno
<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> courses <span class="token keyword">AS</span> c <span class="token keyword">ON</span> sc<span class="token punctuation">.</span>cno <span class="token operator">=</span> c<span class="token punctuation">.</span>cno
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> sname<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>★★★查询“95033”班<strong>所选课程</strong>的平均分。</p>
<p>解答：</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SELECT</span> cname<span class="token punctuation">,</span> <span class="token function">AVG</span><span class="token punctuation">(</span>degree<span class="token punctuation">)</span>
<span class="token keyword">FROM</span> students <span class="token keyword">AS</span> st
<span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> scores <span class="token keyword">AS</span> sc <span class="token keyword">ON</span> st<span class="token punctuation">.</span>sno <span class="token operator">=</span> sc<span class="token punctuation">.</span>sno
<span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> courses <span class="token keyword">AS</span> c <span class="token keyword">ON</span> sc<span class="token punctuation">.</span>cno <span class="token operator">=</span> c<span class="token punctuation">.</span>cno
<span class="token keyword">WHERE</span> class <span class="token operator">=</span> <span class="token string">'95033'</span>
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> c<span class="token punctuation">.</span>cno
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> cname<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>★★★假设使用如下命令建立了一个grade表：</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> grade<span class="token punctuation">(</span>low <span class="token keyword">INT</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> upp <span class="token keyword">INT</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> rank <span class="token keyword">CHAR</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> grade <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token number">90</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token string">'A'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> grade <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token number">80</span><span class="token punctuation">,</span><span class="token number">89</span><span class="token punctuation">,</span><span class="token string">'B'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> grade <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token number">70</span><span class="token punctuation">,</span><span class="token number">79</span><span class="token punctuation">,</span><span class="token string">'C'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> grade <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token number">60</span><span class="token punctuation">,</span><span class="token number">69</span><span class="token punctuation">,</span><span class="token string">'D'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> grade <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">59</span><span class="token punctuation">,</span><span class="token string">'E'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">COMMIT</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>现查询所有同学的sno、cno和rank列。</p>
<p>解答：</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SELECT</span> sno<span class="token punctuation">,</span> cno<span class="token punctuation">,</span> rank
<span class="token keyword">FROM</span> scores <span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> grade
<span class="token keyword">ON</span> scores<span class="token punctuation">.</span>degree <span class="token operator">BETWEEN</span> grade<span class="token punctuation">.</span>low <span class="token operator">AND</span> grade<span class="token punctuation">.</span>upp
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> sno<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>★★★查询<strong>选修“3-105”课程</strong>的<strong>成绩高于“109”号同学成绩</strong>的所有同学的记录。</p>
<p>解答：</p>
<ul>
<li><strong>自联结</strong></li>
</ul>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SELECT</span> sname<span class="token punctuation">,</span> s1<span class="token punctuation">.</span>degree
<span class="token keyword">FROM</span> scores <span class="token keyword">AS</span> s1
<span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> scores <span class="token keyword">AS</span> s2 <span class="token keyword">ON</span> s1<span class="token punctuation">.</span>cno <span class="token operator">=</span> s2<span class="token punctuation">.</span>cno <span class="token operator">AND</span>  s1<span class="token punctuation">.</span>degree <span class="token operator">></span> s2<span class="token punctuation">.</span>degree
<span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> students <span class="token keyword">AS</span> st <span class="token keyword">ON</span> s1<span class="token punctuation">.</span>sno <span class="token operator">=</span> st<span class="token punctuation">.</span>sno
<span class="token keyword">WHERE</span> s1<span class="token punctuation">.</span>cno <span class="token operator">=</span> <span class="token string">'3-105'</span> <span class="token operator">AND</span> s2<span class="token punctuation">.</span>sno <span class="token operator">=</span> <span class="token string">'109'</span>
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> s1<span class="token punctuation">.</span>degree<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>★★★查询scores中<strong>选学一门以上课程</strong>的同学中分数为<strong>非最高分成绩</strong>的记录。</p>
<p>解答：</p>
<ul>
<li>条件：<ol>
<li>选学一门以上课程</li>
<li>列出这些同学的所有非最高分成绩</li>
</ol>
</li>
</ul>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SELECT</span> scores<span class="token punctuation">.</span>sno<span class="token punctuation">,</span> cno<span class="token punctuation">,</span> degree<span class="token punctuation">,</span> max_degree
<span class="token keyword">FROM</span> scores <span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> 
			<span class="token punctuation">(</span><span class="token keyword">SELECT</span> sno<span class="token punctuation">,</span> <span class="token function">MAX</span><span class="token punctuation">(</span>degree<span class="token punctuation">)</span> <span class="token keyword">AS</span> max_degree 
             <span class="token keyword">FROM</span> scores 
             <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> sno 
             <span class="token keyword">HAVING</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> max 
<span class="token keyword">ON</span> scores<span class="token punctuation">.</span>sno <span class="token operator">=</span> max<span class="token punctuation">.</span>sno <span class="token operator">AND</span> degree <span class="token operator">&lt;</span> max_degree
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> sno<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>查询成绩高于<strong>学号为“109”、课程号为“3-105”的成绩</strong>的所有记录。</p>
<p>解答：</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SELECT</span> st<span class="token punctuation">.</span>sname<span class="token punctuation">,</span> s1<span class="token punctuation">.</span>cno<span class="token punctuation">,</span> s1<span class="token punctuation">.</span>degree
<span class="token keyword">FROM</span> scores <span class="token keyword">AS</span> s1 <span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> scores <span class="token keyword">AS</span> s2
<span class="token keyword">ON</span> s1<span class="token punctuation">.</span>cno <span class="token operator">=</span> s2<span class="token punctuation">.</span>cno <span class="token operator">AND</span> s1<span class="token punctuation">.</span>degree <span class="token operator">></span> s2<span class="token punctuation">.</span>degree
<span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> students <span class="token keyword">AS</span> st
<span class="token keyword">ON</span> s1<span class="token punctuation">.</span>sno <span class="token operator">=</span> st<span class="token punctuation">.</span>sno
<span class="token keyword">WHERE</span> s1<span class="token punctuation">.</span>cno <span class="token operator">=</span> <span class="token string">'3-105'</span> <span class="token operator">AND</span> s2<span class="token punctuation">.</span>sno <span class="token operator">=</span> <span class="token string">'109'</span>
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> s1<span class="token punctuation">.</span>degree<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>★★★查询和学号为108的同学<strong>同年出生</strong>的所有学生的sno、sname和sbirthday列。</p>
<p>解答：函数<code>YEAR(d)</code></p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SELECT</span> s1<span class="token punctuation">.</span>sno<span class="token punctuation">,</span> s1<span class="token punctuation">.</span>sname<span class="token punctuation">,</span> s1<span class="token punctuation">.</span>sbirthday
<span class="token keyword">FROM</span> students <span class="token keyword">AS</span> s1 <span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> students <span class="token keyword">AS</span> s2
<span class="token keyword">ON</span> <span class="token keyword">YEAR</span><span class="token punctuation">(</span>s1<span class="token punctuation">.</span>sbirthday<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token keyword">YEAR</span><span class="token punctuation">(</span>s2<span class="token punctuation">.</span>sbirthday<span class="token punctuation">)</span>
<span class="token keyword">WHERE</span> s2<span class="token punctuation">.</span>sno <span class="token operator">=</span> <span class="token string">'108'</span>
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> sbirthday<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>查询“张旭“教师任课的学生成绩。</p>
<p>解答：</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SELECT</span> sno<span class="token punctuation">,</span> degree
<span class="token keyword">FROM</span> scores <span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> courses
<span class="token keyword">ON</span> scores<span class="token punctuation">.</span>cno <span class="token operator">=</span> courses<span class="token punctuation">.</span>cno
<span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> teachers
<span class="token keyword">ON</span> courses<span class="token punctuation">.</span>tno <span class="token operator">=</span> teachers<span class="token punctuation">.</span>tno
<span class="token keyword">WHERE</span> teachers<span class="token punctuation">.</span>tname <span class="token operator">=</span> <span class="token string">'张旭'</span>
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> degree<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>查询选修某课程的同学人数<strong>多于5人</strong>的<strong>教师姓名</strong>。</p>
<p>解答：</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SELECT</span> tname
<span class="token keyword">FROM</span> scores <span class="token keyword">AS</span> s <span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> courses <span class="token keyword">AS</span> c
<span class="token keyword">ON</span> s<span class="token punctuation">.</span>cno <span class="token operator">=</span> c<span class="token punctuation">.</span>cno
<span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> teachers <span class="token keyword">AS</span> t
<span class="token keyword">ON</span> t<span class="token punctuation">.</span>tno <span class="token operator">=</span> c<span class="token punctuation">.</span>tno
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> c<span class="token punctuation">.</span>cno
<span class="token keyword">HAVING</span> <span class="token function">COUNT</span><span class="token punctuation">(</span>c<span class="token punctuation">.</span>cno<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">5</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>查询95033班和95031班<strong>全体学生的记录</strong>。</p>
<p>解答：</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SELECT</span> <span class="token operator">*</span>
<span class="token keyword">FROM</span> students
<span class="token keyword">WHERE</span> class <span class="token operator">IN</span> <span class="token punctuation">(</span><span class="token string">'95033'</span><span class="token punctuation">,</span> <span class="token string">'95031'</span><span class="token punctuation">)</span>
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> class<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>查询<strong>有85分以上成绩</strong>的课程cno。</p>
<p>解答：<strong>DISTINCT</strong>关键字</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SELECT</span> <span class="token keyword">DISTINCT</span> c<span class="token punctuation">.</span>cno
<span class="token keyword">FROM</span> scores
<span class="token keyword">WHERE</span> degree <span class="token operator">></span> <span class="token number">85</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>查询出“计算机系“教师所教课程的成绩表。</p>
<p>解答：</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SELECT</span> t<span class="token punctuation">.</span>tname<span class="token punctuation">,</span> s<span class="token punctuation">.</span>cno<span class="token punctuation">,</span> cname<span class="token punctuation">,</span> sno<span class="token punctuation">,</span> degree
<span class="token keyword">FROM</span> scores <span class="token keyword">AS</span> s <span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> courses <span class="token keyword">AS</span> c
<span class="token keyword">ON</span> s<span class="token punctuation">.</span>cno <span class="token operator">=</span> c<span class="token punctuation">.</span>cno
<span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> teachers <span class="token keyword">AS</span> t
<span class="token keyword">ON</span> t<span class="token punctuation">.</span>tno <span class="token operator">=</span> c<span class="token punctuation">.</span>tno
<span class="token keyword">WHERE</span> t<span class="token punctuation">.</span>depart <span class="token operator">=</span> <span class="token string">'计算机系'</span>
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> t<span class="token punctuation">.</span>tname<span class="token punctuation">,</span> cname<span class="token punctuation">,</span> degree <span class="token keyword">DESC</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>查询“计算机系”中与“电子工程系“的教师<strong>不同职称</strong>教师的tname和prof。</p>
<p>解答：</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SELECT</span> tname<span class="token punctuation">,</span> prof
<span class="token keyword">FROM</span> teachers
<span class="token keyword">WHERE</span> depart <span class="token operator">=</span> <span class="token string">'计算机系'</span> <span class="token operator">AND</span> prof <span class="token operator">NOT</span> <span class="token operator">IN</span> 
								<span class="token punctuation">(</span><span class="token keyword">SELECT</span> prof
                                <span class="token keyword">FROM</span> teachers
                                <span class="token keyword">WHERE</span> depart <span class="token operator">=</span> <span class="token string">'电子工程系'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>查询选修编号为“3-105”课程且成绩至少<strong>高于任意</strong>选修编号为“3-245”的同学的成绩的cno、sno和degree。</p>
<p>解答：</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SELECT</span> cno<span class="token punctuation">,</span> sno<span class="token punctuation">,</span> degree
<span class="token keyword">FROM</span> scores
<span class="token keyword">WHERE</span> cno <span class="token operator">=</span> <span class="token string">'3-105'</span> <span class="token operator">AND</span> degree <span class="token operator">></span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> <span class="token function">MIN</span><span class="token punctuation">(</span>degree<span class="token punctuation">)</span>
    							<span class="token keyword">FROM</span> scores
    							<span class="token keyword">WHERE</span> cno <span class="token operator">=</span> <span class="token string">'3-245'</span><span class="token punctuation">)</span>
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> degree <span class="token keyword">DESC</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>查询选修编号为”3-105“且成绩<strong>高于所有</strong>选修编号为”3-245“课程的同学的cno、sno和degree。</p>
<p>解答：</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SELECT</span> cno<span class="token punctuation">,</span> sno<span class="token punctuation">,</span> degree
<span class="token keyword">FROM</span> scores
<span class="token keyword">WHERE</span> cno <span class="token operator">=</span> <span class="token string">'3-105'</span> <span class="token operator">AND</span> degree <span class="token operator">></span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> <span class="token function">MAX</span><span class="token punctuation">(</span>degree<span class="token punctuation">)</span>
    							<span class="token keyword">FROM</span> scores
    							<span class="token keyword">WHERE</span> cno <span class="token operator">=</span> <span class="token string">'3-245'</span><span class="token punctuation">)</span>
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> degree <span class="token keyword">DESC</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>查询<strong>所有教师和同学</strong>的name、sex和birthday。</p>
<p>解答：<strong>组合查询UNION</strong></p>
<ul>
<li>UNION中<strong>每个查询必须包含相同的列、表达式或聚集函数</strong>（不过各个列<strong>不需要以相同的次序列出</strong>）。</li>
<li>列数据类型必须<strong>兼容</strong>。类型不必完全相同，但必须是DBMS可以隐含地转换的类型(如<strong>不同的数值类型</strong>或<strong>不同的日期类型</strong>)。</li>
</ul>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SELECT</span> tname <span class="token keyword">AS</span> name<span class="token punctuation">,</span> tsex <span class="token keyword">AS</span> sex<span class="token punctuation">,</span> tbirthday <span class="token keyword">AS</span> birthday
<span class="token keyword">FROM</span> teachers
<span class="token keyword">UNION</span> 
<span class="token keyword">SELECT</span> sname <span class="token keyword">AS</span> name<span class="token punctuation">,</span> ssex <span class="token keyword">AS</span> sex<span class="token punctuation">,</span> sbirthday <span class="token keyword">AS</span> birthday
<span class="token keyword">FROM</span> students
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> birthday<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>查询所有“女”教师和“女”同学的name、sex和birthday。</p>
<p>解答：</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SELECT</span> tname <span class="token keyword">AS</span> name<span class="token punctuation">,</span> tsex <span class="token keyword">AS</span> sex<span class="token punctuation">,</span> tbirthday <span class="token keyword">AS</span> birthday
<span class="token keyword">FROM</span> teachers <span class="token keyword">AS</span> t
<span class="token keyword">WHERE</span> t<span class="token punctuation">.</span>tsex <span class="token operator">=</span> <span class="token string">'女'</span>
<span class="token keyword">UNION</span> 
<span class="token keyword">SELECT</span> sname <span class="token keyword">AS</span> name<span class="token punctuation">,</span> ssex <span class="token keyword">AS</span> sex<span class="token punctuation">,</span> sbirthday <span class="token keyword">AS</span> birthday
<span class="token keyword">FROM</span> students <span class="token keyword">AS</span> s
<span class="token keyword">WHERE</span> s<span class="token punctuation">.</span>ssex <span class="token operator">=</span> <span class="token string">'女'</span>
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> birthday<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>★★★查询成绩<strong>比该课程平均成绩低</strong>的同学的成绩表。</p>
<p>解答：</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SELECT</span> s1<span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">,</span> avg_degree
<span class="token keyword">FROM</span> scores <span class="token keyword">AS</span> s1 <span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> <span class="token punctuation">(</span>
	<span class="token keyword">SELECT</span> cno<span class="token punctuation">,</span> <span class="token function">AVG</span><span class="token punctuation">(</span>degree<span class="token punctuation">)</span> <span class="token keyword">AS</span> avg_degree
	<span class="token keyword">FROM</span> scores
	<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> cno<span class="token punctuation">)</span> <span class="token keyword">AS</span> s2
<span class="token keyword">ON</span> s1<span class="token punctuation">.</span>cno <span class="token operator">=</span> s2<span class="token punctuation">.</span>cno <span class="token operator">AND</span> s1<span class="token punctuation">.</span>degree <span class="token operator">&lt;</span> s2<span class="token punctuation">.</span>avg_degree<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>查询所有<strong>任课教师</strong>的tname和depart。</p>
<p>解答：</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SELECT</span> <span class="token keyword">DISTINCT</span> tname<span class="token punctuation">,</span> depart
<span class="token keyword">FROM</span> courses <span class="token keyword">AS</span> c <span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> teachers <span class="token keyword">AS</span> t
<span class="token keyword">ON</span> c<span class="token punctuation">.</span>tno <span class="token operator">=</span> t<span class="token punctuation">.</span>tno
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> tname<span class="token punctuation">;</span>

<span class="token keyword">SELECT</span> tname<span class="token punctuation">,</span> depart
<span class="token keyword">FROM</span> teachers
<span class="token keyword">WHERE</span> tno <span class="token operator">IN</span><span class="token punctuation">(</span>
	<span class="token keyword">SELECT</span> tno
	<span class="token keyword">FROM</span> courses<span class="token punctuation">)</span>
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> tname<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>★查询所有<strong>未讲课</strong>的教师的Tname和Depart。</p>
<p>解答：</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SELECT</span> tname<span class="token punctuation">,</span> depart
<span class="token keyword">FROM</span> teachers
<span class="token keyword">WHERE</span> tno <span class="token operator">NOT</span> <span class="token operator">IN</span><span class="token punctuation">(</span>
	<span class="token keyword">SELECT</span> tno
	<span class="token keyword">FROM</span> courses<span class="token punctuation">)</span>
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> tname<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>★★查询<strong>至少有2名</strong>男生的班号。</p>
<p>解答：</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SELECT</span> class
<span class="token keyword">FROM</span> students
<span class="token keyword">WHERE</span> ssex <span class="token operator">=</span> <span class="token string">'男'</span>
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> class
<span class="token keyword">HAVING</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token operator">>=</span> <span class="token number">2</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>★查询students表中**不姓“王”**的同学记录。</p>
<p>解答：</p>
<ul>
<li>LIKE操作符</li>
<li>通配符%</li>
</ul>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SELECT</span> <span class="token operator">*</span>
<span class="token keyword">FROM</span> students
<span class="token keyword">WHERE</span> sname <span class="token operator">NOT</span> <span class="token operator">LIKE</span> <span class="token string">'王%'</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>★★查询students表中每个学生的姓名和<strong>年龄</strong>。</p>
<p>解答：</p>
<ul>
<li>当前<strong>日期</strong>函数CURDATE()</li>
<li>当前<strong>日期和时间</strong>函数NOW()</li>
</ul>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SELECT</span> sname<span class="token punctuation">,</span> TIMESTAMPDIFF<span class="token punctuation">(</span><span class="token keyword">YEAR</span><span class="token punctuation">,</span> sbirthday<span class="token punctuation">,</span> CURDATE<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> age
<span class="token keyword">FROM</span> students<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
</li>
<li><p>★★查询students表中<strong>最大</strong>和<strong>最小</strong>的sbirthday<strong>日期</strong>值。</p>
<p>解答：</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SELECT</span> <span class="token keyword">DATE</span><span class="token punctuation">(</span><span class="token function">MAX</span><span class="token punctuation">(</span>Sbirthday<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> max_birthday<span class="token punctuation">,</span> <span class="token keyword">DATE</span><span class="token punctuation">(</span><span class="token function">MIN</span><span class="token punctuation">(</span>Sbirthday<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> min_birthday<span class="token punctuation">,</span>
<span class="token keyword">FROM</span> Students<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
</li>
<li><p>以<strong>班号</strong>和<strong>年龄</strong>从大到小的顺序查询students表中的全部记录。</p>
<p>解答：</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SELECT</span> <span class="token operator">*</span>
<span class="token keyword">FROM</span> students
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> class <span class="token keyword">DESC</span><span class="token punctuation">,</span> TIMESTAMPDIFF<span class="token punctuation">(</span><span class="token keyword">YEAR</span><span class="token punctuation">,</span> sbirthday<span class="token punctuation">,</span> CURDATE<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">DESC</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>查询“男”教师及其<strong>所上的课程</strong>。</p>
<p>解答：</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SELECT</span> tname<span class="token punctuation">,</span> cname
<span class="token keyword">FROM</span> teachers <span class="token keyword">AS</span> t <span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> courses <span class="token keyword">AS</span> c
<span class="token keyword">ON</span> t<span class="token punctuation">.</span>tno <span class="token operator">=</span> c<span class="token punctuation">.</span>tno
<span class="token keyword">WHERE</span> tsex<span class="token operator">=</span><span class="token string">'男'</span>
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> tname<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>★查询<strong>最高分</strong>同学的sno、cno和degree列。</p>
<p>解答：</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SELECT</span> sno<span class="token punctuation">,</span> cno<span class="token punctuation">,</span> degree
<span class="token keyword">FROM</span> scores
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> cno
<span class="token keyword">HAVING</span> degree<span class="token operator">=</span><span class="token function">MAX</span><span class="token punctuation">(</span>degree<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>查询和“李军”<strong>同性别</strong>的所有同学的sname。</p>
<p>解答：</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment"># 方法一 子查询</span>
<span class="token keyword">SELECT</span> sname
<span class="token keyword">FROM</span> students
<span class="token keyword">WHERE</span> ssex <span class="token operator">=</span> <span class="token punctuation">(</span>
			<span class="token keyword">SELECT</span> ssex
			<span class="token keyword">FROM</span> students
			<span class="token keyword">WHERE</span> sname <span class="token operator">=</span> <span class="token string">'李军'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			
<span class="token comment"># 方法二 联结表</span>
<span class="token keyword">SELECT</span> s1<span class="token punctuation">.</span>Sname
<span class="token keyword">FROM</span> students <span class="token keyword">AS</span> s1 <span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> students <span class="token keyword">AS</span> s2
<span class="token keyword">ON</span> s1<span class="token punctuation">.</span>ssex<span class="token operator">=</span>s2<span class="token punctuation">.</span>ssex
<span class="token keyword">WHERE</span> s2<span class="token punctuation">.</span>sname <span class="token operator">=</span> <span class="token string">'李军'</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>★★查询和“李军”<strong>同性别</strong>并<strong>同班</strong>的同学sname。</p>
<p>解答：</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SELECT</span> sname
<span class="token keyword">FROM</span> students <span class="token keyword">AS</span> s1 <span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> students <span class="token keyword">AS</span> s2
<span class="token keyword">ON</span> s1<span class="token punctuation">.</span>ssex <span class="token operator">=</span> s2<span class="token punctuation">.</span>ssex <span class="token operator">AND</span> s1<span class="token punctuation">.</span>class <span class="token operator">=</span> s2<span class="token punctuation">.</span>class
<span class="token keyword">WHERE</span> s2<span class="token punctuation">.</span>sname <span class="token operator">=</span> <span class="token string">'李军'</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>查询所有<strong>选修“计算机导论”课程</strong>的**“男”**同学的成绩表。</p>
<p>解答：</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SELECT</span> sname<span class="token punctuation">,</span> degree
<span class="token keyword">FROM</span> scores <span class="token keyword">AS</span> s1 <span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> courses <span class="token keyword">AS</span> c
<span class="token keyword">ON</span> s1<span class="token punctuation">.</span>cno <span class="token operator">=</span> c<span class="token punctuation">.</span>cno
<span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> students <span class="token keyword">AS</span> s2
<span class="token keyword">ON</span> s1<span class="token punctuation">.</span>sno <span class="token operator">=</span> s2<span class="token punctuation">.</span>sno
<span class="token keyword">WHERE</span> c<span class="token punctuation">.</span>cname <span class="token operator">=</span> <span class="token string">'计算机导论'</span> <span class="token operator">AND</span> s2<span class="token punctuation">.</span>ssex <span class="token operator">=</span> <span class="token string">'男'</span>
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> degree <span class="token keyword">DESC</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ol>
<hr>
<h2 id="练习二"><a href="#练习二" class="headerlink" title="练习二"></a>练习二</h2><h3 id="准备数据-1"><a href="#准备数据-1" class="headerlink" title="准备数据"></a>准备数据</h3><h4 id="建表语句-1"><a href="#建表语句-1" class="headerlink" title="建表语句"></a>建表语句</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> userinfo <span class="token punctuation">(</span>
  userId <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  sex <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  birth <span class="token keyword">date</span><span class="token punctuation">,</span>
  <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span>userId<span class="token punctuation">)</span>
<span class="token punctuation">)</span> <span class="token keyword">ENGINE</span> <span class="token operator">=</span> <span class="token keyword">InnoDB</span><span class="token punctuation">;</span>

<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> orderinfo <span class="token punctuation">(</span>
  orderId <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  userId <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  isPaid <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  price <span class="token keyword">float</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  paidTime <span class="token keyword">timestamp</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CURRENT_TIMESTAMP</span> <span class="token keyword">ON</span> <span class="token keyword">UPDATE</span> <span class="token keyword">CURRENT_TIMESTAMP</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span>orderId<span class="token punctuation">)</span>
<span class="token punctuation">)</span> <span class="token keyword">ENGINE</span> <span class="token operator">=</span> <span class="token keyword">InnoDB</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h4 id="导入数据"><a href="#导入数据" class="headerlink" title="导入数据"></a>导入数据</h4><ul>
<li><p>获取链接：<a target="_blank" rel="noopener" href="https://pan.baidu.com/s/11ZtjKnv5-nwyf6cMyk_3JQ#list/path=%2F">用户消费行为分析数据</a>；提取码：yu63</p>
</li>
<li><p>数据文件</p>
<ul>
<li><code>user_info_utf.csv</code></li>
<li><code>order_info_utf.csv</code></li>
</ul>
</li>
<li><p>通过navicat，选择对应的数据库表，选择<strong>导入</strong>：</p>
<ol>
<li><p>导入类型：CSV File</p>
</li>
<li><ul>
<li>导入从：选择需要导入的数据文件</li>
<li>编码：UTF-8(<strong>默认</strong>)</li>
</ul>
</li>
<li><p>记录分隔符：CRLF(<strong>默认</strong>)</p>
</li>
<li><ul>
<li>字段名行：若数据文件<strong>不包含数据表的列名</strong>，则输入<strong>0</strong>(<strong>默认</strong>为第<strong>1</strong>行)；</li>
<li>第一个数据行：若文件<strong>不包含数据表的列名</strong>，则输入<strong>1</strong>(<strong>默认</strong>为第<strong>2</strong>行)；</li>
<li><strong>日期排序</strong>：注意<strong>年月日的顺序</strong></li>
</ul>
</li>
<li><p>确认目标表</p>
</li>
<li><p>确认对应的<strong>目标字段</strong></p>
</li>
<li><p>将记录<strong>添加</strong>到目标表&#x2F;<strong>删除目标表中原数据</strong>，用导入的记录代替</p>
</li>
<li><p>开始执行</p>
</li>
</ol>
</li>
</ul>
<hr>
<h3 id="练习题-1"><a href="#练习题-1" class="headerlink" title="练习题"></a>练习题</h3><ol>
<li><p>统计不同月份的下单人数</p>
 <pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SELECT</span> <span class="token keyword">MONTH</span><span class="token punctuation">(</span>paidTime<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token keyword">DISTINCT</span> userId<span class="token punctuation">)</span>
<span class="token keyword">FROM</span> orderinfo
<span class="token keyword">WHERE</span> isPaid <span class="token operator">=</span> <span class="token string">'已支付'</span>
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> <span class="token keyword">MONTH</span><span class="token punctuation">(</span>paidTime<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>统计用户<strong>三月份</strong>的<strong>复购</strong>率和<strong>回购</strong>率(三月份购买的用户，<strong>四月份也购买</strong>)</p>
 <pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment"># 复购率</span>
<span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span>cnt<span class="token punctuation">)</span> <span class="token keyword">AS</span> 下单用户数<span class="token punctuation">,</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token keyword">IF</span><span class="token punctuation">(</span>cnt <span class="token operator">></span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> 复购用户数
<span class="token keyword">FROM</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> userId<span class="token punctuation">,</span> <span class="token function">COUNT</span><span class="token punctuation">(</span>userId<span class="token punctuation">)</span> <span class="token keyword">as</span> cnt
      <span class="token keyword">FROM</span> orderinfo
      <span class="token keyword">WHERE</span> isPaid <span class="token operator">=</span> <span class="token string">'已支付'</span> <span class="token operator">AND</span> <span class="token keyword">MONTH</span><span class="token punctuation">(</span>paidTime<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">3</span>
      <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> userId<span class="token punctuation">)</span> <span class="token keyword">AS</span> t<span class="token punctuation">;</span>
      
<span class="token comment"># 3月份的回购率</span>
<span class="token keyword">SELECT</span> t1<span class="token punctuation">.</span>m<span class="token punctuation">,</span> <span class="token function">COUNT</span><span class="token punctuation">(</span>t1<span class="token punctuation">.</span>m<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">COUNT</span><span class="token punctuation">(</span>t2<span class="token punctuation">.</span>m<span class="token punctuation">)</span> 
<span class="token keyword">FROM</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> userId<span class="token punctuation">,</span> DATE_FORMAT<span class="token punctuation">(</span>paidTime<span class="token punctuation">,</span> <span class="token string">'%Y-%m-01'</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> m
			<span class="token keyword">FROM</span> orderinfo
			<span class="token keyword">WHERE</span> isPaid <span class="token operator">=</span> <span class="token string">'已支付'</span>
			<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> userId<span class="token punctuation">,</span> DATE_FORMAT<span class="token punctuation">(</span>paidTime<span class="token punctuation">,</span> <span class="token string">'%Y-%m-01'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> t1
<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> userId<span class="token punctuation">,</span> DATE_FORMAT<span class="token punctuation">(</span>paidTime<span class="token punctuation">,</span> <span class="token string">'%Y-%m-01'</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> m
			<span class="token keyword">FROM</span> orderinfo
			<span class="token keyword">WHERE</span> isPaid <span class="token operator">=</span> <span class="token string">'已支付'</span>
			<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> userId<span class="token punctuation">,</span> DATE_FORMAT<span class="token punctuation">(</span>paidTime<span class="token punctuation">,</span> <span class="token string">'%Y-%m-01'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> t2
<span class="token keyword">ON</span> t1<span class="token punctuation">.</span>userId <span class="token operator">=</span> t2<span class="token punctuation">.</span>userId <span class="token operator">AND</span> t1<span class="token punctuation">.</span>m <span class="token operator">=</span> DATE_ADD<span class="token punctuation">(</span>t2<span class="token punctuation">.</span>m<span class="token punctuation">,</span> <span class="token keyword">INTERVAL</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token keyword">MONTH</span><span class="token punctuation">)</span>
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> t1<span class="token punctuation">.</span>m<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>统计男女用户的<strong>消费频次</strong>(<strong>平均数</strong>)是否有差异</p>
</li>
</ol>
  <pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SELECT</span> sex<span class="token punctuation">,</span> <span class="token function">AVG</span><span class="token punctuation">(</span>cnt<span class="token punctuation">)</span>
<span class="token keyword">FROM</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> o<span class="token punctuation">.</span>userId<span class="token punctuation">,</span> sex<span class="token punctuation">,</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> cnt  <span class="token comment"># count(*)的作用为 统计消费次数</span>
      <span class="token keyword">FROM</span> orderinfo <span class="token keyword">AS</span> o
      <span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> <span class="token operator">*</span>
                  <span class="token keyword">FROM</span> userinfo
                  <span class="token keyword">WHERE</span> sex <span class="token operator">!=</span> <span class="token string">''</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> t
      <span class="token keyword">ON</span> o<span class="token punctuation">.</span>userId <span class="token operator">=</span> t<span class="token punctuation">.</span>userId
      <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> o<span class="token punctuation">.</span>userId<span class="token punctuation">,</span> sex<span class="token punctuation">)</span> <span class="token keyword">AS</span> t2
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> sex<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="4">
<li><p>统计<strong>多次消费</strong>的用户，第一次和最后一次消费间隔是多少</p>
 <pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SELECT</span> userId<span class="token punctuation">,</span> DATEDIFF<span class="token punctuation">(</span><span class="token function">MAX</span><span class="token punctuation">(</span>paidTime<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">MIN</span><span class="token punctuation">(</span>paidTime<span class="token punctuation">)</span><span class="token punctuation">)</span> 
<span class="token keyword">FROM</span> orderinfo
<span class="token keyword">WHERE</span> isPaid <span class="token operator">=</span> <span class="token string">'已支付'</span>
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> userId
<span class="token keyword">HAVING</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">1</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>统计不同<strong>年龄段</strong>，用户的消费金额是否有差异？</p>
 <pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SELECT</span> ageGroup<span class="token punctuation">,</span> <span class="token function">AVG</span><span class="token punctuation">(</span>cnt<span class="token punctuation">)</span>
<span class="token keyword">FROM</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> o<span class="token punctuation">.</span>userId<span class="token punctuation">,</span> ageGroup<span class="token punctuation">,</span> <span class="token function">count</span><span class="token punctuation">(</span>o<span class="token punctuation">.</span>userId<span class="token punctuation">)</span> <span class="token keyword">AS</span> cnt
<span class="token keyword">FROM</span> orderinfo <span class="token keyword">AS</span> o
<span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> userId<span class="token punctuation">,</span> CEIL<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">YEAR</span><span class="token punctuation">(</span><span class="token function">NOW</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token keyword">YEAR</span><span class="token punctuation">(</span>birth<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> ageGroup
					<span class="token keyword">FROM</span> userinfo
					<span class="token keyword">WHERE</span> birth <span class="token operator">></span> <span class="token string">'1901-00-00'</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> t
<span class="token keyword">ON</span> o<span class="token punctuation">.</span>userId <span class="token operator">=</span> t<span class="token punctuation">.</span>userId
<span class="token keyword">WHERE</span> isPaid <span class="token operator">=</span> <span class="token string">'已支付'</span>
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> o<span class="token punctuation">.</span>userId<span class="token punctuation">,</span> ageGroup<span class="token punctuation">)</span> <span class="token keyword">AS</span> t2
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> ageGroup<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>统计消费的<strong>二八法则</strong>，消费的top20%用户，贡献了多少额度</p>
 <pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span>userId<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">SUM</span><span class="token punctuation">(</span>total<span class="token punctuation">)</span>
<span class="token keyword">FROM</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> userId<span class="token punctuation">,</span> <span class="token function">SUM</span><span class="token punctuation">(</span>price<span class="token punctuation">)</span> <span class="token keyword">AS</span> total
	<span class="token keyword">FROM</span> orderinfo <span class="token keyword">AS</span> o
	<span class="token keyword">WHERE</span> isPaid <span class="token operator">=</span> <span class="token string">'已支付'</span>
	<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> userId
	<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> total <span class="token keyword">DESC</span>
	<span class="token keyword">LIMIT</span> <span class="token number">17000</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> t<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ol>
<hr>
<h2 id="练习三"><a href="#练习三" class="headerlink" title="练习三"></a>练习三</h2><h3 id="准备数据-2"><a href="#准备数据-2" class="headerlink" title="准备数据"></a>准备数据</h3><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> datafrog_test1
<span class="token punctuation">(</span>userid <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
changjing <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
int_time <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> datafrog_test1 
<span class="token keyword">VALUES</span> 	<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1001</span><span class="token punctuation">,</span><span class="token number">1400</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
		<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1002</span><span class="token punctuation">,</span><span class="token number">1401</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1002</span><span class="token punctuation">,</span><span class="token number">1402</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1001</span><span class="token punctuation">,</span><span class="token number">1402</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1003</span><span class="token punctuation">,</span><span class="token number">1403</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1004</span><span class="token punctuation">,</span><span class="token number">1404</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">1003</span><span class="token punctuation">,</span><span class="token number">1400</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">1004</span><span class="token punctuation">,</span><span class="token number">1402</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">1003</span><span class="token punctuation">,</span><span class="token number">1403</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">1001</span><span class="token punctuation">,</span><span class="token number">1403</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">1002</span><span class="token punctuation">,</span><span class="token number">1404</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">1002</span><span class="token punctuation">,</span><span class="token number">1402</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">1002</span><span class="token punctuation">,</span><span class="token number">1403</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">1001</span><span class="token punctuation">,</span><span class="token number">1404</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">1003</span><span class="token punctuation">,</span><span class="token number">1405</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h3 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h3><p>求用户id对应的<strong>前两个不同场景</strong>。(场景重复的话，选场景的第一个访问时间，场景不足两个也输出其场景)</p>
<hr>
<h3 id="解答"><a href="#解答" class="headerlink" title="解答"></a>解答</h3><hr>
<h2 id="Leetcode-上的SQL题"><a href="#Leetcode-上的SQL题" class="headerlink" title="Leetcode 上的SQL题"></a>Leetcode 上的SQL题</h2><ul>
<li><p><a target="_blank" rel="noopener" href="https://leetcode-cn.com/problems/second-highest-salary/">176. 第二高的薪水</a></p>
</li>
<li><p><code>LIMIT/OFFSET</code></p>
</li>
<li><p><code>IFNULL()/ISNULL()</code>函数</p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://leetcode-cn.com/problems/nth-highest-salary/submissions/">177. 第N高的薪水</a></p>
</li>
<li><p><code>CREATE FUNCTION</code></p>
<ul>
<li><code>LIMIT/OFFSET</code>之后<strong>不能包含运算表达式</strong></li>
</ul>
</li>
<li><p><a target="_blank" rel="noopener" href="https://leetcode-cn.com/problems/department-top-three-salaries/submissions/">185. 部门工资前三高的所有员工 </a></p>
<ul>
<li><strong>窗口函数</strong>——<code>DENSE_RANK()</code>：<strong>有并列名次的行，不占用下一名次的位置</strong></li>
</ul>
</li>
</ul>
<hr>
<ul>
<li><p><a target="_blank" rel="noopener" href="https://leetcode-cn.com/problems/rank-scores/submissions/">178. 分数排名</a></p>
<ul>
<li><strong>窗口函数</strong>——<code>DENSE_RANK()</code></li>
<li>MySQL如果<strong>要 将保留字转义 用作列名</strong>，可以<strong>在关键字之前和之后使用撇号</strong>。例如**`Rank`**</li>
</ul>
</li>
<li><p><a target="_blank" rel="noopener" href="https://leetcode-cn.com/problems/consecutive-numbers/solution/sql-server-jie-fa-by-neilsons/">SQL SERVER 解法 - 连续出现的数字 - 力扣（LeetCode）</a></p>
</li>
<li><p>※<a target="_blank" rel="noopener" href="https://leetcode-cn.com/problems/consecutive-numbers/">180. 连续出现的数字</a></p>
  <pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SELECT</span> <span class="token keyword">DISTINCT</span> Num <span class="token keyword">AS</span> ConsecutiveNums
<span class="token keyword">FROM</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> Num<span class="token punctuation">,</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> num_cnt 
      <span class="token keyword">FROM</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> id<span class="token punctuation">,</span> num<span class="token punctuation">,</span> 
            <span class="token punctuation">(</span>ROW_NUMBER<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">OVER</span> <span class="token punctuation">(</span><span class="token keyword">ORDER</span> <span class="token keyword">BY</span> id<span class="token punctuation">)</span> <span class="token operator">-</span> ROW_NUMBER<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">OVER</span> <span class="token punctuation">(</span><span class="token keyword">PARTITION</span> <span class="token keyword">BY</span> num 
                                                               <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> id<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> orde
           <span class="token keyword">FROM</span> logs<span class="token punctuation">)</span> <span class="token keyword">AS</span> W
     <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> num<span class="token punctuation">,</span> orde<span class="token punctuation">)</span> <span class="token keyword">AS</span> S
<span class="token keyword">WHERE</span> num_cnt <span class="token operator">>=</span> <span class="token number">3</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li><p><a target="_blank" rel="noopener" href="https://leetcode-cn.com/problems/employees-earning-more-than-their-managers/">181. 超过经理收入的员工</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://leetcode-cn.com/problems/customers-who-never-order/submissions/">183. 从不订购的客户</a></p>
<ul>
<li><strong>空值的筛选</strong>为<code>IS NULL</code>&#x2F;<code>IS NOT NULL</code>，不是<code>= NULL</code></li>
</ul>
</li>
<li><p><a target="_blank" rel="noopener" href="https://leetcode-cn.com/problems/department-highest-salary/submissions/">184. 部门工资最高的员工</a></p>
<ul>
<li><strong>每个组内比较</strong>，使用<strong>子查询</strong></li>
</ul>
</li>
<li><p><a target="_blank" rel="noopener" href="https://leetcode-cn.com/problems/delete-duplicate-emails/">196. 删除重复的电子邮箱 </a></p>
<ul>
<li>子查询</li>
<li>EXISTS 和 IN的运用(<strong>EXISTS 更高效</strong>)</li>
</ul>
</li>
<li><p><a target="_blank" rel="noopener" href="https://leetcode-cn.com/problems/rising-temperature/">197. 上升的温度</a></p>
<ul>
<li>时间处理函数<code>DATE_ADD()</code></li>
</ul>
</li>
<li><p><a target="_blank" rel="noopener" href="https://leetcode-cn.com/problems/trips-and-users/submissions/">262. 行程和用户</a></p>
<ul>
<li><code>BETWEEN ... AND ...</code></li>
<li>IF表达式</li>
<li>ROUND函数<strong>舍入小数</strong></li>
<li><code>COUNT</code>函数&#x2F;<code>AVG</code>函数</li>
</ul>
</li>
<li><p><a target="_blank" rel="noopener" href="https://leetcode-cn.com/problems/big-countries/">595. 大的国家</a></p>
<ul>
<li>UNION和OR的选择</li>
</ul>
</li>
<li><p><a target="_blank" rel="noopener" href="https://leetcode-cn.com/problems/swap-salary/">627. 交换工资</a></p>
<ul>
<li><code>CASE... WHEN</code></li>
</ul>
</li>
</ul>
<hr>
<h2 id="牛客网上的SQL题"><a href="#牛客网上的SQL题" class="headerlink" title="牛客网上的SQL题"></a>牛客网上的SQL题</h2><ul>
<li><p><a target="_blank" rel="noopener" href="https://www.nowcoder.com/practice/c1472daba75d4635b7f8540b837cc719?tpId=82&tags=&title=&diffculty=0&judgeStatus=0&rp=1">获取当前薪水第二多的员工的emp_no以及其对应的薪水salary</a></p>
</li>
<li><p>不让使用ORDER BY排序时，<strong>利用子查询</strong>和<code>MAX()</code></p>
</li>
<li><p>⭐<a target="_blank" rel="noopener" href="https://www.nowcoder.com/practice/fc7344ece7294b9e98401826b94c6ea5?tpId=82&tags=&title=&diffculty=0&judgeStatus=0&rp=1">查找所有员工自入职以来的薪水涨幅情况</a></p>
<ul>
<li>嵌套查询</li>
</ul>
</li>
<li><p><a target="_blank" rel="noopener" href="https://www.nowcoder.com/practice/b9068bfe5df74276bd015b9729eec4bf?tpId=82&tags=&title=&diffculty=0&judgeStatus=0&rp=1">对所有员工的薪水按照salary进行按照1-N的排名</a></p>
<ul>
<li>窗口函数</li>
<li><strong>排序细节</strong></li>
</ul>
</li>
<li><p><a target="_blank" rel="noopener" href="https://www.nowcoder.com/practice/8fe212a6c71b42de9c15c56ce354bebe?tpId=82&tags=&title=&diffculty=0&judgeStatus=0&rp=1">获取所有非manager员工当前的薪水情况</a></p>
<ul>
<li>使用INNER JOIN而不是LEFT JOIN</li>
<li>一个部门里可能有多个manager，所以用<code>NOT IN</code>比用<code>!=</code>更合理</li>
</ul>
</li>
<li><p>⭐<a target="_blank" rel="noopener" href="https://www.nowcoder.com/practice/f858d74a030e48da8e0f69e21be63bef?tpId=82&tags=&title=&diffculty=0&judgeStatus=0&rp=1">获取员工其当前的薪水比其manager当前薪水还高的相关信息</a></p>
<ul>
<li><strong>创建两张表（一张记录当前所有员工的工资，另一张只记录部门经理的工资）进行比较</strong></li>
</ul>
</li>
<li><p><a target="_blank" rel="noopener" href="https://www.nowcoder.com/practice/eb9b13e5257744db8265aa73de04fd44?tpId=82&tags=&title=&diffculty=0&judgeStatus=0&rp=1">给出每个员工每年薪水涨幅超过5000的员工编号emp_no</a></p>
<ul>
<li>题意模糊：应该为<strong>给出薪水与去年相比丈夫超过5000的员工编号</strong></li>
<li>使用INNER JOIN而不是LEFT JOIN</li>
<li><strong>时间线的判断方法很有参考价值</strong></li>
</ul>
</li>
<li><p><a target="_blank" rel="noopener" href="https://www.nowcoder.com/practice/3a303a39cc40489b99a7e1867e6507c5?tpId=82&tags=&title=&diffculty=0&judgeStatus=0&rp=1">查找描述信息中包含robot的电影对应的分类名称以及电影数目，而且还需要该分类对应电影数量&gt;&#x3D;5部</a></p>
<ul>
<li><strong>筛选方法</strong></li>
</ul>
</li>
<li><p><a target="_blank" rel="noopener" href="https://www.nowcoder.com/practice/ac233de508ef4849b0eeb4f38dcf09cf?tpId=82&tags=&title=&diffculty=0&judgeStatus=0&rp=1">创建一个actor表，包含如下列信息</a></p>
<ul>
<li>创建表的时候，有些地方必须<strong>加括号</strong></li>
</ul>
</li>
<li><p><a target="_blank" rel="noopener" href="https://www.nowcoder.com/practice/153c8a8e7805400ba8e384e03acc6b3e?tpId=82&tags=&title=&diffculty=0&judgeStatus=0&rp=1">批量插入数据，不使用replace操作</a></p>
<ul>
<li>MySQL插入数据，如果数据已存在则忽略的语句是<code>INSERT IGNORE table_name VALUES(...);</code></li>
</ul>
</li>
<li><p><a target="_blank" rel="noopener" href="https://www.nowcoder.com/practice/e1824daa0c49404aa602cf0cb34bdd75?tpId=82&tags=&title=&diffculty=0&judgeStatus=0&rp=1">对first_name创建唯一索引uniq_idx_firstname</a></p>
<ul>
<li><strong>创建索引</strong></li>
</ul>
</li>
<li><p><a target="_blank" rel="noopener" href="https://www.nowcoder.com/practice/b9db784b5e3d488cbd30bd78fdb2a862?tpId=82&tags=&title=&diffculty=0&judgeStatus=0&rp=1">针对actor表创建视图actor_name_view</a></p>
<ul>
<li>创建视图</li>
</ul>
</li>
<li><p><a target="_blank" rel="noopener" href="https://www.nowcoder.com/practice/f9fa9dc1a1fc4130b08e26c22c7a1e5f?tpId=82&tags=&title=&diffculty=0&judgeStatus=0&rp=1">针对上面的salaries表emp_no字段创建索引idx_emp_no</a></p>
<ul>
<li>强制索引(MySQL 为 <strong>FORCE INDEX</strong>)</li>
</ul>
</li>
<li><p><a target="_blank" rel="noopener" href="https://www.nowcoder.com/practice/7e920bb2e1e74c4e83750f5c16033e2e?tpId=82&tags=&title=&diffculty=0&judgeStatu=0&rp=1">构造一个触发器audit_log</a></p>
<ul>
<li><strong>此触发器必须按照AFTER INSERT执行，因为在BEFORE INSERT语句执行之前，新的行数据还没有生成</strong>。<ul>
<li>通常，<strong>将BEFORE用于数据验证和净化</strong></li>
</ul>
</li>
</ul>
</li>
<li><p><a target="_blank" rel="noopener" href="https://www.nowcoder.com/practice/3d92551a6f6d4f1ebde272d20872cf05?tpId=82&tags=&title=&diffculty=0&judgeStatus=0&rp=1">删除emp_no重复的记录，只保留最小的id对应的记录</a></p>
<ul>
<li><pre><code class="language-SQL">  DELETE FROM table_name 
  WHERE xxx
  <pre class="line-numbers language-none"><code class="language-none">
- [将所有to_date为9999-01-01的全部更新为NULL](https:&#x2F;&#x2F;www.nowcoder.com&#x2F;practice&#x2F;859f28f43496404886a77600ea68ef59?tpId&#x3D;82&amp;tags&#x3D;&amp;title&#x3D;&amp;diffculty&#x3D;0&amp;judgeStatus&#x3D;0&amp;rp&#x3D;1)

	- &#96;&#96;&#96;sql
		UPDATE table_name
		SET xxx
		WHERE xxx;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</code></pre>
</li>
</ul>
</li>
<li><p><a target="_blank" rel="noopener" href="https://www.nowcoder.com/practice/2bec4d94f525458ca3d0ebf3bc8cd240?tpId=82&tags=&title=&diffculty=0&judgeStatus=0&rp=1">将id&#x3D;5以及emp_no&#x3D;10001的行数据替换成id&#x3D;5以及emp_no&#x3D;10005</a></p>
<ul>
<li><code>REPLACE(s, s1, s2)</code>函数</li>
</ul>
</li>
<li><p><a target="_blank" rel="noopener" href="https://www.nowcoder.com/practice/5277d7f92aa746ab8aa42886e5d570d4?tpId=82&tags=&title=&diffculty=0&judgeStatus=0&rp=1">将titles_test表名修改为titles_2017</a></p>
<ul>
<li>修改表名的两种方式<ul>
<li><code>RENAME TABLE table_name1 TO table_name2;</code></li>
<li><code>ALTER TABLE table_name1 RENAME TO table_name2;</code></li>
</ul>
</li>
</ul>
</li>
<li><p><a target="_blank" rel="noopener" href="https://www.nowcoder.com/practice/aeaa116185f24f209ca4fa40e226de48?tpId=82&tags=&title=&diffculty=0&judgeStatus=0&rp=1">在audit表上创建外键约束，其emp_no对应employees_test表的主键id</a></p>
<ul>
<li><pre><code class="language-sql">  ALTER TABLE table_name
  ADD [CONSTRAINT fk_name] -- CONSTRAINT fk_name 定义外键名，可不定义
  FOREIGN KEY (xx) REFERENCES another_table (xx);
  <pre class="line-numbers language-none"><code class="language-none">
- [将所有获取奖金的员工当前的薪水增加10%](https:&#x2F;&#x2F;www.nowcoder.com&#x2F;practice&#x2F;d3b058dcc94147e09352eb76f93b3274?tpId&#x3D;82&amp;tags&#x3D;&amp;title&#x3D;&amp;diffculty&#x3D;0&amp;judgeStatus&#x3D;0&amp;rp&#x3D;1)

	- MySQL不支持&#96;*&#x3D;&#96;这样的简化字符使用

- [使用含有关键字exists查找未分配具体部门的员工的所有信息](https:&#x2F;&#x2F;www.nowcoder.com&#x2F;practice&#x2F;c39cbfbd111a4d92b221acec1c7c1484?tpId&#x3D;82&amp;tags&#x3D;&amp;title&#x3D;&amp;diffculty&#x3D;0&amp;judgeStatus&#x3D;&amp;rp&#x3D;1)

	- EXISTS和IN的选择
	- EXISTS的用法

- [获取有奖金的员工相关信息](https:&#x2F;&#x2F;www.nowcoder.com&#x2F;practice&#x2F;5cdbf1dcbe8d4c689020b6b2743820bf?tpId&#x3D;82&amp;tags&#x3D;&amp;title&#x3D;&amp;diffculty&#x3D;0&amp;judgeStatus&#x3D;0&amp;rp&#x3D;1)

	- CASE语句

- [统计salary的累计和running_total](https:&#x2F;&#x2F;www.nowcoder.com&#x2F;practice&#x2F;58824cd644ea47d7b2b670c506a159a6?tpId&#x3D;82&amp;tags&#x3D;&amp;title&#x3D;&amp;diffculty&#x3D;0&amp;judgeStatus&#x3D;0&amp;rp&#x3D;1)

	- 窗口函数

- [对于employees表中，给出奇数行的first_name](https:&#x2F;&#x2F;www.nowcoder.com&#x2F;practice&#x2F;e3cf1171f6cc426bac85fd4ffa786594?tpId&#x3D;82&amp;tags&#x3D;&amp;title&#x3D;&amp;diffculty&#x3D;0&amp;judgeStatus&#x3D;0&amp;rp&#x3D;1)

	- 窗口函数

- [刷题通过的题目排名](https:&#x2F;&#x2F;www.nowcoder.com&#x2F;practice&#x2F;cd2e10a588dc4c1db0407d0bf63394f3?tpId&#x3D;82&amp;tags&#x3D;&amp;title&#x3D;&amp;diffculty&#x3D;0&amp;judgeStatus&#x3D;0&amp;rp&#x3D;1)

	- 窗口函数
	- 排序

- [异常的邮件概率](https:&#x2F;&#x2F;www.nowcoder.com&#x2F;practice&#x2F;d6dd656483b545159d3aa89b4c26004e?tpId&#x3D;82&amp;tags&#x3D;&amp;title&#x3D;&amp;diffculty&#x3D;0&amp;judgeStatus&#x3D;0&amp;rp&#x3D;1)
	
	- COUNT函数非NULL的都会计数
	
- [牛客每个人最近的登录日期(三)](https:&#x2F;&#x2F;www.nowcoder.com&#x2F;practice&#x2F;16d41af206cd4066a06a3a0aa585ad3d?tpId&#x3D;82&amp;tags&#x3D;&amp;title&#x3D;&amp;diffculty&#x3D;0&amp;judgeStatus&#x3D;0&amp;rp&#x3D;1)
	- 在执行乘法&#96;*&#96;前，**注意括号的使用**
	- &#96;WHERE XX IN XXX&#96;**可以用于对一个组合的查询**
	
- ⭐[牛客每个人最近的登录日期(四)](https:&#x2F;&#x2F;www.nowcoder.com&#x2F;practice&#x2F;e524dc7450234395aa21c75303a42b0a?tpId&#x3D;82&amp;tags&#x3D;&amp;title&#x3D;&amp;diffculty&#x3D;0&amp;judgeStatus&#x3D;0&amp;rp&#x3D;1)
	- 解法一：LEFT JOIN + IFNULL函数
		- 笛卡尔积**如果WHERE不满足，整个所生成的元组就不会显示**，**如果要显示的话,就必须使用JOIN连接**
	- 解法二：窗口函数 + SUM函数
	
- ⭐⭐[牛客每个人最近的登录日期(五)](https:&#x2F;&#x2F;www.nowcoder.com&#x2F;practice&#x2F;ea0c56cd700344b590182aad03cc61b8?tpId&#x3D;82&amp;tags&#x3D;&amp;title&#x3D;&amp;diffculty&#x3D;0&amp;judgeStatus&#x3D;0&amp;rp&#x3D;1)

- ⭐[牛客每个人最近的登录日期(六)](https:&#x2F;&#x2F;www.nowcoder.com&#x2F;practice&#x2F;572a027e52804c058e1f8b0c5e8a65b4?tpId&#x3D;82&amp;tags&#x3D;&amp;title&#x3D;&amp;diffculty&#x3D;0&amp;judgeStatus&#x3D;0&amp;rp&#x3D;1)

---

## 最近登陆时间，增量更新：

table_1是一个按天分区的 用户日志表，每次一个用户登陆都会新加一行：

day           timestamp             uid

2018-08-01     2018-08-01 11:00:00    1

2018-08-01     2018-08-01 14:00:00    1

 

需要根据table_1新建一个table_2:

Day           uid        latest_login_time

2018-08-01    1          2018-08-01 14:00:00 

 

每天新增一个昨日的分区的全量用户表，其中latest_login_time是自用户登录起最近一次登录的时间

&#96;&#96;&#96;sql
CREATE TABLE tabel2 (
    day	DATE NOT NULL,
    uid	INT NOT NULL,
    &#96;latest login time&#96; TIMESTAMP
);

INSERT INTO table2(day,
                  uid,
                  &#96;latest login time&#96;)
SELECT day, uid, MAX(&#96;timestamp&#96;)
FROM table_1
WHERE DATEDIFF(CURDATE(), day) &#x3D; 1 -- 昨天
GROUP BY uid;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</code></pre>
</li>
</ul>
</li>
</ul>
<hr>
<h2 id="累计用户数计算"><a href="#累计用户数计算" class="headerlink" title="累计用户数计算"></a>累计用户数计算</h2><p>table a是一个用户<strong>注册时间</strong>的记录表,一个用户只有一条数据，a表如下：</p>
<p>create_time  					uid </p>
<p>2018-08-01 14:07:09 	111</p>
<p>2018-08-02 14:07:09 	134</p>
<p>需要计算<strong>8月份累计注册用户数</strong>(从8月1日开始累计计算，8月1日为8月1日注册用户数，8月2日为8月1日-2日两天的注册用户数），计算结果格式如下：</p>
<p>时间 累计用户数</p>
<p>2018-08-01 	2000000</p>
<p>2018-08-02 	2100000</p>
<p>…………….</p>
<p>2018-08-31 10000000</p>
<pre class="line-numbers language-SQL" data-language="SQL"><code class="language-SQL">SELECT DATE(create_time) AS 时间, 
		COUNT(uid) OVER (ORDER BY creat_time) AS 累计用户数
FROM &#96;table a&#96;
WHERE YEAR(create_time) &#x3D; 2018 AND MONTH(create_time) &#x3D; 8;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h2 id="连续访问天数"><a href="#连续访问天数" class="headerlink" title="连续访问天数"></a>连续访问天数</h2><p>table a 是一个用户登陆时间记录表，每登陆一次会记录一条记录，a表如下：</p>
<p>log_time 							uid</p>
<p>2018-07-01 12:00:00 	123</p>
<p>2018-07-01 13:00:00 	123</p>
<p>2018-07-02 14:08:09 	456</p>
<p>需要计算出7月1日登陆的用户，在后续连续登陆7天，14天，30天的人数</p>
<p>计算结果格式如下：</p>
<p>7月1日登陆总用户数 连续登陆7天用户数 连续登陆14天用户数 。。。。</p>
<p>1000 500 200</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span>table_a<span class="token punctuation">.</span>uid<span class="token punctuation">)</span> <span class="token keyword">AS</span> <span class="token string">'7月1日登录总用户数'</span><span class="token punctuation">,</span> <span class="token function">COUNT</span><span class="token punctuation">(</span>table_b<span class="token punctuation">.</span>uid<span class="token punctuation">)</span> <span class="token keyword">AS</span> <span class="token string">'连续登录7天的用户数'</span><span class="token punctuation">,</span> <span class="token function">COUNT</span><span class="token punctuation">(</span>table_c<span class="token punctuation">.</span>uid<span class="token punctuation">)</span> <span class="token keyword">AS</span> <span class="token string">'连续登录14天的用户数'</span>
<span class="token keyword">FROM</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> <span class="token keyword">DISTINCT</span> uid
			<span class="token keyword">FROM</span> consecutive_task
			<span class="token keyword">WHERE</span> <span class="token keyword">DATE</span><span class="token punctuation">(</span>login_time<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token string">'2018-07-01'</span><span class="token punctuation">)</span> table_a
<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> uid<span class="token punctuation">,</span> <span class="token punctuation">(</span>login_date <span class="token operator">-</span> rank_num<span class="token punctuation">)</span> <span class="token keyword">AS</span> rnk
           <span class="token keyword">FROM</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> uid<span class="token punctuation">,</span> login_date<span class="token punctuation">,</span> <span class="token punctuation">(</span>ROW_NUMBER<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">OVER</span> <span class="token punctuation">(</span><span class="token keyword">PARTITION</span> <span class="token keyword">BY</span> uid
                                                             <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> login_date<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> rank_num
                 <span class="token keyword">FROM</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> uid<span class="token punctuation">,</span> <span class="token keyword">DATE</span><span class="token punctuation">(</span>login_time<span class="token punctuation">)</span> <span class="token keyword">AS</span> login_date
                       <span class="token keyword">FROM</span> consecutive_task
                       <span class="token keyword">WHERE</span> <span class="token keyword">DATE</span><span class="token punctuation">(</span>login_time<span class="token punctuation">)</span> <span class="token operator">BETWEEN</span> <span class="token string">'2018-07-01'</span> <span class="token operator">AND</span> <span class="token string">'2018-07-07'</span>
                       <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> uid<span class="token punctuation">,</span> login_date<span class="token punctuation">)</span> b1 <span class="token punctuation">)</span> b2
           <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> uid<span class="token punctuation">,</span> rnk
           <span class="token keyword">HAVING</span> <span class="token function">COUNT</span><span class="token punctuation">(</span>rnk<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">7</span><span class="token punctuation">)</span> table_b									
<span class="token keyword">ON</span> table_a<span class="token punctuation">.</span>uid <span class="token operator">=</span> table_b<span class="token punctuation">.</span>uid
<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> uid<span class="token punctuation">,</span> <span class="token punctuation">(</span>login_date <span class="token operator">-</span> rank_num<span class="token punctuation">)</span> <span class="token keyword">AS</span> rnk
           <span class="token keyword">FROM</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> uid<span class="token punctuation">,</span> login_date<span class="token punctuation">,</span> <span class="token punctuation">(</span>ROW_NUMBER<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">OVER</span> <span class="token punctuation">(</span><span class="token keyword">PARTITION</span> <span class="token keyword">BY</span> uid
                                                             <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> login_date<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> rank_num
                 <span class="token keyword">FROM</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> uid<span class="token punctuation">,</span> <span class="token keyword">DATE</span><span class="token punctuation">(</span>login_time<span class="token punctuation">)</span> <span class="token keyword">AS</span> login_date
                       <span class="token keyword">FROM</span> consecutive_task
                       <span class="token keyword">WHERE</span> <span class="token keyword">DATE</span><span class="token punctuation">(</span>login_time<span class="token punctuation">)</span> <span class="token operator">BETWEEN</span> <span class="token string">'2018-07-01'</span> <span class="token operator">AND</span> <span class="token string">'2020-07-14'</span>
                       <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> uid<span class="token punctuation">,</span> login_date<span class="token punctuation">)</span> c1 <span class="token punctuation">)</span> c2
           <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> uid<span class="token punctuation">,</span> rnk
           <span class="token keyword">HAVING</span> <span class="token function">COUNT</span><span class="token punctuation">(</span>rnk<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">14</span><span class="token punctuation">)</span> table_c									
<span class="token keyword">ON</span> table_a<span class="token punctuation">.</span>uid <span class="token operator">=</span> table_c<span class="token punctuation">.</span>uid<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h2 id="新增用户的近7日留存率"><a href="#新增用户的近7日留存率" class="headerlink" title="新增用户的近7日留存率"></a>新增用户的近7日留存率</h2><p>table1：用户新增表，一个设备首次激活都新加一行：</p>
<p>timestamp，device 【新增的日期，新增的设备】</p>
<p>table2: 是一个<strong>按天分区</strong>的用户活跃表，每次一个用户登陆都会新加一行：</p>
<p>day，device 【活跃的日期，活跃的设备】</p>
<p>需要计算用户新增用户的留存数，留存率【1-7日】</p>
<p>计算结果格式如下：</p>
<p>新增日期 	新增设备数 	次日留存数 	次日留存率 	2日留存数 	2日留存率 ….</p>
<p>timestamp 	1000 				500 					50% 				450 				45%</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SELECT</span> a<span class="token punctuation">.</span><span class="token keyword">first</span> <span class="token keyword">AS</span> 新增日期<span class="token punctuation">,</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token keyword">DISTINCT</span> a<span class="token punctuation">.</span>device<span class="token punctuation">)</span> <span class="token keyword">AS</span> 新增设备数<span class="token punctuation">,</span> 
			<span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token keyword">DISTINCT</span> <span class="token keyword">IF</span><span class="token punctuation">(</span><span class="token keyword">first</span> <span class="token operator">-</span> b<span class="token punctuation">.</span><span class="token keyword">day</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> a<span class="token punctuation">.</span>device<span class="token punctuation">,</span> <span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> 次日留存数<span class="token punctuation">,</span> 
            	CONCAT<span class="token punctuation">(</span><span class="token function">ROUND</span><span class="token punctuation">(</span><span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token keyword">DISTINCT</span> <span class="token keyword">IF</span><span class="token punctuation">(</span><span class="token keyword">first</span> <span class="token operator">-</span> b<span class="token punctuation">.</span><span class="token keyword">day</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> a<span class="token punctuation">.</span>device<span class="token punctuation">,</span> <span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token keyword">DISTINCT</span> a<span class="token punctuation">.</span>device<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'%'</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> 次日留存率 
<span class="token keyword">FROM</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> a<span class="token punctuation">.</span>device<span class="token punctuation">,</span> <span class="token keyword">DATE</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span><span class="token keyword">timestamp</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> <span class="token keyword">first</span><span class="token punctuation">,</span> b<span class="token punctuation">.</span><span class="token keyword">day</span> 
      <span class="token keyword">FROM</span> table1 a <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> table2 b 
      <span class="token keyword">ON</span> a<span class="token punctuation">.</span>device <span class="token operator">=</span> b<span class="token punctuation">.</span>device<span class="token punctuation">)</span> c
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> a<span class="token punctuation">.</span><span class="token keyword">first</span><span class="token punctuation">;</span> <span class="token comment">-- 按 新增用户的日期 分组</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h2 id="计算日活用户签到，开宝箱，阅读行为的用户各自占比"><a href="#计算日活用户签到，开宝箱，阅读行为的用户各自占比" class="headerlink" title="计算日活用户签到，开宝箱，阅读行为的用户各自占比"></a>计算日活用户签到，开宝箱，阅读行为的用户各自占比</h2><p>table1: 是一个按天分区的<strong>用户活跃表</strong>，每次一个用户<strong>登陆</strong>都会新加一行：</p>
<p>day，uid 【活跃的日期，活跃的用户id】 </p>
<p>table2：是一个按天分区的<strong>用户行为表</strong>，每一种<strong>行为</strong>都会新加一行：</p>
<p>day ,uid,type 【日期，用户id，type类型：1表示签到，2表示开宝箱，3表示阅读】 </p>
<p>需要计算，<strong>签到占日活的比例</strong>，开宝箱占日活的比例，阅读占日活的比例</p>
<p>计算结果格式如下：</p>
<p>日期		活跃用户数		签到占日活的比例		开宝箱占日活的比例		阅读占日活的比例</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SELECT</span> <span class="token keyword">day</span> <span class="token keyword">AS</span> 日期<span class="token punctuation">,</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token keyword">DISTINCT</span> uid<span class="token punctuation">)</span> <span class="token keyword">AS</span> 活跃用户数<span class="token punctuation">,</span> 
			<span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token keyword">IF</span><span class="token punctuation">(</span><span class="token keyword">type</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token function">COUNT</span><span class="token punctuation">(</span>uid<span class="token punctuation">)</span> <span class="token keyword">AS</span> 签到占日活的比例<span class="token punctuation">,</span>
			<span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token keyword">IF</span><span class="token punctuation">(</span><span class="token keyword">type</span> <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token function">COUNT</span><span class="token punctuation">(</span>uid<span class="token punctuation">)</span> <span class="token keyword">AS</span> 开宝箱占日活的比例<span class="token punctuation">,</span>
			<span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token keyword">IF</span><span class="token punctuation">(</span><span class="token keyword">type</span> <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token function">COUNT</span><span class="token punctuation">(</span>uid<span class="token punctuation">)</span> <span class="token keyword">AS</span> 阅读占日活的比例
<span class="token keyword">FROM</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> a<span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">,</span> b<span class="token punctuation">.</span><span class="token keyword">type</span> 
      <span class="token keyword">FROM</span> table_1 <span class="token keyword">AS</span> a <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> table_2 <span class="token keyword">AS</span> b 
      <span class="token keyword">ON</span> a<span class="token punctuation">.</span>uid <span class="token operator">=</span> b<span class="token punctuation">.</span>uid <span class="token operator">AND</span> a<span class="token punctuation">.</span><span class="token keyword">day</span> <span class="token operator">=</span> b<span class="token punctuation">.</span><span class="token keyword">day</span><span class="token punctuation">)</span> c
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> <span class="token keyword">day</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h2 id="练习四"><a href="#练习四" class="headerlink" title="练习四"></a>练习四</h2><h3 id="准备数据-3"><a href="#准备数据-3" class="headerlink" title="准备数据"></a>准备数据</h3><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> Employee 
<span class="token punctuation">(</span>
	id <span class="token keyword">INT</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	name <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	salary <span class="token keyword">INT</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	departmentid <span class="token keyword">INT</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> Employee 
<span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">"Joe"</span><span class="token punctuation">,</span><span class="token number">70000</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
		<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token string">"Henry"</span><span class="token punctuation">,</span><span class="token number">80000</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
		<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token string">"Sam"</span><span class="token punctuation">,</span><span class="token number">60000</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
		<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token string">"Max"</span><span class="token punctuation">,</span><span class="token number">90000</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> Department 
<span class="token punctuation">(</span>
    id <span class="token keyword">INT</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    name <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> Department 
<span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">"IT"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
		<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token string">"Sales"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="练习题-2"><a href="#练习题-2" class="headerlink" title="练习题"></a>练习题</h3><p>找出每个部门工资最高的员工</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SELECT</span> d<span class="token punctuation">.</span>name Department<span class="token punctuation">,</span> e<span class="token punctuation">.</span>name Employee<span class="token punctuation">,</span> <span class="token function">MAX</span><span class="token punctuation">(</span>Salary<span class="token punctuation">)</span> Salary
<span class="token keyword">FROM</span> Employee e <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> Department d
<span class="token keyword">ON</span> e<span class="token punctuation">.</span>departmentid <span class="token operator">=</span> d<span class="token punctuation">.</span>id
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> d<span class="token punctuation">.</span>id<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h3 id="准备数据-4"><a href="#准备数据-4" class="headerlink" title="准备数据"></a>准备数据</h3><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> customer
<span class="token punctuation">(</span>
    Id <span class="token keyword">INT</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	Email <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> customer
<span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">'a@b.com'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
		<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token string">'c@d.com'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
		<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token string">'a@b.com'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="练习题-3"><a href="#练习题-3" class="headerlink" title="练习题"></a>练习题</h3><p>查找 customer 表中所有重复的电子邮箱</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SELECT</span> Email
<span class="token keyword">FROM</span> customer
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> Email
<span class="token keyword">HAVING</span> <span class="token function">COUNT</span><span class="token punctuation">(</span>Email<span class="token punctuation">)</span><span class="token operator">></span><span class="token number">1</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h3 id="准备数据-5"><a href="#准备数据-5" class="headerlink" title="准备数据"></a>准备数据</h3><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> Customers
<span class="token punctuation">(</span> 
    Id <span class="token keyword">INT</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    Name <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> Customers 
<span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">'Joe'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
		<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token string">'Henry'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
		<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token string">'Sam'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
		<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token string">'Max'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> Orders
<span class="token punctuation">(</span>
	Id <span class="token keyword">INT</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	CustomerId <span class="token keyword">INT</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> Orders
<span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
		<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>练习题：找出所有<strong>从不订购任何东西</strong>的客户</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">-- 方法一</span>
<span class="token keyword">SELECT</span> name <span class="token keyword">AS</span> customers
<span class="token keyword">FROM</span> customers c <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> orders o
<span class="token keyword">ON</span> c<span class="token punctuation">.</span>id <span class="token operator">=</span> o<span class="token punctuation">.</span>customerId
<span class="token keyword">WHERE</span> o<span class="token punctuation">.</span>id <span class="token operator">IS</span> <span class="token boolean">NULL</span><span class="token punctuation">;</span>

<span class="token comment">-- 方法二</span>
<span class="token keyword">SELECT</span> name <span class="token keyword">AS</span> customers
<span class="token keyword">FROM</span> customers
<span class="token keyword">WHERE</span> id <span class="token operator">NOT</span> <span class="token operator">IN</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> customerid
								<span class="token keyword">FROM</span> orders<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h3 id="准备数据-6"><a href="#准备数据-6" class="headerlink" title="准备数据"></a>准备数据</h3><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> Scores
<span class="token punctuation">(</span> 
    id <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
    score <span class="token keyword">FLOAT</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> scores 
<span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3.5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
		<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3.65</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
		<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4.00</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
		<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">3.85</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
		<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">4.00</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
		<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">3.65</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>练习题：通过查询实现分数排名</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">-- 窗口函数 ROW_NUMBER()</span>
<span class="token keyword">SELECT</span> score<span class="token punctuation">,</span> ROW_NUMBER<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">OVER</span> <span class="token punctuation">(</span><span class="token keyword">ORDER</span> <span class="token keyword">BY</span> score <span class="token keyword">DESC</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> <span class="token identifier"><span class="token punctuation">`</span>Rank<span class="token punctuation">`</span></span>
<span class="token keyword">FROM</span> scores
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> score <span class="token keyword">DESC</span><span class="token punctuation">;</span>

<span class="token comment">-- ROW_NUMBER() 对应 使用变量 的做法</span>
<span class="token keyword">SELECT</span> score<span class="token punctuation">,</span> <span class="token variable">@curRank</span><span class="token operator">=</span><span class="token variable">@curRank</span><span class="token operator">+</span><span class="token number">1</span> <span class="token keyword">AS</span> <span class="token identifier"><span class="token punctuation">`</span>Rank<span class="token punctuation">`</span></span>
<span class="token keyword">FROM</span> scores<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> <span class="token variable">@RANK</span>:<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span> r
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> score <span class="token keyword">DESC</span><span class="token punctuation">;</span>

<span class="token comment">-- RANK() (有并列名次的行，会占用下一名次的位置)对应使用变量的做法</span>
<span class="token keyword">SELECT</span> score<span class="token punctuation">,</span> <span class="token identifier"><span class="token punctuation">`</span>rank<span class="token punctuation">`</span></span>
<span class="token keyword">FROM</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> score<span class="token punctuation">,</span> <span class="token variable">@curRank</span> <span class="token operator">=</span> <span class="token keyword">IF</span><span class="token punctuation">(</span><span class="token variable">@preScore</span> <span class="token operator">=</span> score<span class="token punctuation">,</span> <span class="token variable">@curRank</span><span class="token punctuation">,</span> <span class="token variable">@incRank</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> <span class="token identifier"><span class="token punctuation">`</span>rank<span class="token punctuation">`</span></span><span class="token punctuation">,</span> <span class="token comment">-- 同分同排名，不同分下一排名</span>
                <span class="token variable">@incRank</span>:<span class="token operator">=</span><span class="token variable">@incRank</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">-- 作用等同于 ROW_NUMBER()</span>
                <span class="token variable">@preScore</span>:<span class="token operator">=</span>score
      <span class="token keyword">FROM</span> scores<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> <span class="token variable">@curRank</span>:<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token variable">@preScore</span>:<span class="token operator">=</span><span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token variable">@incRank</span>:<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span> r
      <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> score <span class="token keyword">DESC</span><span class="token punctuation">)</span> s<span class="token punctuation">;</span>
      
<span class="token comment">-- DENSE_RANK() 对应使用变量的做法</span>

<span class="token keyword">SELECT</span> score<span class="token punctuation">,</span> <span class="token identifier"><span class="token punctuation">`</span>rank<span class="token punctuation">`</span></span>
<span class="token keyword">FROM</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> score<span class="token punctuation">,</span> <span class="token variable">@curRank</span><span class="token operator">=</span><span class="token keyword">IF</span><span class="token punctuation">(</span><span class="token variable">@preScore</span><span class="token operator">=</span>score<span class="token punctuation">,</span> <span class="token variable">@curRank</span><span class="token punctuation">,</span> <span class="token variable">@curRank</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> <span class="token identifier"><span class="token punctuation">`</span>rank<span class="token punctuation">`</span></span><span class="token punctuation">,</span>
				<span class="token variable">@preScore</span><span class="token operator">=</span>score
	  <span class="token keyword">FROM</span> scores<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> <span class="token variable">@curRank</span>:<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token variable">@preScore</span>:<span class="token operator">=</span><span class="token boolean">NULL</span><span class="token punctuation">)</span> r
	  <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> socre <span class="token keyword">DESC</span><span class="token punctuation">)</span> s<span class="token punctuation">;</span>
	  
<span class="token comment">-- 使用CASE WHEN更简洁</span>
<span class="token keyword">SELECT</span> score<span class="token punctuation">,</span> <span class="token keyword">CASE</span> 
				<span class="token keyword">WHEN</span> score<span class="token operator">=</span><span class="token variable">@preScore</span> <span class="token keyword">THEN</span> <span class="token variable">@curRank</span>
                <span class="token keyword">WHEN</span> <span class="token variable">@preScore</span>:<span class="token operator">=</span>score <span class="token keyword">THEN</span> <span class="token variable">@curRank</span>:<span class="token operator">=</span><span class="token variable">@curRank</span><span class="token operator">+</span><span class="token number">1</span> <span class="token comment">-- @preScore:=score 赋值语句必为true</span>
              <span class="token keyword">END</span> <span class="token keyword">AS</span> <span class="token identifier"><span class="token punctuation">`</span>rank<span class="token punctuation">`</span></span>
<span class="token keyword">FROM</span> scores<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> <span class="token variable">@curRank</span>:<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token variable">@preScore</span>:<span class="token operator">=</span><span class="token boolean">NULL</span><span class="token punctuation">)</span> r
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> score <span class="token keyword">DESC</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h3 id="准备数据-7"><a href="#准备数据-7" class="headerlink" title="准备数据"></a>准备数据</h3><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> seat 
<span class="token punctuation">(</span> 
    id <span class="token keyword">INT</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	student <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span> 

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> seat 
<span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">'Abbot'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
		<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token string">'Doris'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
		<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token string">'Emerson'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
		<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token string">'Green'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
		<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token string">'Jeames'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>练习题：座位id 是连续递增的，改变相邻俩学生的座位。<br> <strong>要求:</strong></p>
<ul>
<li><strong>如果学生人数是奇数，则不需要改变最后一个同学的座位。</strong></li>
</ul>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SELECT</span> <span class="token punctuation">(</span><span class="token keyword">CASE</span>
            <span class="token keyword">WHEN</span> id <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">AND</span> id <span class="token operator">!=</span> cnt <span class="token keyword">THEN</span> id<span class="token operator">+</span><span class="token number">1</span> <span class="token comment">-- 奇数且不是最后一个</span>
            <span class="token keyword">WHEN</span> id <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">AND</span> id <span class="token operator">=</span> cnt <span class="token keyword">THEN</span> id
            <span class="token keyword">ELSE</span> id <span class="token operator">-</span> <span class="token number">1</span> <span class="token comment">-- 偶数</span>
        <span class="token keyword">END</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> id<span class="token punctuation">,</span> student
<span class="token keyword">FROM</span> seat<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> cnt <span class="token comment">-- 用于判断当前是否是最后一个学生(奇数的特殊判断)</span>
            <span class="token keyword">FROM</span> seat<span class="token punctuation">)</span> t
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> id<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h3 id="准备数据-8"><a href="#准备数据-8" class="headerlink" title="准备数据"></a>准备数据</h3><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">DROP</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token keyword">EXISTS</span> Employee<span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> Employee
<span class="token punctuation">(</span> 
		Id <span class="token keyword">INT</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
		Name <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
		Salary <span class="token keyword">INT</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
		ManagerId <span class="token keyword">INT</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> Employee 
<span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'Joe'</span><span class="token punctuation">,</span> <span class="token number">70000</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
		<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'Henry'</span><span class="token punctuation">,</span> <span class="token number">80000</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
		<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">'Sam'</span><span class="token punctuation">,</span> <span class="token number">60000</span><span class="token punctuation">,</span> <span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
		<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token string">'Max'</span><span class="token punctuation">,</span> <span class="token number">90000</span><span class="token punctuation">,</span> <span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>练习题：编写一个 SQL 查询，获取收入超过他们经理的员工的姓名。</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SELECT</span> e1<span class="token punctuation">.</span>Name
<span class="token keyword">FROM</span> Employee e1 <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> Employee e2
<span class="token keyword">ON</span> e1<span class="token punctuation">.</span>ManagerId <span class="token operator">=</span> e2<span class="token punctuation">.</span>Id
<span class="token keyword">WHERE</span> e1<span class="token punctuation">.</span>Salary <span class="token operator">></span> e2<span class="token punctuation">.</span>Salary<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h2 id="练习五"><a href="#练习五" class="headerlink" title="练习五"></a>练习五</h2><p><strong>题目:<strong>X 市建了一个新的体育馆，每日人流量信息被记录在这三列信息中：序号 (id)、日期 (visit_date)、 人流量 (people)。<br> 请编写一个查询语句，找出</strong>人流量的高峰期</strong>。<br> <strong>要求:</strong></p>
<ul>
<li>高峰期时，<strong>至少连续三行</strong>记录中的<strong>人流量不少于100</strong></li>
<li><strong>每天只有一行记录</strong>，日期随着 id 的增加而增加</li>
</ul>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> stadium 
<span class="token punctuation">(</span> 
    id <span class="token keyword">INT</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
	visit_date <span class="token keyword">DATE</span><span class="token punctuation">,</span> 
	people <span class="token keyword">INT</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span> 

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> stadium 
<span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">'2017-01-01'</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
		<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token string">'2017-01-02'</span><span class="token punctuation">,</span><span class="token number">109</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
		<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token string">'2017-01-03'</span><span class="token punctuation">,</span><span class="token number">150</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
		<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token string">'2017-01-04'</span><span class="token punctuation">,</span><span class="token number">99</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
		<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token string">'2017-01-05'</span><span class="token punctuation">,</span><span class="token number">145</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
		<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token string">'2017-01-06'</span><span class="token punctuation">,</span><span class="token number">1455</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
		<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token string">'2017-01-07'</span><span class="token punctuation">,</span><span class="token number">199</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
		<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token string">'2017-01-08'</span><span class="token punctuation">,</span><span class="token number">188</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">-- 方法一：朴实的自联结</span>
<span class="token keyword">SELECT</span> <span class="token keyword">DISTINCT</span> t1<span class="token punctuation">.</span><span class="token operator">*</span>
<span class="token keyword">FROM</span> stadium t1<span class="token punctuation">,</span> stadium t2<span class="token punctuation">,</span> stadium t3
<span class="token keyword">WHERE</span> <span class="token punctuation">(</span>t1<span class="token punctuation">.</span>people <span class="token operator">>=</span> <span class="token number">100</span>     <span class="token comment">-- 筛选表中 人流量>=100 的行</span>
		<span class="token operator">AND</span> t2<span class="token punctuation">.</span>people <span class="token operator">>=</span> <span class="token number">100</span>
		<span class="token operator">AND</span> t3<span class="token punctuation">.</span>people <span class="token operator">>=</span> <span class="token number">100</span>
		<span class="token operator">AND</span> <span class="token punctuation">(</span> <span class="token punctuation">(</span>t1<span class="token punctuation">.</span>id <span class="token operator">-</span> t2<span class="token punctuation">.</span>id <span class="token operator">=</span> <span class="token number">1</span> <span class="token comment">-- 错位联结，从t1的id开始连续3天有人流高峰</span>
				 <span class="token operator">AND</span> t1<span class="token punctuation">.</span>id <span class="token operator">-</span> t3<span class="token punctuation">.</span>id <span class="token operator">=</span> <span class="token number">2</span>
			 	 <span class="token operator">AND</span> t2<span class="token punctuation">.</span>id <span class="token operator">-</span> t3<span class="token punctuation">.</span>id <span class="token operator">=</span> <span class="token number">1</span>
                <span class="token punctuation">)</span> 
             	<span class="token operator">OR</span> <span class="token punctuation">(</span>t2<span class="token punctuation">.</span>id <span class="token operator">-</span> t1<span class="token punctuation">.</span>id <span class="token operator">=</span> <span class="token number">1</span> <span class="token comment">-- 补充 t1之后只有1天人流高峰，但之前也有连续高峰 的情况</span>
					 <span class="token operator">AND</span> t2<span class="token punctuation">.</span>id <span class="token operator">-</span> t3<span class="token punctuation">.</span>id <span class="token operator">=</span> <span class="token number">2</span>
					 <span class="token operator">AND</span> t1<span class="token punctuation">.</span>id <span class="token operator">-</span> t3<span class="token punctuation">.</span>id <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span>
				<span class="token operator">OR</span> <span class="token punctuation">(</span>t3<span class="token punctuation">.</span>id <span class="token operator">-</span> t2<span class="token punctuation">.</span>id <span class="token operator">=</span> <span class="token number">1</span> <span class="token comment">-- 补充t1为人流高峰最后一天 的情况</span>
					 <span class="token operator">AND</span> t2<span class="token punctuation">.</span>id <span class="token operator">-</span> t1<span class="token punctuation">.</span>id <span class="token operator">=</span> <span class="token number">1</span>
					 <span class="token operator">AND</span> t3<span class="token punctuation">.</span>id <span class="token operator">-</span> t1<span class="token punctuation">.</span>id <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span> 
             <span class="token punctuation">)</span>
        <span class="token punctuation">)</span>
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> t1<span class="token punctuation">.</span>id<span class="token punctuation">;</span> 
       
       
<span class="token comment">-- 方法二：MySQL 8.0 之后开始支持 WITH AS 语句(子查询部分，作用类似于一个视图，但with as 属于一次性的，而且必须和其他sql一起使用才行) WITH子句的查询必须用括号括起来</span>
<span class="token keyword">WITH</span> t1 <span class="token keyword">AS</span>
<span class="token punctuation">(</span><span class="token keyword">SELECT</span> id<span class="token punctuation">,</span> visit_date<span class="token punctuation">,</span> people<span class="token punctuation">,</span>
        <span class="token punctuation">(</span>id <span class="token operator">-</span> ROW_NUMBER<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">OVER</span> <span class="token punctuation">(</span><span class="token keyword">ORDER</span> <span class="token keyword">BY</span> id<span class="token punctuation">)</span><span class="token punctuation">)</span> rk
<span class="token keyword">FROM</span> stadium
<span class="token keyword">WHERE</span> people <span class="token operator">>=</span> <span class="token number">100</span><span class="token punctuation">)</span>

<span class="token keyword">SELECT</span> id<span class="token punctuation">,</span> visit_date<span class="token punctuation">,</span> people
<span class="token keyword">FROM</span> t1
<span class="token keyword">WHERE</span> rk <span class="token operator">IN</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> rk 
            <span class="token keyword">FROM</span> t1
            <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> rk
            <span class="token keyword">HAVING</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token operator">>=</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h3 id="挑战题"><a href="#挑战题" class="headerlink" title="挑战题"></a>挑战题</h3><p><img src="https://i.loli.net/2020/09/13/2pa43QDgf8wzReU.png"></p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SELECT</span> 日期<span class="token punctuation">,</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token keyword">DISTINCT</span> a<span class="token punctuation">.</span>uid<span class="token punctuation">)</span> 活跃用户数<span class="token punctuation">,</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token keyword">DISTINCT</span> <span class="token keyword">IF</span><span class="token punctuation">(</span><span class="token keyword">day</span><span class="token operator">-</span><span class="token keyword">first</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> a<span class="token punctuation">.</span>uid<span class="token punctuation">,</span> <span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">)</span> 次日留存用户数<span class="token punctuation">,</span>
			<span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token keyword">DISTINCT</span> <span class="token keyword">IF</span><span class="token punctuation">(</span><span class="token keyword">day</span><span class="token operator">-</span><span class="token keyword">first</span><span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> a<span class="token punctuation">.</span>uid<span class="token punctuation">,</span> <span class="token boolean">NULL</span><span class="token punctuation">)</span> 三日留存用户数<span class="token punctuation">,</span>
			<span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token keyword">DISTINCT</span> <span class="token keyword">IF</span><span class="token punctuation">(</span><span class="token keyword">day</span><span class="token operator">-</span><span class="token keyword">first</span><span class="token operator">=</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">,</span> a<span class="token punctuation">.</span>uid<span class="token punctuation">,</span> <span class="token boolean">NULL</span><span class="token punctuation">)</span> 七日留存用户数<span class="token punctuation">,</span>
			CONCAT<span class="token punctuation">(</span><span class="token function">ROUND</span><span class="token punctuation">(</span><span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token keyword">DISTINCT</span> <span class="token keyword">IF</span><span class="token punctuation">(</span><span class="token keyword">day</span><span class="token operator">-</span><span class="token keyword">first</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> a<span class="token punctuation">.</span>uid<span class="token punctuation">,</span> <span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token keyword">DISTINCT</span> a<span class="token punctuation">.</span>uid<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'%'</span><span class="token punctuation">)</span> 次日留存率<span class="token punctuation">,</span> CONCAT<span class="token punctuation">(</span><span class="token function">ROUND</span><span class="token punctuation">(</span><span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token keyword">DISTINCT</span> <span class="token keyword">IF</span><span class="token punctuation">(</span><span class="token keyword">day</span><span class="token operator">-</span><span class="token keyword">first</span><span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> a<span class="token punctuation">.</span>uid<span class="token punctuation">,</span> <span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token keyword">DISTINCT</span> a<span class="token punctuation">.</span>uid<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'%'</span><span class="token punctuation">)</span> 三日留存率<span class="token punctuation">,</span> CONCAT<span class="token punctuation">(</span><span class="token function">ROUND</span><span class="token punctuation">(</span><span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token keyword">DISTINCT</span> <span class="token keyword">IF</span><span class="token punctuation">(</span><span class="token keyword">day</span><span class="token operator">-</span><span class="token keyword">first</span><span class="token operator">=</span><span class="token number">7</span><span class="token punctuation">,</span> a<span class="token punctuation">.</span>uid<span class="token punctuation">,</span> <span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token keyword">DISTINCT</span> a<span class="token punctuation">.</span>uid<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'%'</span><span class="token punctuation">)</span> 七日留存率
<span class="token keyword">FROM</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> uid<span class="token punctuation">,</span> DATE_FORMAT<span class="token punctuation">(</span>dayno<span class="token punctuation">,</span> <span class="token string">'%Y-%m-%d'</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> <span class="token keyword">first</span>
      <span class="token keyword">FROM</span> act_user_info
      <span class="token keyword">WHERE</span> app_name <span class="token operator">=</span> <span class="token string">'相机'</span><span class="token punctuation">)</span> a <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> uid<span class="token punctuation">,</span> DATE_FORMAT<span class="token punctuation">(</span>dayno<span class="token punctuation">,</span> <span class="token string">'%Y-%m-%d'</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> <span class="token keyword">day</span>
                                           <span class="token keyword">FROM</span> act_user_info
                                           <span class="token keyword">WHERE</span> app_name <span class="token operator">=</span> <span class="token string">'相机'</span><span class="token punctuation">)</span> b
<span class="token keyword">ON</span> a<span class="token punctuation">.</span>uid <span class="token operator">=</span> b<span class="token punctuation">.</span>uid
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> <span class="token keyword">first</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h2 id="PDD笔试题"><a href="#PDD笔试题" class="headerlink" title="PDD笔试题"></a>PDD笔试题</h2><h3 id="2-用户行为分析"><a href="#2-用户行为分析" class="headerlink" title="2. 用户行为分析"></a>2. 用户行为分析</h3><p>表1——用户行为表tracking_log，大概字段有（user_id‘用户编号’,opr_id‘操作编号’,log_time‘操作时间’）</p>
<ul>
<li>统计<strong>每天</strong>符合以下条件的<strong>用户数</strong>：<strong>A操作之后是B操作</strong>，AB操作必须相连</li>
</ul>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">-- 使用窗口函数</span>
<span class="token keyword">SELECT</span> <span class="token keyword">DATE</span><span class="token punctuation">(</span>log_time<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token keyword">DISTINCT</span> user_id<span class="token punctuation">)</span>
<span class="token keyword">FROM</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> <span class="token keyword">DATE</span><span class="token punctuation">(</span>log_time<span class="token punctuation">)</span><span class="token punctuation">,</span> user_id<span class="token punctuation">,</span> opr_id<span class="token punctuation">,</span>
     			LEAD<span class="token punctuation">(</span>opr_id<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">OVER</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> pre_opr
     <span class="token keyword">FROM</span> tracking_log<span class="token punctuation">)</span> table_1
<span class="token keyword">WHERE</span> opr_id<span class="token operator">=</span><span class="token string">'A'</span> <span class="token operator">AND</span> pre_opr<span class="token operator">=</span><span class="token string">'B'</span>
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> <span class="token keyword">DATE</span><span class="token punctuation">(</span>log_time<span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token comment">-- 使用用户变量</span>
<span class="token keyword">SELECT</span> <span class="token keyword">DATE</span><span class="token punctuation">(</span>log_time<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token keyword">DISTINCT</span> user_id<span class="token punctuation">)</span>
<span class="token keyword">FROM</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> <span class="token keyword">DATE</span><span class="token punctuation">(</span>log_time<span class="token punctuation">)</span><span class="token punctuation">,</span> user_id<span class="token punctuation">,</span>
     			<span class="token punctuation">(</span><span class="token keyword">CASE</span>
     				<span class="token keyword">WHEN</span> <span class="token variable">@pre_opr</span><span class="token operator">=</span><span class="token string">'A'</span> <span class="token operator">AND</span> opr_id<span class="token operator">=</span><span class="token string">'B'</span> <span class="token keyword">THEN</span> <span class="token variable">@isJoin</span>:<span class="token operator">=</span><span class="token boolean">True</span> <span class="token operator">AND</span> <span class="token variable">@pre_opr</span>:<span class="token operator">=</span>opr_id
      				<span class="token keyword">ELSE</span> <span class="token variable">@pre_opr</span>:<span class="token operator">=</span>opr_id
      			<span class="token keyword">END</span><span class="token punctuation">)</span> isJoin
      <span class="token keyword">FROM</span> tracking_log<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> <span class="token variable">@pre_opr</span>:<span class="token operator">=</span><span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token variable">@isJoin</span>:<span class="token operator">=</span><span class="token boolean">FALSE</span><span class="token punctuation">)</span> a<span class="token punctuation">)</span> table_1
<span class="token keyword">WHERE</span> isJoin<span class="token operator">=</span><span class="token boolean">True</span>
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> <span class="token keyword">DATE</span><span class="token punctuation">(</span>log_time<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h3 id="3-用户新增留存分析"><a href="#3-用户新增留存分析" class="headerlink" title="3. 用户新增留存分析"></a>3. 用户新增留存分析</h3><p>表1——用户登陆表user_log，大概字段有（user_id‘用户编号’，log_time‘登陆时间’）</p>
<ul>
<li>获取每日新增用户数，以及第2天、第30天的回访比例</li>
</ul>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span>user_id<span class="token punctuation">)</span> 新增用户数<span class="token punctuation">,</span> 
		<span class="token punctuation">(</span><span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token keyword">DISTINCT</span> <span class="token keyword">IF</span><span class="token punctuation">(</span>DATEDIFF<span class="token punctuation">(</span><span class="token keyword">DATE</span><span class="token punctuation">(</span>log_time<span class="token punctuation">)</span><span class="token punctuation">,</span> 注册日期<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> u1<span class="token punctuation">.</span>user_id<span class="token punctuation">,</span> <span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token function">COUNT</span><span class="token punctuation">(</span>user_id<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> 第<span class="token number">2</span>天回访比例<span class="token punctuation">,</span> 
		<span class="token punctuation">(</span><span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token keyword">DISTINCT</span> <span class="token keyword">IF</span><span class="token punctuation">(</span>DATEDIFF<span class="token punctuation">(</span><span class="token keyword">DATE</span><span class="token punctuation">(</span>log_time<span class="token punctuation">)</span><span class="token punctuation">,</span> 注册日期<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">29</span><span class="token punctuation">,</span> u1<span class="token punctuation">.</span>user_id<span class="token punctuation">,</span> <span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token function">COUNT</span><span class="token punctuation">(</span>user_id<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> 第<span class="token number">30</span>天回访比例
<span class="token keyword">FROM</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> user_id<span class="token punctuation">,</span> <span class="token keyword">DATE</span><span class="token punctuation">(</span><span class="token function">MIN</span><span class="token punctuation">(</span>log_time<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> 注册日期
      <span class="token keyword">FROM</span> user_log
      <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> user_id<span class="token punctuation">)</span> u1 <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> user_log u2
<span class="token keyword">ON</span> u1<span class="token punctuation">.</span>user_id <span class="token operator">=</span> u2<span class="token punctuation">.</span>user_id
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> 注册日期<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="4-贝叶斯公式的应用"><a href="#4-贝叶斯公式的应用" class="headerlink" title="4. 贝叶斯公式的应用"></a>4. 贝叶斯公式的应用</h3><p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/80835787">数据分析笔试题(1) - 知乎</a></p>
<hr>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SELECT</span> Partition_date<span class="token punctuation">,</span> 
		<span class="token punctuation">(</span><span class="token keyword">CASE</span>
			<span class="token keyword">WHEN</span> DATEDIFF<span class="token punctuation">(</span>t2<span class="token punctuation">.</span>Partition_date<span class="token punctuation">,</span> t1<span class="token punctuation">.</span>Partition_date<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">THEN</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token keyword">DISTINCT</span> t1<span class="token punctuation">.</span>user_id<span class="token punctuation">)</span> 
		<span class="token keyword">END</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> <span class="token string">'流失1天'</span><span class="token punctuation">,</span>
		<span class="token punctuation">(</span><span class="token keyword">CASE</span>
        	<span class="token keyword">WHEN</span> DATEDIFF<span class="token punctuation">(</span>t2<span class="token punctuation">.</span>Partition_date<span class="token punctuation">,</span> t1<span class="token punctuation">.</span>Partition_date<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">2</span> <span class="token keyword">THEN</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token keyword">DISTINCT</span> t1<span class="token punctuation">.</span>user_id<span class="token punctuation">)</span> 
        <span class="token keyword">END</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> <span class="token string">'流失2天'</span><span class="token punctuation">,</span>
		<span class="token punctuation">(</span><span class="token keyword">CASE</span>
        	<span class="token keyword">WHEN</span> DATEDIFF<span class="token punctuation">(</span>t2<span class="token punctuation">.</span>Partition_date<span class="token punctuation">,</span> t1<span class="token punctuation">.</span>Partition_date<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">3</span> <span class="token keyword">THEN</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token keyword">DISTINCT</span> t1<span class="token punctuation">.</span>user_id<span class="token punctuation">)</span> 
        <span class="token keyword">END</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> <span class="token string">'流失3天'</span><span class="token punctuation">,</span>
		<span class="token punctuation">(</span><span class="token keyword">CASE</span>
        	<span class="token keyword">WHEN</span> DATEDIFF<span class="token punctuation">(</span>t2<span class="token punctuation">.</span>Partition_date<span class="token punctuation">,</span> t1<span class="token punctuation">.</span>Partition_date<span class="token punctuation">)</span><span class="token operator">>=</span><span class="token number">30</span> <span class="token keyword">THEN</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token keyword">DISTINCT</span> t1<span class="token punctuation">.</span>user_id<span class="token punctuation">)</span> 
        <span class="token keyword">END</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> <span class="token string">'流失30天以上'</span>
<span class="token keyword">FROM</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> user_id<span class="token punctuation">,</span> Partition_date
      <span class="token keyword">FROM</span> user_active
      <span class="token keyword">WHERE</span> daily_active_status_map<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span> t1 <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> user_id<span class="token punctuation">,</span> Partition_date
                                                     <span class="token keyword">FROM</span> usre_active
                                                     <span class="token keyword">WHERE</span> daily_active_status_map<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span> t2
<span class="token keyword">ON</span> t1<span class="token punctuation">.</span>user_id<span class="token operator">=</span>t2<span class="token punctuation">.</span>user_id
<span class="token keyword">WHERE</span> t2<span class="token punctuation">.</span>user_id <span class="token operator">IS</span> <span class="token boolean">NULL</span>
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> Partition_date
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> Partition_date <span class="token keyword">DESC</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>


      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://hunter1023.github.io/2020/06/16/MySQL%E6%8A%A5%E9%94%99%E7%9A%84%E5%88%86%E7%B1%BB%E4%B8%8E%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Hunter">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Talk is cheap">
      <meta itemprop="description" content="Tough times never last, but tough people do.">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Talk is cheap">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/06/16/MySQL%E6%8A%A5%E9%94%99%E7%9A%84%E5%88%86%E7%B1%BB%E4%B8%8E%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95/" class="post-title-link" itemprop="url">MySQL报错的分类与解决方法</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-06-16 22:00:40" itemprop="dateCreated datePublished" datetime="2020-06-16T22:00:40+08:00">2020-06-16</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-01-23 23:29:13" itemprop="dateModified" datetime="2025-01-23T23:29:13+08:00">2025-01-23</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/" itemprop="url" rel="index"><span itemprop="name">数据库</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="无法插入中文字符"><a href="#无法插入中文字符" class="headerlink" title="无法插入中文字符"></a>无法插入中文字符</h2><ul>
<li><p>报错内容：</p>
<blockquote>
<p>1366 - Incorrect string value: ‘\xE6\x9B\xBE\xE5\x8D\x8E’ for column ‘sname’ at row 1</p>
</blockquote>
</li>
<li><p>原因</p>
<p>MySQL默认配置：</p>
<table>
<thead>
<tr>
<th>variable_name</th>
<th>value</th>
</tr>
</thead>
<tbody><tr>
<td>character_set_database</td>
<td><strong>latin1</strong></td>
</tr>
<tr>
<td>character_set_server</td>
<td><strong>latin1</strong></td>
</tr>
</tbody></table>
<p>可通过<code>SHOW VARIABLES LIKE &#39;%char%&#39;;</code>查看。</p>
</li>
<li><p>解决方法</p>
<ol>
<li><p>修改<code>C:\ProgramData\MySQL\MySQL Server 5.7\my.ini</code>：</p>
<ul>
<li><p>找到<code>[mysql]</code></p>
<p>在下方添加<code>default-character-set=utf8</code></p>
</li>
<li><p>找到<code>[mysqld]</code></p>
<p>在下方添加<code>character-set-server=utf8</code></p>
</li>
<li><p>找到<code>[client]</code></p>
<p>在下方添加<code>default-character-set=utf8</code></p>
</li>
</ul>
</li>
<li><p>重启MySQL，重新登录</p>
<ul>
<li><p><code>Win</code> + <code>R</code> - services.msc</p>
</li>
<li><p>找到<strong>MySQL</strong>57(57为版本号)，右键选择重新启动</p>
</li>
<li><p><code>Win</code> + <code>R</code> - cmd（或cmder）</p>
<p>通过<code>mysql -u -root -p</code>命令并输入密码后访问数据库。</p>
</li>
<li><p>通过<code>SHOW VARIABLES LIKE &#39;%char%&#39;;</code>查看，字符集变为utf8即成功修改。</p>
</li>
</ul>
</li>
</ol>
</li>
</ul>
<hr>
<h2 id="Navicat连接数据库报错"><a href="#Navicat连接数据库报错" class="headerlink" title="Navicat连接数据库报错"></a>Navicat连接数据库报错</h2><ul>
<li><p>报错内容：</p>
<blockquote>
<p>2059 - Authentication plugin ‘caching_sha2_password’ cannot be loaded</p>
</blockquote>
</li>
<li><p>原因：</p>
<p>  MySQL<strong>8之前</strong>的版本中加密规则为<strong>mysql_native_password</strong>，而在MySQL<strong>8以后</strong>的加密规则为<strong>caching_sha2_password</strong>。</p>
</li>
<li><p>解决方法：</p>
<p>  在命令行中<strong>登录MySQL后</strong>，使用命令行：</p>
<p>  <code>ALTER USER &#39;root&#39;@&#39;localhost&#39; IDENTIFIED WITH mysql_native_password BY &#39;password&#39;;</code></p>
</li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://hunter1023.github.io/2020/06/14/MySQL%E5%BF%85%E7%9F%A5%E5%BF%85%E4%BC%9A/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Hunter">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Talk is cheap">
      <meta itemprop="description" content="Tough times never last, but tough people do.">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Talk is cheap">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/06/14/MySQL%E5%BF%85%E7%9F%A5%E5%BF%85%E4%BC%9A/" class="post-title-link" itemprop="url">MySQL必知必会</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-06-14 08:26:30" itemprop="dateCreated datePublished" datetime="2020-06-14T08:26:30+08:00">2020-06-14</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-01-23 23:29:13" itemprop="dateModified" datetime="2025-01-23T23:29:13+08:00">2025-01-23</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/" itemprop="url" rel="index"><span itemprop="name">数据库</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/MySQL/" itemprop="url" rel="index"><span itemprop="name">MySQL</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="第1章-了解SQL"><a href="#第1章-了解SQL" class="headerlink" title="第1章 了解SQL"></a>第1章 了解SQL</h2><ul>
<li>数据库软件应称为DBMS（数据库管理系统）。</li>
<li>数据库是通过DBMS创建和操纵的容器。</li>
<li>在很大程度上说，数据库究竟是文件还是别的什么东西并不重要，因为你并不直接访问数据库；你使用的是DBMS，它替你访问数据库。</li>
<li>模式（schema）： 关于<strong>数据库</strong>和<strong>表</strong>的<strong>布局及特性</strong>的信息。</li>
<li>有时，模式用作数据库的同义词。遗憾的是，模式的含义通常在上下文中并不是很清晰。</li>
<li>主键（primary key）</li>
<li>SQL（发音为字母S-Q-L或sequel）是**结构化查询语言（Structured Query Language）**的缩写。</li>
</ul>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2020/06/14/MySQL%E5%BF%85%E7%9F%A5%E5%BF%85%E4%BC%9A/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://hunter1023.github.io/2020/06/13/Python%E5%85%A5%E9%97%A8%E5%88%B0%E5%AE%9E%E8%B7%B5/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Hunter">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Talk is cheap">
      <meta itemprop="description" content="Tough times never last, but tough people do.">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Talk is cheap">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/06/13/Python%E5%85%A5%E9%97%A8%E5%88%B0%E5%AE%9E%E8%B7%B5/" class="post-title-link" itemprop="url">Python入门到实践</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-06-13 15:08:04" itemprop="dateCreated datePublished" datetime="2020-06-13T15:08:04+08:00">2020-06-13</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-01-23 23:29:13" itemprop="dateModified" datetime="2025-01-23T23:29:13+08:00">2025-01-23</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Python/" itemprop="url" rel="index"><span itemprop="name">Python</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>Python和Java一样<strong>大小写敏感</strong>。</p>
<h2 id="变量和简单数据类型"><a href="#变量和简单数据类型" class="headerlink" title="变量和简单数据类型"></a>变量和简单数据类型</h2><h3 id="字符串"><a href="#字符串" class="headerlink" title="字符串"></a>字符串</h3><p>在Python中，用引号(<strong>可以是单引号，也可以是双引号</strong>)括起的都是字符串。</p>
<h4 id="使用方法修改字符串的大小写"><a href="#使用方法修改字符串的大小写" class="headerlink" title="使用方法修改字符串的大小写"></a>使用方法修改字符串的大小写</h4><ul>
<li><p><code>title()</code>:</p>
<p>将字符串中<strong>每个单词</strong> <strong>首字母</strong>改为<strong>大写</strong>，<strong>其余字母小写</strong>。</p>
</li>
<li><p><code>upper()</code>：</p>
<p>将字符串中所有字母改为<strong>大</strong>写</p>
</li>
<li><p><code>lower()</code></p>
<p>将字符串中所有字母改为<strong>小</strong>写</p>
</li>
</ul>
<hr>
<h4 id="合并-拼接-字符串"><a href="#合并-拼接-字符串" class="headerlink" title="合并(拼接)字符串"></a>合并(拼接)字符串</h4><p>Python使用<code>+</code>来合并字符串。</p>
<hr>
<h4 id="使用方法删除多余的空格"><a href="#使用方法删除多余的空格" class="headerlink" title="使用方法删除多余的空格"></a>使用方法删除多余的空格</h4><ul>
<li><p><code>strip()</code>：</p>
<p>删除字符串<strong>首尾</strong>空格</p>
</li>
<li><p><code>lstrip()</code>:</p>
<p>删除字符串<strong>开头</strong>的空格</p>
</li>
<li><p><code>rstrip()</code>：</p>
<p>删除字符串<strong>末尾</strong>的空格</p>
</li>
</ul>
<hr>
<h4 id="将字符串中的特定单词都替换为另一个单词"><a href="#将字符串中的特定单词都替换为另一个单词" class="headerlink" title="将字符串中的特定单词都替换为另一个单词"></a>将字符串中的特定单词都替换为另一个单词</h4><p><code>replace()</code></p>
<p>例子：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">message <span class="token operator">=</span> <span class="token string">"I really like dogs."</span>
message<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'dog'</span><span class="token punctuation">,</span> <span class="token string">'cat'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<hr>
<h4 id="Python2中的print语句"><a href="#Python2中的print语句" class="headerlink" title="Python2中的print语句"></a>Python2中的print语句</h4><p>例如：<code>print &quot;Hello Python 2.7 world!&quot;</code></p>
<p><strong>无需</strong>将要打印的内容<strong>放在括号内</strong>。从技术上说，Python 3中的print是一个函数，因此括号必不可少。</p>
<hr>
<h3 id="数字"><a href="#数字" class="headerlink" title="数字"></a>数字</h3><h4 id="整数"><a href="#整数" class="headerlink" title="整数"></a>整数</h4><ul>
<li><p>Python用<code>**</code>表示<strong>次方</strong>运算</p>
<p>如<code>3**2</code>的结果为9。</p>
</li>
</ul>
<hr>
<h4 id="浮点数"><a href="#浮点数" class="headerlink" title="浮点数"></a>浮点数</h4><hr>
<h4 id="使用函数str-避免类型错误"><a href="#使用函数str-避免类型错误" class="headerlink" title="使用函数str()避免类型错误"></a>使用函数str()避免类型错误</h4><p><code>str()</code>：<strong>将非字符串值表示为字符串</strong></p>
<hr>
<p>Python允许在数字中间以<code>_</code>分隔，<strong>提高可读性</strong>。</p>
<blockquote>
<p><strong>JDK7</strong>的特性：赋值时，<strong>可以用下划线<code>_</code>分割过长的数字</strong>(<strong>整数&amp;浮点数均可</strong>)，<strong>提高可读性</strong>。</p>
</blockquote>
<hr>
<h3 id="注释"><a href="#注释" class="headerlink" title="注释"></a>注释</h3><p>在Python中，用**井号#**标识注释。</p>
<hr>
<h2 id="列表简介"><a href="#列表简介" class="headerlink" title="列表简介"></a>列表简介</h2><h3 id="列表是什么"><a href="#列表是什么" class="headerlink" title="列表是什么"></a>列表是什么</h3><p>列表由<strong>一系列按特定顺序排列的元素</strong>组成，像一个<strong>栈</strong>。可以创建包含字母表中所有字母、数字、所有家庭成员姓名的列表，也可以加入任何东西，<strong>其中的元素之间可以没有任何关系</strong>。</p>
<p>在Python中，用<strong>方括号[]<strong>表示列表，并用</strong>逗号来分隔</strong>其中的元素。如：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">bicycles <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'trek'</span><span class="token punctuation">,</span> <span class="token string">'cannondale'</span><span class="token punctuation">,</span> <span class="token string">'redline'</span><span class="token punctuation">,</span> <span class="token string">'specialized'</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>bicycles<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>Python会打印列表的<strong>内部表示</strong>，<strong>包括方括号</strong>：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token punctuation">[</span><span class="token string">'trek'</span><span class="token punctuation">,</span> <span class="token string">'cannondale'</span><span class="token punctuation">,</span> <span class="token string">'redline'</span><span class="token punctuation">,</span> <span class="token string">'specialized'</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<hr>
<h4 id="访问列表元素"><a href="#访问列表元素" class="headerlink" title="访问列表元素"></a>访问列表元素</h4><p>如<code>bicycles[0]</code>，请求获取列表元素时，<strong>Python只返回该元素，而不包括方括号和引号</strong>，是<strong>整洁干净的输出</strong>。</p>
<p>还可以对<strong>任何列表元素</strong>调用字符串方法。</p>
<hr>
<h4 id="索引从0开始"><a href="#索引从0开始" class="headerlink" title="索引从0开始"></a>索引从0开始</h4><ul>
<li><p>Python还为<strong>访问最后一个列表元素</strong>提供了一种特数语法：<strong>将索引指定为-1</strong>即可访问最后一个列表元素。<strong>这种约定也适用于其他负数索引</strong>，如**-2<strong>返回</strong>倒数第二个**列表元素，以此类推。</p>
<p>当<strong>列表为空</strong>时，这种<strong>访问最后一个元素的方式会导致错误</strong>。</p>
</li>
</ul>
<hr>
<h4 id="使用列表中的各个值"><a href="#使用列表中的各个值" class="headerlink" title="使用列表中的各个值"></a>使用列表中的各个值</h4><p>可以像使用其他变量一样使用列表中的各个值。</p>
<hr>
<h3 id="修改、添加和删除元素"><a href="#修改、添加和删除元素" class="headerlink" title="修改、添加和删除元素"></a>修改、添加和删除元素</h3><h4 id="修改列表元素"><a href="#修改列表元素" class="headerlink" title="修改列表元素"></a>修改列表元素</h4><p>指定列表名和要修改的元素的索引，再指定该元素的新值即可。如：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">motorcycles <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'honda'</span><span class="token punctuation">,</span> <span class="token string">'yamaha'</span><span class="token punctuation">,</span> <span class="token string">'suzuki'</span><span class="token punctuation">]</span>
motorcycles<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'ducati'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<hr>
<h4 id="在列表中添加元素"><a href="#在列表中添加元素" class="headerlink" title="在列表中添加元素"></a>在列表中添加元素</h4><ul>
<li><p>在列表<strong>末尾添加</strong>元素：使用<code>append()</code>方法</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">motorcycles<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token string">'ducati'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><code>append()</code>方法让<strong>动态地创建列表</strong>易如反掌。</p>
</li>
<li><p>在列表中插入元素：使用<code>insert()</code>方法(需要指定新元素的索引和值)</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">motorcycles<span class="token punctuation">.</span>insert<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">'ducati'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li>
</ul>
<hr>
<h4 id="从列表中删除元素"><a href="#从列表中删除元素" class="headerlink" title="从列表中删除元素"></a>从列表中删除元素</h4><ul>
<li><p>使用<strong>del语句</strong>删除元素</p>
<p><strong>知道要删除的元素在列表中的位置</strong>，可以用del语句。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">del</span> motorcycles<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>删除元素后，其余元素索引会相应发生变动。</p>
</li>
<li><p>使用**方法<code>pop()</code>**删除元素</p>
<p>方法<code>pop()</code>可以删除列表<strong>末尾元素</strong>，并<strong>能让你接着使用它</strong>。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">popped_motorcycle <span class="token operator">=</span> motorcycle<span class="token punctuation">.</span>pop<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>


</li>
<li><p>弹出列表中<strong>任何位置</strong>处的元素</p>
<p>在方法<code>pop()</code>的括号中<strong>指定要删除元素的索引</strong>即可。</p>
<p>first_owned &#x3D; motorcycles.pop(0)</p>
</li>
<li><p>使用<strong>方法<code>remove()</code>根据值删除元素</strong></p>
<p>不知道要从列表中删除的值所处的位置，只知道要删除元素的值是，可以使用<strong>方法<code>remove()</code></strong>。</p>
<p>方法<code>remove()</code><strong>只删除第一个</strong>指定的值。如果要删除的值可能在列表中出现多次，就需要<strong>使用循环来判断是否删除了所有这样的值</strong>。</p>
</li>
</ul>
<hr>
<h3 id="组织列表"><a href="#组织列表" class="headerlink" title="组织列表"></a>组织列表</h3><h4 id="使用方法sort-对列表进行永久性排序"><a href="#使用方法sort-对列表进行永久性排序" class="headerlink" title="使用方法sort()对列表进行永久性排序"></a>使用方法<code>sort()</code>对列表进行永久性排序</h4><ul>
<li>无参数：按<strong>字母顺序</strong>排序</li>
<li>填入参数<code>reverse=True</code>：按<strong>字母逆序</strong>排序</li>
</ul>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">cars <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'bmw'</span><span class="token punctuation">,</span> <span class="token string">'audi'</span><span class="token punctuation">,</span> <span class="token string">'toyota'</span><span class="token punctuation">,</span> <span class="token string">'subaru'</span><span class="token punctuation">]</span>

<span class="token comment"># 按字母顺序排序</span>
cars<span class="token punctuation">.</span>sort<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># 得到结果cars = ['audi', 'bmw', 'subaru', 'toyota']</span>


<span class="token comment"># 按字母逆序排序</span>
cars<span class="token punctuation">.</span>sort<span class="token punctuation">(</span>reverse<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>cars<span class="token punctuation">)</span>
<span class="token comment"># 得到结果cars = ['toyota', 'subaru', 'bmw', 'audi']</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p><strong>并非所有的值都是小写时，按字母顺序排列列表要复杂些</strong>。决定排列顺序时，有多种解读大写字母的方式，要指定准确的排列顺序可能比较复杂。但是大多数排序方式都基于本节介绍的知识。</p>
<hr>
<h4 id="使用函数sorted-对列表进行临时排序"><a href="#使用函数sorted-对列表进行临时排序" class="headerlink" title="使用函数sorted()对列表进行临时排序"></a>使用函数<code>sorted()</code>对列表进行临时排序</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">sorted</span><span class="token punctuation">(</span>cars<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<hr>
<h4 id="反转列表元素"><a href="#反转列表元素" class="headerlink" title="反转列表元素"></a>反转列表元素</h4><ul>
<li><p><code>reverse()</code>方法</p>
<p>注意：与<code>sort(reverse=True)</code>中的reverse作用不同。</p>
</li>
</ul>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">cars<span class="token punctuation">.</span>reverse<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<hr>
<h4 id="确定列表的长度"><a href="#确定列表的长度" class="headerlink" title="确定列表的长度"></a>确定列表的长度</h4><ul>
<li><code>len()</code>方法</li>
</ul>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token builtin">len</span><span class="token punctuation">(</span>cars<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<hr>
<h3 id="使用列表时避免索引错误"><a href="#使用列表时避免索引错误" class="headerlink" title="使用列表时避免索引错误"></a>使用列表时避免索引错误</h3><hr>
<p>错误示例：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">motorcycles <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'honda'</span><span class="token punctuation">,</span> <span class="token string">'yamaha'</span><span class="token punctuation">,</span> <span class="token string">'suzuki'</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>motorcycles<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>即类似其他语言的<strong>数组越界访问</strong>，会引起<strong>索引错误</strong>。</p>
<hr>
<h2 id="操作列表"><a href="#操作列表" class="headerlink" title="操作列表"></a>操作列表</h2><h3 id="遍历整个列表"><a href="#遍历整个列表" class="headerlink" title="遍历整个列表"></a>遍历整个列表</h3><p>语句为<code>for xxx in xxx:</code>（注意<strong>不要遗漏冒号</strong>）</p>
<p>例子：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">magicians <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'alice'</span><span class="token punctuation">,</span> <span class="token string">'david'</span><span class="token punctuation">,</span> <span class="token string">'carolina'</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> magician <span class="token keyword">in</span> magicians<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>magician<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<ul>
<li>编写for循环时，对于用于存储列表中每个值的<strong>临时变量，可指定任何名称</strong>。</li>
<li>Python根据<strong>缩进</strong>来判断<strong>代码行与前一个代码行的关系</strong>。在for循环后面，<strong>没有缩进</strong>的代码就<strong>不是循环的一部分</strong>。</li>
</ul>
<hr>
<h3 id="避免缩进错误"><a href="#避免缩进错误" class="headerlink" title="避免缩进错误"></a>避免缩进错误</h3><ul>
<li>两行独立的代码语句，如果不小心缩进，Python将会报错。</li>
</ul>
<hr>
<h3 id="创建数字列表"><a href="#创建数字列表" class="headerlink" title="创建数字列表"></a>创建数字列表</h3><h4 id="使用函数range"><a href="#使用函数range" class="headerlink" title="使用函数range()"></a>使用函数range()</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">for</span> value <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>打印结果为：</p>
<pre class="line-numbers language-none"><code class="language-none">1
2
3
4<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>即输出范围<strong>左闭右开</strong>。</p>
<p>习题：使用一个for循环打印数字1~20(<strong>含</strong>)</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">for</span> value <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>



<hr>
<h4 id="使用range-创建数字列表"><a href="#使用range-创建数字列表" class="headerlink" title="使用range()创建数字列表"></a>使用range()创建数字列表</h4><ul>
<li>要创建数字列表，可使用函数<code>list()</code>将<code>range()</code>的结果直接转换成列表。</li>
</ul>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">numbers <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># 得到numbers = [1, 2, 3, 4, 5]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<ul>
<li>使用range()函数还可以<strong>指定步长</strong>。</li>
</ul>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">even_numbers <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># 得到numbers = [2, 4, 6, 8, 10]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<ul>
<li>创建包含(1-10)的平方的数字列表</li>
</ul>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">squares <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> value <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    squares<span class="token punctuation">.</span>append<span class="token punctuation">(</span>value<span class="token operator">**</span><span class="token number">2</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<ul>
<li><p>对数字列表执行简单的<strong>统计计算</strong></p>
<ul>
<li><code>min()</code></li>
<li><code>max()</code></li>
<li><code>sum()</code></li>
</ul>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">digits <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span>
<span class="token builtin">min</span><span class="token punctuation">(</span>digits<span class="token punctuation">)</span>
<span class="token builtin">max</span><span class="token punctuation">(</span>digits<span class="token punctuation">)</span>
<span class="token builtin">sum</span><span class="token punctuation">(</span>digits<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></li>
</ul>
<hr>
<h4 id="列表解析"><a href="#列表解析" class="headerlink" title="列表解析"></a>列表解析</h4><p>列表解析将for循环和创建新元素的代码合并成一行，并自动附加新元素。</p>
<p>如创建平方数列表可以写成：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">squares <span class="token operator">=</span> <span class="token punctuation">[</span>value<span class="token operator">**</span><span class="token number">2</span> <span class="token keyword">for</span> value <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>要使用这种语法，首先<strong>指定一个描述性的列表名</strong>，如squares；然后<strong>定义一个表达式</strong>，用于<strong>生成要存储到列表中的值</strong>。</p>
<p>在上述例子中，表达式为<code>value**2</code></p>
<hr>
<h3 id="使用列表的一部分"><a href="#使用列表的一部分" class="headerlink" title="使用列表的一部分"></a>使用列表的一部分</h3><p>Python称<strong>列表的部分元素</strong>为<strong>切片</strong>。</p>
<hr>
<h4 id="切片"><a href="#切片" class="headerlink" title="切片"></a>切片</h4><p>创建切片可指定要使用的<strong>第一个元素的索引</strong>和<strong>最后一个元素的索引+1</strong>(创建范围<strong>左闭右开</strong>)。</p>
<p>如：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">players <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'charles'</span><span class="token punctuation">,</span> <span class="token string">'martina'</span><span class="token punctuation">,</span> <span class="token string">'michael'</span><span class="token punctuation">,</span> <span class="token string">'florence'</span><span class="token punctuation">,</span> <span class="token string">'eli'</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>players<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<ul>
<li><p>如果<strong>没有指定第一个索引</strong>，Python将<strong>自动从列表开头开始</strong>：</p>
<p><code>player[:4]</code></p>
</li>
<li><p>要<strong>让切片终止于列表末尾</strong>，也可通过<strong>省略终止索引</strong>实现。</p>
<p><code>player[2:]</code></p>
</li>
<li><p>如果想输出<strong>最后三名</strong>队员，可通过切片<code>player[-3:]</code>实现</p>
</li>
</ul>
<hr>
<h4 id="遍历切片"><a href="#遍历切片" class="headerlink" title="遍历切片"></a>遍历切片</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">for</span> player <span class="token keyword">in</span> players<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>player<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<hr>
<h4 id="复制列表"><a href="#复制列表" class="headerlink" title="复制列表"></a>复制列表</h4><p>要复制列表，可以通过<strong>同时省略起始索引和终止索引</strong>，<strong>创建一个包含整个列表的切片</strong>。</p>
<p>例如，假设有一个列表，其中包含你最喜欢的三种食品，而你还想创建另外一个列表，其中包含一位朋友喜欢的所有食物。不过你喜欢的视频，这位朋友都喜欢，因此可以通过复制来创建这个列表：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">my_foods <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'pizza'</span><span class="token punctuation">,</span> <span class="token string">'falafel'</span><span class="token punctuation">,</span> <span class="token string">'carrot cake'</span><span class="token punctuation">]</span>
friend_foods <span class="token operator">=</span> my_foods<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">]</span>

<span class="token comment"># 如下直接赋值，无法得到两个独立的列表</span>
friend_foods <span class="token operator">=</span> my_foods<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h3 id="元组"><a href="#元组" class="headerlink" title="元组"></a>元组</h3><p><strong>列表</strong>是<strong>可以修改</strong>的，非常适合用于存储<strong>在程序运行期间可能变化的数据集</strong>。但有时候需要创建一系列<strong>不可修改</strong>的元素，<strong>元组</strong>可以满足这种需求。</p>
<p>Python将<strong>不可变的列表</strong>称为<strong>元组</strong>。</p>
<hr>
<h4 id="定义元组"><a href="#定义元组" class="headerlink" title="定义元组"></a>定义元组</h4><p>元组看起来犹如列表，但<strong>使用圆括号</strong>来标识。</p>
<p>例如有一个大小不应改变的矩形，可将其长宽存储在一个元组中：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">dimensions <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<hr>
<h4 id="遍历元组中的所有值"><a href="#遍历元组中的所有值" class="headerlink" title="遍历元组中的所有值"></a>遍历元组中的所有值</h4><p>同遍历列表相同</p>
<hr>
<h4 id="修改元组变量"><a href="#修改元组变量" class="headerlink" title="修改元组变量"></a>修改元组变量</h4><p>虽然<strong>不能修改元组中的元素</strong>，但<strong>可以给存储元组的变量赋值</strong>。因此如果要修改前述矩形的尺寸，可<strong>重新定义整个元组</strong>：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">dimensions <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span>

<span class="token comment"># 重新定义元组</span>
dimensions <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h3 id="设置代码格式"><a href="#设置代码格式" class="headerlink" title="设置代码格式"></a>设置代码格式</h3><p><strong>PEP</strong>(Python Enhancement Proposal)：<strong>Python改进提案</strong>。</p>
<p>PEP 8是最古老的PEP之一，提供了代码格式设置指南。</p>
<hr>
<h4 id="缩进"><a href="#缩进" class="headerlink" title="缩进"></a>缩进</h4><p>PEP 8建议每级缩进都使用<strong>四个空格</strong>，既提高可读性，又留下了足够的多级缩进空间。</p>
<p>在<strong>字处理文档</strong>中，大家<strong>常常使用 制表符 而不是 空格 来缩进</strong>。对于字处理文档来说，这样做的效果很好，但<strong>混合使用制表符和空格会让Python解释器感到迷惑</strong>。每款文本编辑器都提供了<strong>将输入的制表符转换为指定数量的空格</strong>的设置。在编写代码时应该使用制表符键，但<strong>一定要对编辑器进行设置，使其在文档中插入空格而不是制表符</strong>。</p>
<hr>
<h4 id="行长"><a href="#行长" class="headerlink" title="行长"></a>行长</h4><p>建议<strong>每行不超过80字符</strong>,PEP 8还建议<strong>注释的行长</strong>都<strong>不超过72字符</strong>，因为有些工具为大型项目自动生成文档时，会在每行注释开头添加格式化字符。在大多数编辑器中，都可以设置一个<strong>视觉标志</strong>——通常是一条<strong>垂直参考线</strong>，让我们知道<strong>不能越过的界限</strong>在什么地方。</p>
<hr>
<h2 id="if-语句"><a href="#if-语句" class="headerlink" title="if 语句"></a>if 语句</h2><h3 id="条件测试"><a href="#条件测试" class="headerlink" title="条件测试"></a>条件测试</h3><p><strong>值为True或False的表达式</strong>被称为<strong>条件测试</strong>。</p>
<h4 id="检查是否相等时，大小写的影响"><a href="#检查是否相等时，大小写的影响" class="headerlink" title="检查是否相等时，大小写的影响"></a>检查是否相等时，大小写的影响</h4><ul>
<li><p>在Python中检查是否相等时<strong>区分大小写</strong>，两个<strong>大小写不同的值会被视为不相等</strong>。</p>
</li>
<li><p>如果<strong>大小写无关紧要</strong>，可<strong>将变量的值转换为小写</strong>，再进行比较：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">car <span class="token operator">=</span> <span class="token string">'Audi'</span>
car<span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">'audi'</span>
<span class="token comment"># 结果为True</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></li>
</ul>
<hr>
<h4 id="检查多个条件"><a href="#检查多个条件" class="headerlink" title="检查多个条件"></a>检查多个条件</h4><ul>
<li>使用<strong>and</strong>检查多个条件(Java&#x2F;C&#x2F;C++ 中为 <strong>&amp;&amp;</strong>)</li>
<li>使用<strong>or</strong>检查多个条件(Java&#x2F;C&#x2F;C++ 中为 <strong>||</strong>)</li>
</ul>
<hr>
<h4 id="检查特定值是否包含在列表中"><a href="#检查特定值是否包含在列表中" class="headerlink" title="检查特定值是否包含在列表中"></a>检查特定值是否包含在列表中</h4><p>有时候，执行操作前必须检查列表是否包含特定的值。例如，结束用户的注册过程前，可能需要检查用户名是否已包含在用户名列表中。在地图程序中，可能需要检查用户提交的位置是否包含在已知位置列表中。</p>
<p>要判断特定的值是否已包含在列表中，可使用<strong>关键字in</strong>。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">requested_toppings <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'mushrooms'</span><span class="token punctuation">,</span> <span class="token string">'onions'</span><span class="token punctuation">,</span> <span class="token string">'pineapple'</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'mushrooms'</span> <span class="token keyword">in</span> requested_toppings<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<hr>
<h4 id="检查特定值是否不包含在列表中"><a href="#检查特定值是否不包含在列表中" class="headerlink" title="检查特定值是否不包含在列表中"></a>检查特定值是否不包含在列表中</h4><p>使用关键字<strong>not in</strong>。例如，如果有一个列表，其中包含被禁止在论坛上发表评论的用户，就可在允许用户提交评论前检查他是否被禁言：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">banned_users <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'andrew'</span><span class="token punctuation">,</span> <span class="token string">'carolina'</span><span class="token punctuation">,</span> <span class="token string">'david'</span><span class="token punctuation">]</span>
user <span class="token operator">=</span> <span class="token string">'marie'</span>

<span class="token keyword">if</span> user <span class="token keyword">not</span> <span class="token keyword">in</span> banned_users<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">", you can post a response if you wish."</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h4 id="布尔表达式"><a href="#布尔表达式" class="headerlink" title="布尔表达式"></a>布尔表达式</h4><p>布尔表达式不过是<strong>条件测试的别名</strong>。</p>
<p><strong>布尔值通常用于记录条件</strong>，如游戏是否正在运行，或用户是否可以编辑网站的特定内容：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">game_active <span class="token operator">=</span> <span class="token boolean">True</span>
can_edit <span class="token operator">=</span> <span class="token boolean">False</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<hr>
<h3 id="if语句"><a href="#if语句" class="headerlink" title="if语句"></a>if语句</h3><h4 id="简单的-if-语句"><a href="#简单的-if-语句" class="headerlink" title="简单的 if 语句"></a>简单的 if 语句</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">if</span> conditional_test<span class="token punctuation">:</span>
    do something<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>假设有一个表示某人年龄的变量，而你想知道这个人是否够投票的年龄，可使用如下代码：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">age <span class="token operator">=</span> <span class="token number">19</span>
<span class="token keyword">if</span> age <span class="token operator">>=</span> <span class="token number">18</span><span class="token punctuation">:</span>
	<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"You are old enough to vote!"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<hr>
<h4 id="if-else-语句"><a href="#if-else-语句" class="headerlink" title="if - else 语句"></a>if - else 语句</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python">age <span class="token operator">=</span> <span class="token number">19</span>
<span class="token keyword">if</span> age <span class="token operator">>=</span> <span class="token number">18</span><span class="token punctuation">:</span>
	<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"You are old enough to vote!"</span><span class="token punctuation">)</span>
<span class="token keyword">else</span><span class="token punctuation">:</span>
	<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Sorry, you are too young to vote."</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h4 id="if-elif-else-结构"><a href="#if-elif-else-结构" class="headerlink" title="if - elif - else 结构"></a>if - elif - else 结构</h4><p>在现实世界中，很多情况下需要考虑的情形都超过两个。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">age <span class="token operator">=</span> <span class="token number">12</span>

<span class="token keyword">if</span> age <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">:</span>
    price <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">elif</span> age <span class="token operator">&lt;</span> <span class="token number">18</span><span class="token punctuation">:</span>
    price <span class="token operator">=</span> <span class="token number">5</span>
<span class="token keyword">else</span><span class="token punctuation">:</span>
    price <span class="token operator">=</span> <span class="token number">10</span>
    
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Your admission cost is $"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>price<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"."</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h3 id="使用if语句处理列表"><a href="#使用if语句处理列表" class="headerlink" title="使用if语句处理列表"></a>使用if语句处理列表</h3><h4 id="检查特殊元素"><a href="#检查特殊元素" class="headerlink" title="检查特殊元素"></a>检查特殊元素</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python">requested_toppings <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'mushrooms'</span><span class="token punctuation">.</span> <span class="token string">'green peppers'</span><span class="token punctuation">,</span> <span class="token string">'extra cheese'</span><span class="token punctuation">]</span>

<span class="token keyword">for</span> requested_topping <span class="token keyword">in</span> requested_toppings<span class="token punctuation">:</span>
    <span class="token keyword">if</span> requested_topping <span class="token operator">==</span> <span class="token string">'green peppers'</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Sorry, we are out of green peppers right now."</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Adding "</span> <span class="token operator">+</span> requested_topping <span class="token operator">+</span> <span class="token string">'.'</span><span class="token punctuation">)</span>
        
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\nFinished making your pizza!"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h4 id="确定列表不是空的"><a href="#确定列表不是空的" class="headerlink" title="确定列表不是空的"></a>确定列表不是空的</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python">requested_toppings <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>

<span class="token keyword">if</span> requested_toppings<span class="token punctuation">:</span>
    <span class="token keyword">for</span> requested_topping <span class="token keyword">in</span> requested_toppings<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Adding "</span> <span class="token operator">+</span> requested_topping <span class="token operator">+</span> <span class="token string">'.'</span><span class="token punctuation">)</span>    
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\nFinished making your pizza!"</span><span class="token punctuation">)</span>
<span class="token keyword">else</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Are you sure you want a plain pizza?"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li>在<strong>if语句</strong>中<strong>将 列表名 用在条件表达式中</strong>时，Python将<strong>在列表至少包含一个元素时</strong>返回<strong>True</strong>，并在<strong>列表为空时</strong>返回<strong>False</strong>。</li>
</ul>
<hr>
<h4 id="使用多个列表"><a href="#使用多个列表" class="headerlink" title="使用多个列表"></a>使用多个列表</h4><p>下列示例定义两个列表，其中第一个列表包含<strong>披萨店供应的</strong>配料，第二个列表包含<strong>顾客点的</strong>配料。这次对于顾客要求的每个配料，都检查是否时披萨店供应的配料：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">avaliable_toppings <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'mushrooms'</span><span class="token punctuation">,</span> <span class="token string">'olives'</span><span class="token punctuation">,</span> <span class="token string">'green peppers'</span><span class="token punctuation">,</span>
                     <span class="token string">'pepperoni'</span><span class="token punctuation">,</span> <span class="token string">'pineapple'</span><span class="token punctuation">,</span> <span class="token string">'extra cheese'</span><span class="token punctuation">]</span>
requested_toppings <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'mushrooms'</span><span class="token punctuation">.</span> <span class="token string">'green peppers'</span><span class="token punctuation">,</span> <span class="token string">'extra cheese'</span><span class="token punctuation">]</span>

<span class="token keyword">for</span> requested_topping <span class="token keyword">in</span> requested_toppings<span class="token punctuation">:</span>
    <span class="token keyword">if</span> requested_topping <span class="token keyword">in</span> avaliable_toppings<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Adding "</span> <span class="token operator">+</span> requested_topping <span class="token operator">+</span> <span class="token string">"."</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Sorry, we don't have "</span> <span class="token operator">+</span> requested_topping <span class="token operator">+</span> <span class="token string">"."</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\nFinished making your pizza!"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h2 id="字典"><a href="#字典" class="headerlink" title="字典"></a>字典</h2><ul>
<li><p><strong>列表</strong>：用<strong>方</strong>括号<code>[]</code>标识</p>
</li>
<li><p><strong>元组</strong>：用<strong>圆</strong>括号<code>()</code>标识(<strong>不可修改</strong>)</p>
</li>
<li><p><strong>字典</strong>：用<strong>花</strong>括号<code>&#123;&#125;</code>标识</p>
</li>
</ul>
<hr>
<h3 id="使用字典"><a href="#使用字典" class="headerlink" title="使用字典"></a>使用字典</h3><p>在Python中，<strong>字典</strong>是一系列 <strong>键-值 对</strong>。每个键都与一个值相关联，可以<strong>使用键来访问与之相关联的值</strong>，<strong>可以将任何Python对象用作字典中的值</strong>。</p>
<p><strong>键和值之间</strong>用<strong>冒号</strong><code>:</code>分隔，<strong>键-值对之间</strong>用<strong>逗号</strong>分隔。如：<code>alien_0 = &#123;&#39;color&#39;: &#39;green&#39;, &#39;points&#39;: 5&#125;</code></p>
<hr>
<h4 id="访问字典中的值"><a href="#访问字典中的值" class="headerlink" title="访问字典中的值"></a>访问字典中的值</h4><p>要获取与键相关联的<strong>值</strong>，可依次<strong>指定字典名</strong>和<strong>放在方括号内的键</strong>。</p>
<p>如：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">alien_0 <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">'color'</span><span class="token punctuation">:</span> <span class="token string">'green'</span><span class="token punctuation">,</span> <span class="token string">'points'</span><span class="token punctuation">:</span> <span class="token number">5</span><span class="token punctuation">&#125;</span>
new_points <span class="token operator">=</span> alien_0<span class="token punctuation">[</span><span class="token string">'points'</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<hr>
<h4 id="添加-键-值-对"><a href="#添加-键-值-对" class="headerlink" title="添加 键-值 对"></a>添加 键-值 对</h4><p><strong>字典是一种动态结构</strong>，<strong>可随时添加 键-值 对</strong>。要添加 键-值 对，可依次指定<strong>字典名</strong>、用<strong>方括号括起的键</strong>和<strong>相关联的值</strong>。</p>
<p>如：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">alien_0<span class="token punctuation">[</span><span class="token string">'x_position'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span>
alien_0<span class="token punctuation">[</span><span class="token string">'y_position'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">25</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<ul>
<li>键-值 对的<strong>排列顺序</strong>与<strong>添加顺序</strong>不同。Python<strong>只关心</strong> 键-值 对之间的<strong>关联关系</strong>。</li>
</ul>
<hr>
<h4 id="先创建一个空字典"><a href="#先创建一个空字典" class="headerlink" title="先创建一个空字典"></a>先创建一个空字典</h4><p>可先使用一对<strong>空的花括号</strong>定义一个字典，再<strong>分行添加</strong>各个 键-值 对。</p>
<p><strong>使用字典</strong>来<strong>存储用户提供的数据</strong>或在<strong>编写能自动生成大量 键-值 对的代码</strong>时，通常都需要<strong>先定义一个空字典</strong>。</p>
<hr>
<h4 id="修改字典中的值"><a href="#修改字典中的值" class="headerlink" title="修改字典中的值"></a>修改字典中的值</h4><p>修改字典中的值，可<strong>依次指定字典名</strong>、用方括号括起的<strong>键</strong>以及与该键相关联的<strong>新值</strong>。</p>
<hr>
<h4 id="删除-键-值-对"><a href="#删除-键-值-对" class="headerlink" title="删除 键-值 对"></a>删除 键-值 对</h4><p>对于字典中不再需要的信息，可使用<strong>del语句</strong>将相应的 键-值 对彻底删除。使用del语句时，必须<strong>指定字典名</strong>和<strong>要删除的键</strong>。</p>
<p>如：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">del</span> alien_0<span class="token punctuation">[</span><span class="token string">'points'</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<ul>
<li>删除的 键-值 对<strong>永远消失</strong>了</li>
</ul>
<hr>
<h4 id="由类似对象组成的字典"><a href="#由类似对象组成的字典" class="headerlink" title="由类似对象组成的字典"></a>由类似对象组成的字典</h4><p>字典可以存储<strong>一个对象的多种信息</strong>，也可以存储<strong>众多对象的同一种信息</strong>。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">favorite_languages <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
    <span class="token string">'jen'</span><span class="token punctuation">:</span> <span class="token string">'python'</span><span class="token punctuation">,</span>
    <span class="token string">'sarah'</span><span class="token punctuation">:</span> <span class="token string">'c'</span><span class="token punctuation">,</span>
    <span class="token string">'edward'</span><span class="token punctuation">:</span> <span class="token string">'ruby'</span><span class="token punctuation">,</span>
    <span class="token string">'phil'</span><span class="token punctuation">:</span> <span class="token string">'python'</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h3 id="遍历字典"><a href="#遍历字典" class="headerlink" title="遍历字典"></a>遍历字典</h3><h4 id="遍历所有的-键-值-对"><a href="#遍历所有的-键-值-对" class="headerlink" title="遍历所有的 键-值 对"></a>遍历所有的 键-值 对</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python">user_0 <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
    <span class="token string">'username'</span><span class="token punctuation">:</span> <span class="token string">'efermi'</span><span class="token punctuation">.</span>
    <span class="token string">'first'</span><span class="token punctuation">:</span> <span class="token string">'enrico'</span><span class="token punctuation">,</span>
    <span class="token string">'last'</span><span class="token punctuation">:</span> <span class="token string">'fermi'</span><span class="token punctuation">,</span>
	<span class="token punctuation">&#125;</span>
<span class="token keyword">for</span> key<span class="token punctuation">,</span> value <span class="token keyword">in</span> user_0<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\nKey: "</span> <span class="token operator">+</span> key<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Value: "</span> <span class="token operator">+</span> value<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>如例子所示，要编写用于<strong>遍历字典</strong>的for循环。可声明<strong>两个变量</strong>用于<strong>存储键和值</strong>，这两个变量可以使用任何名称。</p>
<ul>
<li>方法<code>items()</code>返回一个 <strong>键-值 对列表</strong></li>
<li>即使遍历字典时，键-值 对的<strong>返回顺序</strong>也<strong>与存储顺序不同</strong>。</li>
</ul>
<hr>
<h4 id="遍历字典中的所有键"><a href="#遍历字典中的所有键" class="headerlink" title="遍历字典中的所有键"></a>遍历字典中的所有键</h4><ul>
<li><p>方法<code>keys()</code>返回一个<strong>键列表</strong></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">for</span> name <span class="token keyword">in</span> favorite_languages<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>name<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
</li>
<li><p><strong>遍历字典</strong>时，会<strong>默认遍历</strong>所有的<strong>键</strong>。因此<code>for name in favorite_languages.keys():</code>和<code>for name in favorite_languages:</code><strong>效果相同</strong>。</p>
</li>
</ul>
<p>下面遍历一下字典中的名字，但在<strong>名字为指定朋友的名字时</strong>，打印一条消息，指出其喜欢的语言：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">friends <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'phil'</span><span class="token punctuation">,</span> <span class="token string">'sarah'</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> name <span class="token keyword">in</span> favorite_languages<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>name<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> name <span class="token keyword">in</span> friends<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">" Hi "</span> <span class="token operator">+</span> name<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span>
             <span class="token string">", I see your favorite language is "</span> <span class="token operator">+</span>
             favorite_languages<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"!"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li><p>还可以使用keys()确定某个人是否接受了调查：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">if</span> <span class="token string">'erin'</span> <span class="token keyword">not</span> <span class="token keyword">in</span> favorite_languages<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Erin, please take our poll!"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
</li>
<li><p>方法<code>keys()</code><strong>并非只能用于遍历</strong>，实际上，它返回一个包含字典中所有键的列表。</p>
</li>
</ul>
<hr>
<h4 id="按顺序遍历字典中的所有键"><a href="#按顺序遍历字典中的所有键" class="headerlink" title="按顺序遍历字典中的所有键"></a>按顺序遍历字典中的所有键</h4><p>要以<strong>特定的顺序</strong>返回元素，一种办法是在for循环中<strong>对返回的键进行排序</strong>。为此，可以使用函数<code>sorted()</code>(<strong>临时排序</strong>)来获得按特定顺序排列的<strong>键列表的副本</strong>。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">for</span> name <span class="token keyword">in</span> <span class="token builtin">sorted</span><span class="token punctuation">(</span>favorite_languages<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>name<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">", thank you for taking the poll."</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<hr>
<h4 id="遍历字典中的所有值"><a href="#遍历字典中的所有值" class="headerlink" title="遍历字典中的所有值"></a>遍历字典中的所有值</h4><ul>
<li><p>方法<code>values()</code>返回一个<strong>值列表</strong></p>
<p>这种做法提取字典中所有的值，<strong>没有考虑是否重复</strong>。为<strong>剔除重复项</strong>，可使用<strong>集合</strong>(<strong>set</strong>)。(在C&#x2F;C++中，set是一个<strong>内部自动递增排序</strong>且<strong>不含重复元素</strong>的容器)</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">for</span> language <span class="token keyword">in</span> <span class="token builtin">set</span><span class="token punctuation">(</span>favorite_languages<span class="token punctuation">.</span>values<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>language<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li>
</ul>
<hr>
<h3 id="嵌套"><a href="#嵌套" class="headerlink" title="嵌套"></a>嵌套</h3><h4 id="在列表中存储字典"><a href="#在列表中存储字典" class="headerlink" title="在列表中存储字典"></a>在列表中存储字典</h4><p>字典alien_0包含一个外星人的各种信息，但无法存储第二个外星人的信息。如何管理<strong>成群结队的外星人</strong>呢？一种办法是创建一个外星人<strong>列表</strong>，其中每个外星人都是一个<strong>字典</strong>，包含有关该外星人的各种信息(即<strong>字典列表</strong>)。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 创建一个用于存储外星人的空列表</span>
aliens <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>

<span class="token comment"># 创建30个绿色的外星人</span>
<span class="token keyword">for</span> alien_number <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    new_alien <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">'color'</span><span class="token punctuation">:</span> <span class="token string">'green'</span><span class="token punctuation">,</span> <span class="token string">'points'</span><span class="token punctuation">:</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token string">'speed'</span><span class="token punctuation">:</span> <span class="token string">'slow'</span><span class="token punctuation">&#125;</span>
    aliens<span class="token punctuation">.</span>append<span class="token punctuation">(</span>new_alien<span class="token punctuation">)</span>
    
<span class="token comment"># 显示前五个外星人</span>
<span class="token keyword">for</span> alien <span class="token keyword">in</span> aliens<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>alien<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"..."</span><span class="token punctuation">)</span>

<span class="token comment"># 显示创建了多少个外星人</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Total number of aliens: "</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>aliens<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li>获取<strong>列表长度</strong>：函数<code>len(列表名)</code></li>
</ul>
<hr>
<h4 id="在字典中存储列表"><a href="#在字典中存储列表" class="headerlink" title="在字典中存储列表"></a>在字典中存储列表</h4><p>有时候，需要将列表存储在字典中。例如，你要如何描述顾客点的披萨呢？如果使用列表，只能存储要添加的披萨配料；但使用字典，还可以包含其他有关披萨的描述。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">pizza <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
    <span class="token string">'crust'</span><span class="token punctuation">:</span> <span class="token string">'thick'</span><span class="token punctuation">,</span>
    <span class="token string">'toppings'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'mushrooms'</span><span class="token punctuation">,</span> <span class="token string">'extra cheese'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">for</span> topping <span class="token keyword">in</span> pizza<span class="token punctuation">[</span><span class="token string">'topping'</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\t"</span> <span class="token operator">+</span> topping<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li>每当需要在字典中<strong>将一个键关联到多个值</strong>时，都可以<strong>在字典中嵌套一个列表</strong>。</li>
</ul>
<p>在本章前面有关<strong>喜欢的编程语言</strong>的示例中，如果将每个人的回答都存储在一个列表中，被调查者就<strong>可以选择多种喜欢的语言</strong>。因此，在遍历该字典的for循环中，我们需要再使用一个for循环来遍历与被调查者相关联的语言列表：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">favorite_languages <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
    <span class="token string">'jen'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'python'</span><span class="token punctuation">,</span> <span class="token string">'ruby'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'sarah'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'edward'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'ruby'</span><span class="token punctuation">,</span> <span class="token string">'go'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'phil'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'python'</span><span class="token punctuation">,</span> <span class="token string">'haskell'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
	<span class="token punctuation">&#125;</span>

<span class="token keyword">for</span> name<span class="token punctuation">,</span> languages <span class="token keyword">in</span> favorite_languages<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n"</span> <span class="token operator">+</span> name<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">" 's favorite languages are:"</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> language <span class="token keyword">in</span> languages<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\t"</span> <span class="token operator">+</span> language<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h4 id="在字典中存储字典"><a href="#在字典中存储字典" class="headerlink" title="在字典中存储字典"></a>在字典中存储字典</h4><p>可以在字典中嵌套字典，但这样做时，代码可能很快复杂起来。</p>
<hr>
<h3 id="将列表转换为字典"><a href="#将列表转换为字典" class="headerlink" title="将列表转换为字典"></a>将列表转换为字典</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<hr>
<h2 id="用户输入和while循环"><a href="#用户输入和while循环" class="headerlink" title="用户输入和while循环"></a>用户输入和while循环</h2><h3 id="函数input-的工作原理"><a href="#函数input-的工作原理" class="headerlink" title="函数input()的工作原理"></a>函数input()的工作原理</h3><p>函数input()让程序暂停运行，等待用户输入一些<strong>文本</strong>。<strong>获取用户输入后，Python将其存储在一个变量中，Python将用户输入解读为字符串</strong>。</p>
<p>例如，下面的程序让用户输入一些文本，再将这些文本呈现给用户：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">message <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"Tell me something, and I will repeat it back to you: "</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<ul>
<li>函数input()<strong>接受一个参数</strong>，即要向用户显示的<strong>提示或说明</strong>。</li>
<li>程序等待用户输入，并在用户<strong>按回车键后继续运行</strong>。</li>
</ul>
<hr>
<h4 id="编写清晰的程序"><a href="#编写清晰的程序" class="headerlink" title="编写清晰的程序"></a>编写清晰的程序</h4><p>有时候，<strong>提示可能超过一行</strong>，例如，你可能需要指出获取特定输入的原因。这种情况下，可将提示存储再一个变量中，再将该变量传递给函数input()。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">prompt <span class="token operator">=</span> <span class="token string">"If you tell us who you are, we can personalize the messages you see."</span>
prompt <span class="token operator">+=</span> <span class="token string">"\nwhat is your first name? "</span>

name <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span>prompt<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h4 id="使用int-来获取数值输入"><a href="#使用int-来获取数值输入" class="headerlink" title="使用int()来获取数值输入"></a>使用int()来获取数值输入</h4><p>函数<code>int()</code>让Python<strong>将输入视为数值</strong>。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">height <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"How tall are you, in inches? "</span><span class="token punctuation">)</span>
height <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>height<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<hr>
<h4 id="在Python-2-7-中获取输入"><a href="#在Python-2-7-中获取输入" class="headerlink" title="在Python 2.7 中获取输入"></a>在Python 2.7 中获取输入</h4><p>Python 2.7应使用函数<code>raw_input()</code>来提示用户输入，这个函数与Python 3 中的<code>nput()</code>一样，将输入解读为字符串。</p>
<p>Python 2.7 也包含函数<code>input()</code>，但它将用户输入解读为Python代码，并尝试运行它们。因此最好的结果是出现错误，指出Python不明白输入的代码；最糟糕的结果是，将运行原本无意运行的代码。</p>
<hr>
<h3 id="while循环简介"><a href="#while循环简介" class="headerlink" title="while循环简介"></a>while循环简介</h3><h4 id="使用标志"><a href="#使用标志" class="headerlink" title="使用标志"></a>使用标志</h4><p>在要求<strong>很多条件都满足才继续运行</strong>的程序中，可<strong>定义一个变量，用于判断真个程序是否处于活动状态</strong>，这个变量被称为<strong>标志</strong>。这样，在while语句中，<strong>只需检查一个条件</strong>——<strong>while的当前值是否为True</strong>。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">active <span class="token operator">=</span> <span class="token boolean">True</span>
<span class="token keyword">while</span> active<span class="token punctuation">:</span>
    message <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> message <span class="token operator">==</span> <span class="token string">'quit'</span><span class="token punctuation">:</span>
        active <span class="token operator">=</span> false
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h4 id="使用-break-退出循环"><a href="#使用-break-退出循环" class="headerlink" title="使用 break 退出循环"></a>使用 break 退出循环</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
    city <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> city <span class="token operator">==</span> <span class="token string">'quit'</span><span class="token punctuation">:</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"xxxxx"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h4 id="在循环中使用-continue"><a href="#在循环中使用-continue" class="headerlink" title="在循环中使用 continue"></a>在循环中使用 continue</h4><hr>
<h4 id="避免无限循环"><a href="#避免无限循环" class="headerlink" title="避免无限循环"></a>避免无限循环</h4><p>如果程序陷入无限循环，可按<code>Ctrl</code> + <code>C</code>，也可关闭显示程序输出的终端窗口。</p>
<p>有些编辑器(如 Sublime Text)内嵌了输出窗口，这可能导致难以结束无限循环，因此不得不关闭编辑器来结束无限循环。</p>
<hr>
<h3 id="使用-While-循环来处理列表和字典"><a href="#使用-While-循环来处理列表和字典" class="headerlink" title="使用 While 循环来处理列表和字典"></a>使用 While 循环来处理列表和字典</h3><p>for循环是一种遍历列表的有效方式，但<strong>在for循环中不应修改列表，否则将导致Python难以跟踪其中的元素</strong>。要在<strong>遍历列表的同时对其进行修改</strong>，可使用<strong>while循环</strong>。将while循环同列表和字典结合起来使用，可收集、存储并组织大量输入，供以后查看和显示。</p>
<hr>
<h4 id="在列表之间移动元素"><a href="#在列表之间移动元素" class="headerlink" title="在列表之间移动元素"></a>在列表之间移动元素</h4><p>假设一个列表，其中包含新注册但还未验证的网站用户；<strong>验证这些用户后，如何将他们移到另一个已验证用户列表中呢</strong>？一种办法是<strong>使用一个while循环，在验证用户的同时将其从未验证用户列表中提取出来，再将其加入到另一个已验证用户列表中</strong>。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">unconfirmed_users <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'alice'</span><span class="token punctuation">,</span> <span class="token string">'brian'</span><span class="token punctuation">,</span> <span class="token string">'candace'</span><span class="token punctuation">]</span>
confirmed_users <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>

<span class="token comment"># 验证每个用户，直到没有未验证用户为止</span>
<span class="token comment"># 将每个经过验证的用户都移到已验证用户列表中</span>
<span class="token keyword">while</span> unconfirmed_users<span class="token punctuation">:</span>
    current_user <span class="token operator">=</span> unconfirmed_users<span class="token punctuation">.</span>pop<span class="token punctuation">(</span><span class="token punctuation">)</span>
    confirmed_user<span class="token punctuation">.</span>append<span class="token punctuation">(</span>current_user<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li>方法<code>pop()</code>删除列表末尾用户</li>
</ul>
<hr>
<h4 id="删除包含特定值的所有列表元素"><a href="#删除包含特定值的所有列表元素" class="headerlink" title="删除包含特定值的所有列表元素"></a>删除包含特定值的所有列表元素</h4><p>在第3章中，我们使用方法<code>remove()</code>删除列表中的特定值(<strong>只删除第一个</strong>指定的值)。如果要删除列表中所有包含特定值的元素，该怎么办？</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">pets <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'dog'</span><span class="token punctuation">,</span> <span class="token string">'cat'</span><span class="token punctuation">,</span> <span class="token string">'dog'</span><span class="token punctuation">,</span> <span class="token string">'goldfish'</span><span class="token punctuation">,</span> <span class="token string">'cat'</span><span class="token punctuation">,</span> <span class="token string">'rabbit'</span><span class="token punctuation">,</span> <span class="token string">'cat'</span><span class="token punctuation">]</span>

<span class="token keyword">while</span> <span class="token string">'cat'</span> <span class="token keyword">in</span> pets<span class="token punctuation">:</span>
    pets<span class="token punctuation">.</span>remove<span class="token punctuation">(</span><span class="token string">'cat'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h2 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h2><h3 id="现有函数"><a href="#现有函数" class="headerlink" title="现有函数"></a>现有函数</h3><ul>
<li><code>round(number, ndigits=None)</code><ul>
<li><code>number</code>：需要进行四舍五入的数字</li>
<li><code>ndigits</code>： 指定的<strong>位数</strong>，按此位数进行<strong>四舍五入</strong></li>
</ul>
</li>
</ul>
<hr>
<h3 id="定义函数"><a href="#定义函数" class="headerlink" title="定义函数"></a>定义函数</h3><p>下面是一个打印问候语的简单函数：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">greet_user</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""显示简单的问候语"""</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Hello!"</span><span class="token punctuation">)</span>

greet_user<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li>使用<strong>关键字def</strong>告诉Python要<strong>定义一个函数</strong>，定义<strong>以冒号结尾</strong>。</li>
<li>第二行的文本<code>&quot;&quot;&quot;显示简单的问候语&quot;&quot;&quot;</code>是被称为<strong>文档字符串(docstring)<strong>的</strong>注释</strong>。<strong>文档字符串</strong>用<strong>三引号</strong>括起，Python<strong>用它们来生成</strong>有关程序中<strong>函数的文档</strong></li>
</ul>
<hr>
<h4 id="向函数传递信息"><a href="#向函数传递信息" class="headerlink" title="向函数传递信息"></a>向函数传递信息</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">greet_user</span><span class="token punctuation">(</span>username<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""显示简单的问候语"""</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Hello, "</span> <span class="token operator">+</span> username<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"!"</span><span class="token punctuation">)</span>

greet_user<span class="token punctuation">(</span><span class="token string">'jesse'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h4 id="传递实参"><a href="#传递实参" class="headerlink" title="传递实参"></a>传递实参</h4><p>向函数传递实参的方式很多，可使用<strong>位置实参</strong>，这<strong>要求实参的顺序与形参的顺序相同</strong>；也可使用<strong>关键字实参</strong>，其中每个实参都<strong>由形参名和值组成</strong>；还可使用<strong>列表和字典</strong>。</p>
<ul>
<li><p><strong>关键字</strong>实参(顺序无关紧要)</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">describe_pet</span><span class="token punctuation">(</span>animal_type<span class="token punctuation">,</span> pet_name<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""显示宠物的信息"""</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\nI have a "</span> <span class="token operator">+</span> animal_type <span class="token operator">+</span> <span class="token string">"."</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"My "</span> <span class="token operator">+</span> animal_type <span class="token operator">+</span> <span class="token string">"'s name is "</span> <span class="token operator">+</span> pet_name<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"."</span><span class="token punctuation">)</span>
    
describe_pet<span class="token punctuation">(</span>animal_type<span class="token operator">=</span><span class="token string">'hamster'</span><span class="token punctuation">,</span> pet_name <span class="token operator">=</span> <span class="token string">'harry'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ul>
<hr>
<h4 id="默认值"><a href="#默认值" class="headerlink" title="默认值"></a>默认值</h4><p>编写函数时，可<strong>为每个形参指定默认值</strong>，那么在函数调用中就可以省略相应的实参。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">describe_pet</span><span class="token punctuation">(</span>pet_name<span class="token punctuation">,</span> animal_type<span class="token operator">=</span><span class="token string">'dog'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""显示宠物的信息"""</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\nI have a "</span> <span class="token operator">+</span> animal_type <span class="token operator">+</span> <span class="token string">"."</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"My "</span> <span class="token operator">+</span> animal_type <span class="token operator">+</span> <span class="token string">"'s name is "</span> <span class="token operator">+</span> pet_name<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"."</span><span class="token punctuation">)</span>
    
describe_pet<span class="token punctuation">(</span>pet_name<span class="token operator">=</span><span class="token string">'willie'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li><p>由于给animal_type 指定了默认值，因此在函数调用中只包含一个实参——宠物的名字。然而，Python依然将这个实参<strong>视为位置实参</strong>，因此如果函数调用中<strong>只包含宠物的名字，这个实参将关联到函数定义中的第一个形参</strong>，因此<strong>需要将pet_name放在形参列表开头</strong>。这样，就能在函数调用中只提供小狗的名字了：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">describe_pet<span class="token punctuation">(</span><span class="token string">'willie'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li><p>被指定默认值的形参，可以通过<strong>显式地提供实参</strong>来<strong>忽略默认值</strong>。</p>
</li>
</ul>
<hr>
<h3 id="返回值"><a href="#返回值" class="headerlink" title="返回值"></a>返回值</h3><h4 id="返回简单值"><a href="#返回简单值" class="headerlink" title="返回简单值"></a>返回简单值</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">get_formatted_name</span><span class="token punctuation">(</span>first_name<span class="token punctuation">,</span> last_name<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""返回整洁的姓名"""</span>
    full_name <span class="token operator">=</span> first_name <span class="token operator">+</span> <span class="token string">' '</span> <span class="token operator">+</span> last_name
    <span class="token keyword">return</span> full_name<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token punctuation">)</span>

musician <span class="token operator">=</span> get_formatted_name<span class="token punctuation">(</span><span class="token string">'jimi'</span><span class="token punctuation">,</span> <span class="token string">'hendrix'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h4 id="让实参变成可选的"><a href="#让实参变成可选的" class="headerlink" title="让实参变成可选的"></a>让实参变成可选的</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">get_formatted_name</span><span class="token punctuation">(</span>first_name<span class="token punctuation">,</span> last_name<span class="token punctuation">,</span> middle_name<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""返回整洁的姓名"""</span>
    <span class="token keyword">if</span> middle_name<span class="token punctuation">:</span>
        full_name <span class="token operator">=</span> first_name <span class="token operator">+</span> <span class="token string">' '</span> <span class="token operator">+</span> middle_name <span class="token operator">+</span> <span class="token string">' '</span> <span class="token operator">+</span> last_name
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        full_name <span class="token operator">=</span> first_name <span class="token operator">+</span> <span class="token string">' '</span> <span class="token operator">+</span> last_name
    <span class="token keyword">return</span> full_name<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li>Python将<strong>非空字符串</strong>解读为<strong>True</strong></li>
</ul>
<hr>
<h4 id="返回字典"><a href="#返回字典" class="headerlink" title="返回字典"></a>返回字典</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">build_person</span><span class="token punctuation">(</span>first_name<span class="token punctuation">,</span> last_name<span class="token punctuation">,</span> age<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""返回一个字典，其中包含有关一个人的信息"""</span>
    person <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">'first'</span><span class="token punctuation">:</span> first_name<span class="token punctuation">,</span> <span class="token string">'last'</span><span class="token punctuation">:</span> last_name<span class="token punctuation">&#125;</span>
    <span class="token keyword">if</span> age<span class="token punctuation">:</span>
        person<span class="token punctuation">[</span><span class="token string">'age'</span><span class="token punctuation">]</span> <span class="token operator">=</span> age
    <span class="token keyword">return</span> person

musician <span class="token operator">=</span> build_person<span class="token punctuation">(</span><span class="token string">'jimi'</span><span class="token punctuation">,</span> <span class="token string">'hendrix'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h3 id="传递列表"><a href="#传递列表" class="headerlink" title="传递列表"></a>传递列表</h3><p>假设有一个用户列表，我们要问候其中的每位用户。下面的示例将一个名字列表传递给一个名为greet_users()的函数，这个函数问候列表中的每个人：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">greet_users</span><span class="token punctuation">(</span>names<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""向列表中的每位用户都发出简单的问候"""</span>
    <span class="token keyword">for</span> name <span class="token keyword">in</span> names<span class="token punctuation">:</span>
        msg <span class="token operator">=</span> <span class="token string">"Hello, "</span> <span class="token operator">+</span> name<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"!"</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span>
        
usernames <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'hannah'</span><span class="token punctuation">,</span> <span class="token string">'ty'</span><span class="token punctuation">,</span> <span class="token string">'margot'</span><span class="token punctuation">]</span>
greet_users<span class="token punctuation">(</span>usernames<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h4 id="禁止函数修改列表"><a href="#禁止函数修改列表" class="headerlink" title="禁止函数修改列表"></a>禁止函数修改列表</h4><p>为了防止函数修改列表，可<strong>向函数传递列表的副本而不是原件</strong>。</p>
<p>要<strong>将列表的副本传递给函数</strong>，可以像下面这样做：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">function_name<span class="token punctuation">(</span>list_name<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<ul>
<li><strong>切片表示法</strong><code>[:]</code><strong>创建列表的副本</strong></li>
</ul>
<p>虽然像函数传递列表的副本可保留原始列表的内容，但<strong>除非有充分的理由需要传递副本</strong>，<strong>否则还是应该将原始列表传递给函数</strong>。因为让函数<strong>使用现成列表</strong>可<strong>避免花时间和内存创建副本</strong>，从而提高效率，在<strong>处理大型列表</strong>时尤其如此。</p>
<hr>
<h3 id="传递任意数量的实参"><a href="#传递任意数量的实参" class="headerlink" title="传递任意数量的实参"></a>传递任意数量的实参</h3><p>有时候，你预先不知道函数需要接受多少个实参，好在<strong>Python允许函数从调用语句中收集任意数量的实参</strong>。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">make_pizza</span><span class="token punctuation">(</span><span class="token operator">*</span>toppings<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""打印顾客点的所有配料"""</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>toppings<span class="token punctuation">)</span>
    
make_pizza<span class="token punctuation">(</span><span class="token string">'pepperoni'</span><span class="token punctuation">)</span>
make_pizza<span class="token punctuation">(</span><span class="token string">'mushrooms'</span><span class="token punctuation">,</span> <span class="token string">'green peppers'</span><span class="token punctuation">,</span> <span class="token string">'extra cheese'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li>形参名<code>*toppings</code>中的<strong>星号</strong><code>*</code>让Python创建一个名为toppings的<strong>空元组</strong>(用<strong>圆括号</strong><code>()</code>标识，<strong>不可修改</strong>)，并将收到的所有值都封装到这个元组中。</li>
</ul>
<hr>
<h4 id="结合使用位置实参和任意数量实参"><a href="#结合使用位置实参和任意数量实参" class="headerlink" title="结合使用位置实参和任意数量实参"></a>结合使用位置实参和任意数量实参</h4><p>如果要让函数<strong>接受不同类型的实参</strong>，必须在函数定义中<strong>将接纳任意数量实参的形参放在最后</strong>。Python<strong>先匹配位置实参</strong>和<strong>关键字实参</strong>，再<strong>将余下的实参都收集到最后一个形参中</strong>。</p>
<p>例如，如果前面的函数<strong>还需要一个表示披萨尺寸的实参</strong>，<strong>必须</strong>将该形参放在形参<code>*toppings</code><strong>前面</strong>：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">make_pizza</span><span class="token punctuation">(</span>size<span class="token punctuation">,</span> <span class="token operator">*</span>toppings<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""概述要制作的披萨"""</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\nMaking a "</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>size<span class="token punctuation">)</span> <span class="token operator">+</span>
         <span class="token string">"-inch pizza with the following toppings:"</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> topping <span class="token keyword">in</span> toppings<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"- "</span> <span class="token operator">+</span> topping<span class="token punctuation">)</span>
    
make_pizza<span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">,</span> <span class="token string">'pepperoni'</span><span class="token punctuation">)</span>
make_pizza<span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token string">'mushrooms'</span><span class="token punctuation">,</span> <span class="token string">'green peppers'</span><span class="token punctuation">,</span> <span class="token string">'extra cheese'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h4 id="使用任意数量的关键字实参"><a href="#使用任意数量的关键字实参" class="headerlink" title="使用任意数量的关键字实参"></a>使用任意数量的关键字实参</h4><p>有时候，需要接受任意数量的实参，但预先不知道传递给函数的会是什么样的信息。可<strong>将函数编写成能够接受任意数量的 键-值 对</strong>——调用语句提供了多少就接受多少。</p>
<p>一个示例是创建用户简介：你知道将受到有关用户的信息，但不确定是什么样的信息。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">build_profile</span><span class="token punctuation">(</span>first<span class="token punctuation">,</span> last<span class="token punctuation">,</span> <span class="token operator">**</span>user_info<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""创建一个字典，其中包含我们知道的有关用户的一切"""</span>
    profile <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>
    profile<span class="token punctuation">[</span><span class="token string">'first_name'</span><span class="token punctuation">]</span> <span class="token operator">=</span> first
    profile<span class="token punctuation">[</span><span class="token string">'last_name'</span><span class="token punctuation">]</span> <span class="token operator">=</span> last
    <span class="token keyword">for</span> key<span class="token punctuation">,</span> vaule <span class="token keyword">in</span> user_info<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        profile<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> value
    <span class="token keyword">return</span> profile

user_profile <span class="token operator">=</span> build_profile<span class="token punctuation">(</span><span class="token string">'albert'</span><span class="token punctuation">,</span> <span class="token string">'einstein'</span><span class="token punctuation">,</span>
                            location<span class="token operator">=</span><span class="token string">'princeton'</span><span class="token punctuation">,</span>
                            field<span class="token operator">=</span><span class="token string">'physics'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li>形参名<code>**user_info</code>中的<strong>两个星号</strong><code>**</code>让Python创建一个名为user_info的<strong>空字典</strong>(用<strong>花括号</strong><code>&#123;&#125;</code>标识)，并将收到的所有 名称-值 对都封装到这个字典中。</li>
</ul>
<hr>
<h3 id="将函数存储在模块中"><a href="#将函数存储在模块中" class="headerlink" title="将函数存储在模块中"></a>将函数存储在模块中</h3><p>使用函数的优点之一是，使用它们可将代码块与主程序分离。通过给函数指定描述性名称，可让主程序容易理解得多。还可以更进一步，将函数<strong>存储在被称为模块的独立文件中</strong>，<strong>再将模块导入到主程序中</strong>。<strong>import语句</strong>允许<strong>在当前运行的程序文件中使用模块中的代码</strong>。</p>
<h4 id="导入整个模块"><a href="#导入整个模块" class="headerlink" title="导入整个模块"></a>导入整个模块</h4><p>要让函数是<strong>可导入</strong>的，得<strong>先创建模块</strong>。模块是<strong>扩展名为<code>.py</code>的文件</strong>，<strong>包含要导入到程序中的代码</strong>。</p>
<p>下面来<strong>创建一个包含函数<code>make_pizza()</code>的模块</strong>。为此，我们将文件pizza.py中除函数<code>make_pizza()</code>之外的其他代码都删除：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">make_pizza</span><span class="token punctuation">(</span>size<span class="token punctuation">,</span> <span class="token operator">*</span>toppings<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""概述要制作的披萨"""</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\nMaking a "</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>size<span class="token punctuation">)</span> <span class="token operator">+</span>
         <span class="token string">"-inch pizza with the following toppings:"</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> topping <span class="token keyword">in</span> toppings<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"- "</span> <span class="token operator">+</span> topping<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>接下来，我们在<strong>pizza.py所在的目录中</strong>创建另一个名为making_pizzas.py的文件，这个文件<strong>导入到刚创建的模块</strong>，再调用make_pizza()两次：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> pizza

pizza<span class="token punctuation">.</span>make_pizza<span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">,</span> <span class="token string">'pepperoni'</span><span class="token punctuation">)</span>
pizza<span class="token punctuation">.</span>make_pizza<span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token string">'mushrooms'</span><span class="token punctuation">,</span> <span class="token string">'green peppers'</span><span class="token punctuation">,</span> <span class="token string">'extra cheese'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li><p>Python读取这个文件时，代码行<code>import pizza</code>让Python打开pizza.py，并<strong>将其中的所有函数都复制到这个程序中</strong>。</p>
</li>
<li><p><strong>要调用被导入的模块中的函数</strong>，可<strong>指定导入的模块的名称</strong>pizza<strong>和函数名</strong>make_pizza()，<strong>并用句点分隔它们</strong>。如果你使用这种import语句导入了名为module_name.py的整个模块，就可使用下面的语法来使用其中任何一个函数：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">module_name<span class="token punctuation">.</span>function_name<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li>
</ul>
<hr>
<h4 id="导入特定的函数"><a href="#导入特定的函数" class="headerlink" title="导入特定的函数"></a>导入特定的函数</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> module_name <span class="token keyword">import</span> function_0<span class="token punctuation">,</span> function_1<span class="token punctuation">,</span> function_2<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<ul>
<li><strong>通过逗号分隔函数名</strong>，可根据需要从模块中<strong>导入任意数量的函数</strong></li>
<li>使用这种语法，<strong>调用函数时就无需使用句点</strong></li>
</ul>
<hr>
<h4 id="使用-as-给函数指定别名"><a href="#使用-as-给函数指定别名" class="headerlink" title="使用 as 给函数指定别名"></a>使用 as 给函数指定别名</h4><p>要给函数指定别名，需要<strong>在导入时</strong>这样做。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> module_name <span class="token keyword">import</span> function_name <span class="token keyword">as</span> fn<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<ul>
<li>上面的语句将函数<code>function_name()</code>重命名为<code>fn()</code></li>
</ul>
<hr>
<h4 id="使用-as-给模块指定别名"><a href="#使用-as-给模块指定别名" class="headerlink" title="使用 as 给模块指定别名"></a>使用 as 给模块指定别名</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> module_name <span class="token keyword">as</span> mn<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<hr>
<h4 id="导入模块中的所有函数"><a href="#导入模块中的所有函数" class="headerlink" title="导入模块中的所有函数"></a>导入模块中的所有函数</h4><p>使用<strong>星号<code>*</code><strong>运算符可让Python导入模块中的</strong>所有函数</strong>。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> pizza <span class="token keyword">import</span> <span class="token operator">*</span>

make_pizza<span class="token punctuation">(</span><span class="token number">16</span> <span class="token string">'pepperoni'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p><strong>import语句中的星号</strong>让Python将模块pizza中的<strong>每个函数</strong>都复制到这个文件中。由于导入了每个函数，可通过名称来调用每个函数，而无需使用句点表示法。然而，使用<strong>并非自己编写的大型模块</strong>时，<strong>最好不要采用这种导入方法</strong>：Python可能遇到多个名称相同的函数或变量，进而<strong>覆盖函数</strong>，而不是分别导入所有的函数。</p>
<p>最佳的做法是，要么<strong>只导入需要使用的函数</strong>，要么<strong>导入整个模块并使用句点表示法</strong>，这能让代码更清晰，更容易阅读和理解。</p>
<hr>
<h3 id="函数编写指南"><a href="#函数编写指南" class="headerlink" title="函数编写指南"></a>函数编写指南</h3><ol>
<li><p>给函数指定<strong>描述性名称</strong>，且<strong>只使用小写字母</strong>和<strong>下划线</strong>。</p>
</li>
<li><p>每个函数都应包含简要地阐述其功能的注释，该<strong>注释应紧跟在函数定义后面</strong>，并采用<strong>文档字符串格式</strong>。</p>
</li>
<li><p><strong>给形参指定认值</strong>时，<strong>等号两边不要有空格</strong></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">function_name</span><span class="token punctuation">(</span>parameter_0<span class="token punctuation">,</span> parameter_1<span class="token operator">=</span><span class="token string">'default value'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li><p>对于<strong>函数调用中的关键字实参</strong>，<strong>等号两边不要有空格</strong></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">function_name<span class="token punctuation">(</span>value_0<span class="token punctuation">,</span> parameter_1<span class="token operator">=</span><span class="token string">'value'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li><p>如果<strong>形参很多</strong>，导致函数定义的长度超过了79字符，可在函数定义中<strong>输入左括号后按回车键</strong>，并在下一行<strong>按两次</strong>Tab键，从而<strong>将形参列表和只缩进一层的函数体区分开来</strong></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">function_name</span><span class="token punctuation">(</span>
		parameter_0<span class="token punctuation">,</span> parameter_1<span class="token punctuation">,</span> parameter_2<span class="token punctuation">,</span>
		parameter_3<span class="token punctuation">,</span> parameter_4<span class="token punctuation">,</span> parameter_5<span class="token punctuation">)</span><span class="token punctuation">:</span>
    function body<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>如果<strong>程序或模块包含多个函数</strong>，可使用<strong>两个空行</strong>将相邻的函数分开，这样更容易知道前一个函数在什么地方结束，下一个函数从什么地方开始。</p>
</li>
</ol>
<hr>
<h3 id="高阶函数"><a href="#高阶函数" class="headerlink" title="高阶函数"></a>高阶函数</h3><ul>
<li><p><code>range()</code> 还可指定步长</p>
</li>
<li><p><code>map()</code></p>
  <pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">func</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> x<span class="token operator">*</span>x

<span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">map</span><span class="token punctuation">(</span>func<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># 效果等价于 [i**2 for i in range(1, 6)]</span>


a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span>
<span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">,</span> <span class="token builtin">map</span><span class="token punctuation">(</span>func<span class="token punctuation">,</span> a<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># 结果为 ['1', '4', '9', '16', '25']</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ul>
<hr>
<h3 id="匿名函数"><a href="#匿名函数" class="headerlink" title="匿名函数"></a>匿名函数</h3><p>使用<code>lambda</code></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">lambda</span> x<span class="token punctuation">:</span>x<span class="token operator">*</span>x<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><strong>输入</strong>为x，<strong>输出</strong>为<code>x*x</code></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 避免显式构造函数func，简约</span>
<span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span>x<span class="token operator">*</span>x<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span><span class="token string">'char is:'</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># 结果为 ['char is:1', 'char is:2', 'char is:3' ...]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h2 id="第三方包"><a href="#第三方包" class="headerlink" title="第三方包"></a>第三方包</h2><ul>
<li>collections</li>
</ul>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> collections
a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>collections<span class="token punctuation">.</span>Counter<span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># 输出：Counter(&#123;1: 3, 2: 3, 3: 1, 31: 1&#125;)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li>csv</li>
<li>datetime</li>
<li>math</li>
<li>pandas</li>
<li>numpy</li>
</ul>
<hr>
<h2 id="类"><a href="#类" class="headerlink" title="类"></a>类</h2><h3 id="创建和使用类"><a href="#创建和使用类" class="headerlink" title="创建和使用类"></a>创建和使用类</h3><h4 id="创建-Dog-类"><a href="#创建-Dog-类" class="headerlink" title="创建 Dog 类"></a>创建 Dog 类</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">Dog</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""一次模拟小狗的简单尝试"""</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> name<span class="token punctuation">,</span> age<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""初始化属性name和age"""</span>
        self<span class="token punctuation">.</span>name <span class="token operator">=</span> name
        self<span class="token punctuation">.</span>age <span class="token operator">=</span> age
        
    <span class="token keyword">def</span> <span class="token function">sit</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""模拟小狗被命令蹲下"""</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>name<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">" is now sitting."</span><span class="token punctuation">)</span>
        
    <span class="token keyword">def</span> <span class="token function">roll_over</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""模拟小狗被命令时打滚"""</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>name<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">" rolled over!"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li>根据约定，Python中<strong>首字母大写</strong>的名称指的是<strong>类</strong>。这个<strong>类定义中的括号是空的</strong>，因为我们<strong>要从空白创建这个类</strong>。</li>
</ul>
<ol>
<li><p>方法<code>__init__()</code></p>
<ul>
<li><p><strong>类中的函数</strong>称为<strong>方法</strong>。就目前而言，函数和方法唯一重要的差别是<strong>调用方法的方式</strong>。</p>
</li>
<li><p>上例中的方法<code>__init__()</code>是一个<strong>特殊</strong>的方法，<strong>每当根据Dog类创建新实例时，Python都会自动运行它</strong>。</p>
</li>
<li><p>在这个方法名称中，开头和末尾各有<strong>两个下划线</strong>，<strong>这是一种约定</strong>，旨在<strong>避免Python默认方法与普通方法发生名称冲突</strong>。</p>
</li>
<li><p>这个方法的定义中，形参<code>self</code><strong>必不可少</strong>，还<strong>必须位于其他形参的前面</strong>。</p>
<p>为何必须在方法定义中包含形参<code>self</code>呢？因为Python调用这个<code>__init__()</code>方法将<strong>自动传入实参<code>self</code></strong>。<strong>每个与类相关联的方法调用都自动传递实参<code>self</code></strong>，它是一个<strong>指向实例本身的引用</strong>，<strong>让实例能够访问类中的属性和方法</strong>。</p>
<p>我们创建Dog实例时，Python将调用Dog类的方法<code>__init__()</code>。我们将<strong>通过实参向<code>Dog()</code>传递name和age，self会自动传递</strong>。</p>
</li>
<li><p>以<code>self</code><strong>为前缀</strong>的变量都<strong>可供类中的所有方法使用</strong>，我们<strong>还可以通过类的任何实例来访问这些变量</strong>。</p>
<p><code>self.name = name</code>获取存储在形参name中的值，并将其存储到变量name中，然后<strong>该变量被关联到当前创建的实例</strong>。</p>
<p>像这样<strong>可以通过实例访问的变量</strong>称为<strong>属性</strong>。</p>
</li>
<li><p><code>sit()</code>和<code>roll_over()</code>方法<strong>不需要额外的信息，因此它们只有一个形参self</strong>。</p>
</li>
</ul>
</li>
<li><p>在 Python 2.7 中创建类</p>
<p>在 Python 2.7 中创建类时，需要做细微的修改——在括号内包含单词object：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">ClassName</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li>
</ol>
<hr>
<h4 id="根据类创建实例"><a href="#根据类创建实例" class="headerlink" title="根据类创建实例"></a>根据类创建实例</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python">my_dog <span class="token operator">=</span> Dog<span class="token punctuation">(</span><span class="token string">'willie'</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>遇到上述代码时，Python使用实参<code>willie</code>和6调用Dog类中的方法<code>__init__()</code>。方法<code>__init__()</code><strong>并未显式地包含return语句，但Python自动返回一个表示这条小狗的实例</strong>。在这里，<strong>命名约定很有用</strong>：我们通常可以认为<strong>首字母大写的名称</strong>指的是<strong>类</strong>，<strong>小写的名称</strong>指的是<strong>根据类创建的实例</strong>。</p>
<ol>
<li><p>访问属性</p>
<p><code>my_dog.name</code>，在Dog类中引用这个属性使用的是<code>self.name</code></p>
</li>
<li><p>调用方法</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">my_dog<span class="token punctuation">.</span>sit<span class="token punctuation">(</span><span class="token punctuation">)</span>
my_dog<span class="token punctuation">.</span>roll_over<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li>
</ol>
<hr>
<h3 id="使用类和实例"><a href="#使用类和实例" class="headerlink" title="使用类和实例"></a>使用类和实例</h3><h4 id="Car-类"><a href="#Car-类" class="headerlink" title="Car 类"></a>Car 类</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">Car</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""一次模拟汽车的简单尝试"""</span>
    
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> make<span class="token punctuation">,</span> model<span class="token punctuation">,</span> year<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""初始化描述汽车的属性"""</span>
        self<span class="token punctuation">.</span>make <span class="token operator">=</span> make
        self<span class="token punctuation">.</span>model <span class="token operator">=</span> model
        self<span class="token punctuation">.</span>year <span class="token operator">=</span> year
        
    <span class="token keyword">def</span> <span class="token function">get_descriptive_name</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""返回整洁的描述性信息"""</span>
        long_name <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>year<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">' '</span> <span class="token operator">+</span> self<span class="token punctuation">.</span>make <span class="token operator">+</span> <span class="token string">' '</span> <span class="token operator">+</span> self<span class="token punctuation">.</span>model
        <span class="token keyword">return</span> long_name<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
my_new_car <span class="token operator">=</span> Car<span class="token punctuation">(</span><span class="token string">'audi'</span><span class="token punctuation">,</span> <span class="token string">'a4'</span><span class="token punctuation">,</span> <span class="token number">2016</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>my_new_car<span class="token punctuation">.</span>get_descriptive_name<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>运行结果：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token number">2016</span> Audi A4<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<hr>
<h4 id="给属性指定默认值"><a href="#给属性指定默认值" class="headerlink" title="给属性指定默认值"></a>给属性指定默认值</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">Car</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> make<span class="token punctuation">,</span> model<span class="token punctuation">,</span> year<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""初始化描述汽车的属性"""</span>
        self<span class="token punctuation">.</span>make <span class="token operator">=</span> make
        self<span class="token punctuation">.</span>model <span class="token operator">=</span> model
        self<span class="token punctuation">.</span>year <span class="token operator">=</span> year
        self<span class="token punctuation">.</span>odometer_reading <span class="token operator">=</span> <span class="token number">0</span>
        
    <span class="token keyword">def</span> <span class="token function">get_descriptive_name</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token operator">-</span><span class="token operator">-</span>snip<span class="token operator">-</span><span class="token operator">-</span>
        
    <span class="token keyword">def</span> <span class="token function">read_odometer</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""打印一条指出汽车里程的消息"""</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"This car has "</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>odometer_reading<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">" miles on it."</span><span class="token punctuation">)</span>
    
my_new_car <span class="token operator">=</span> Car<span class="token punctuation">(</span><span class="token string">'audi'</span><span class="token punctuation">,</span> <span class="token string">'a4'</span><span class="token punctuation">,</span> <span class="token number">2016</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>my_new_car<span class="token punctuation">.</span>get_descriptive_name<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
my_new_car<span class="token punctuation">.</span>read_odometer<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h4 id="修改属性的值"><a href="#修改属性的值" class="headerlink" title="修改属性的值"></a>修改属性的值</h4><ol>
<li><p><strong>直接修改</strong>属性的值</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">my_new_car<span class="token punctuation">.</span>odometer_reading <span class="token operator">=</span> <span class="token number">23</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li><p><strong>通过方法修改</strong>属性的值</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">Car</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token operator">-</span><span class="token operator">-</span>snip<span class="token operator">-</span><span class="token operator">-</span>
    
    <span class="token keyword">def</span> <span class="token function">update_odometer</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> mileage<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""将里程表读数设置为指定的值"""</span>
        self<span class="token punctuation">.</span>odometer_reading <span class="token operator">=</span> mileage
    
my_new_car <span class="token operator">=</span> Car<span class="token punctuation">(</span><span class="token string">'audi'</span><span class="token punctuation">,</span> <span class="token string">'a4'</span><span class="token punctuation">,</span> <span class="token number">2016</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>my_new_car<span class="token punctuation">.</span>get_descriptive_name<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

my_new_car<span class="token punctuation">.</span>update_odometer<span class="token punctuation">(</span><span class="token number">23</span><span class="token punctuation">)</span>
my_new_car<span class="token punctuation">.</span>read_odometer<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>可对方法<code>update_odometer()</code>进行扩展，<strong>禁止任何人将里程表读数往回调</strong>：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">Car</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token operator">-</span><span class="token operator">-</span>snip<span class="token operator">-</span><span class="token operator">-</span>
    
    <span class="token keyword">def</span> <span class="token function">update_odometer</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> mileage<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""
        将里程表读数设置为指定的值
        禁止将里程表读数往回调
        """</span>
        <span class="token keyword">if</span> mileage <span class="token operator">>=</span> self<span class="token punctuation">.</span>odometer_reading<span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>odometer_reading <span class="token operator">=</span> mileage
        <span class="token keyword">else</span><span class="token punctuation">:</span>
        	<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"You can't roll back an odometer!"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li><p><strong>通过方法</strong>对属性的值进行<strong>递增</strong></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">Car</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token operator">-</span><span class="token operator">-</span>snip<span class="token operator">-</span><span class="token operator">-</span>
    
    <span class="token keyword">def</span> <span class="token function">update_odometer</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> mileage<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token operator">-</span><span class="token operator">-</span>snip<span class="token operator">-</span><span class="token operator">-</span>
    
    <span class="token keyword">def</span> <span class="token function">increment_odometer</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> miles<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""将里程表读数增加指定的量"""</span>
        self<span class="token punctuation">.</span>odometer_reading<span class="token operator">+=</span> miles<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ol>
<hr>
<h3 id="继承"><a href="#继承" class="headerlink" title="继承"></a>继承</h3><p>一个类<strong>继承</strong>另一个类时，它将自动获得另一个类的<strong>所有属性和方法</strong>。原有的类称为<strong>父类</strong>，新类称为<strong>子类</strong>。子类同时还可以<strong>定义自己的属性和方法</strong>。</p>
<h4 id="子类的方法-init"><a href="#子类的方法-init" class="headerlink" title="子类的方法__init__()"></a>子类的方法<code>__init__()</code></h4><p>创建子类的实例时，Python<strong>首先需要给父类的所有属性赋值</strong>，为此，子类的方法<code>__init__()</code><strong>需要父类施以援手</strong>。</p>
<p>下面来创建一个简单的ElectricCar类版本，它<strong>具备Car类的所有功能</strong>：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">ElectricCar</span><span class="token punctuation">(</span>Car<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""电动汽车的独特之处"""</span>
    
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> make<span class="token punctuation">,</span> model<span class="token punctuation">,</span> year<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""初始化父类的属性"""</span>
        <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span>make<span class="token punctuation">,</span> model<span class="token punctuation">,</span> year<span class="token punctuation">)</span>
        
my_tesla <span class="token operator">=</span> ElectricCar<span class="token punctuation">(</span><span class="token string">'tesla'</span><span class="token punctuation">,</span> <span class="token string">'model s'</span><span class="token punctuation">,</span> <span class="token number">2016</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>my_tesla<span class="token punctuation">.</span>get_descriptive_name<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li>创建子类时，<strong>父类必须包含在当前文件中，且位于子类前面</strong>。</li>
<li>定义子类时，<strong>必须在括号内指定父类的名称</strong>。</li>
<li><code>super()</code>是一个特殊函数，帮助Python<strong>将父类和子类关联起来</strong>。<strong>父类</strong>也称为<strong>超类</strong>(<strong>superclass</strong>)，名称super因此而得名。</li>
</ul>
<hr>
<h4 id="Python-2-7-中的继承"><a href="#Python-2-7-中的继承" class="headerlink" title="Python 2.7 中的继承"></a>Python 2.7 中的继承</h4><p>在Python 2.7 中，继承语法稍有不同。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 在 Python 2.7 中创建类时，需要在括号内包含单词object</span>
<span class="token keyword">class</span> <span class="token class-name">Car</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> make<span class="token punctuation">,</span> model<span class="token punctuation">,</span> year<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token operator">-</span><span class="token operator">-</span>snip<span class="token operator">-</span><span class="token operator">-</span>
        
<span class="token keyword">class</span> <span class="token class-name">ElectricCar</span><span class="token punctuation">(</span>Car<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> make<span class="token punctuation">,</span> model<span class="token punctuation">,</span> year<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token builtin">super</span><span class="token punctuation">(</span>ElectricCar<span class="token punctuation">,</span> self<span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span>make<span class="token punctuation">,</span> model<span class="token punctuation">,</span> year<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li>函数<code>super()</code>需要两个实参：子类名和对象self。</li>
</ul>
<hr>
<h4 id="给子类定义属性和方法"><a href="#给子类定义属性和方法" class="headerlink" title="给子类定义属性和方法"></a>给子类定义属性和方法</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">ElectricCar</span><span class="token punctuation">(</span>Car<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""电动汽车的独特之处"""</span>
    
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> make<span class="token punctuation">,</span> model<span class="token punctuation">,</span> year<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""
        电动汽车的独特之处
        初始化父类的属性，再初始化电动汽车特有的属性
        """</span>
        <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span>make<span class="token punctuation">,</span> model<span class="token punctuation">,</span> year<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>battery_size <span class="token operator">=</span> <span class="token number">70</span>
        
    <span class="token keyword">def</span> <span class="token function">describe_battery</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""打印一条描述电瓶容量的消息"""</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"This car has a "</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>battery_size<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"-kwh battery."</span><span class="token punctuation">)</span>
        
my_tesla <span class="token operator">=</span> ElectricCar<span class="token punctuation">(</span><span class="token string">'tesla'</span><span class="token punctuation">,</span> <span class="token string">'model s'</span><span class="token punctuation">,</span> <span class="token number">2016</span><span class="token punctuation">)</span>
my_tesla<span class="token punctuation">.</span>describe_battery<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h4 id="重写父类的方法"><a href="#重写父类的方法" class="headerlink" title="重写父类的方法"></a>重写父类的方法</h4><p>对于父类的方法，只要它<strong>不符合子类模拟的实物的行为</strong>，<strong>都可对其进行重写</strong>。为此，可在子类中<strong>定义一个与要重写的父类方法同名的方法</strong>。</p>
<p>假设Car类有一个名为<code>fill_gas_tank()</code>的方法，它对全电动汽车来说毫无意义。下面演示一种重写方式：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">ElectricCar</span><span class="token punctuation">(</span>Car<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token operator">-</span><span class="token operator">-</span>snip<span class="token operator">-</span><span class="token operator">-</span>
    
    <span class="token keyword">def</span> <span class="token function">fill_gas_tank</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""电动汽车没有油箱"""</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"This car doesn't need a gas tank!"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>使用继承时，可让子类保留从父类继承而来的精华，并剔除不需要的糟粕。</p>
<hr>
<h4 id="将实例用作属性"><a href="#将实例用作属性" class="headerlink" title="将实例用作属性"></a>将实例用作属性</h4><p>使用代码模拟实物时，可能会发现给类添加的细节越来越多：<strong>属性</strong>和<strong>方法清单</strong>以及<strong>文件</strong>都<strong>越来越长</strong>。这种情况下，可能需要将类的一部分作为一个独立的类提取出来，将大型类拆分称多个协同工作的小类。</p>
<p>例如，不断给ElectricCar类添加细节时，我们可能会发现其中包含很多<strong>专门针对汽车电瓶的属性和方法</strong>。可以将这些属性和方法提取出来，放到另一个名为Battery的类中，并<strong>将一个Battery实例用作ElectricCar类的一个属性</strong>：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">Car</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token operator">-</span><span class="token operator">-</span>snip<span class="token operator">-</span><span class="token operator">-</span>
    
<span class="token keyword">class</span> <span class="token class-name">Battery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""一次模拟电动汽车电瓶的简单尝试"""</span>
    
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> battery_size<span class="token operator">=</span><span class="token number">70</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""初始化电瓶的属性"""</span>
        self<span class="token punctuation">.</span>battery_size <span class="token operator">=</span> battery_size
        
    <span class="token keyword">def</span> <span class="token function">describe_battery</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""打印一条描述电瓶容量的消息"""</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"This car has a "</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>battery_size<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"-kwh battery."</span><span class="token punctuation">)</span>
        
<span class="token keyword">class</span> <span class="token class-name">ElectricCar</span><span class="token punctuation">(</span>Car<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""电动汽车的独特之处"""</span>
    
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> make<span class="token punctuation">,</span> model<span class="token punctuation">,</span> year<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""
        初始化父类的属性，再初始化电动汽车特有的属性
        """</span>
        <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span>make<span class="token punctuation">,</span> model<span class="token punctuation">,</span> year<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>battery <span class="token operator">=</span> Battery<span class="token punctuation">(</span><span class="token punctuation">)</span>
        
my_tesla <span class="token operator">=</span> ElectricCar<span class="token punctuation">(</span><span class="token string">'tesla'</span><span class="token punctuation">,</span> <span class="token string">'model s'</span><span class="token punctuation">,</span> <span class="token number">2016</span><span class="token punctuation">)</span>
my_tesla<span class="token punctuation">.</span>battery<span class="token punctuation">.</span>describe_battery<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>这看似做了很多额外的工作，但现在我们想多详细地描述电瓶都可以，且<strong>不会导致ElectricCar类混乱不堪</strong>。</p>
<hr>
<h3 id="导入类"><a href="#导入类" class="headerlink" title="导入类"></a>导入类</h3><p>Python允许<strong>将类存储在模块中</strong>，然后在主程序中<strong>导入所需的模块</strong>(模块是<strong>扩展名为<code>.py</code>的文件</strong>，<strong>包含要导入到程序中的代码</strong>)。</p>
<h4 id="导入单个类"><a href="#导入单个类" class="headerlink" title="导入单个类"></a>导入单个类</h4><p>下面是<strong>模块car.py</strong>，其中只包含Car类的代码：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token triple-quoted-string string">"""一个可用于表示汽车的类"""</span>

<span class="token keyword">class</span> <span class="token class-name">Car</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""一次模仿汽车的简单尝试"""</span>
    
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> make<span class="token punctuation">,</span> model<span class="token punctuation">,</span> year<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""初始化描述汽车的属性"""</span>
        self<span class="token punctuation">.</span>make <span class="token operator">=</span> make
        self<span class="token punctuation">.</span>model <span class="token operator">=</span> model
        self<span class="token punctuation">.</span>year <span class="token operator">=</span> year
        self<span class="token punctuation">.</span>odometer_reading <span class="token operator">=</span> <span class="token number">0</span>
        
    <span class="token keyword">def</span> <span class="token function">get_descriptive_name</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""返回整洁的描述性名称"""</span>
        long_name <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>year<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">' '</span> <span class="token operator">+</span> self<span class="token punctuation">.</span>make <span class="token operator">+</span> <span class="token string">' '</span> <span class="token operator">+</span> self<span class="token punctuation">.</span>model
        <span class="token keyword">return</span> long_name<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    <span class="token keyword">def</span> <span class="token function">read_odometer</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""打印一条消息，指出汽车的里程"""</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"This car has "</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>odometer_reading<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">" miles on it."</span><span class="token punctuation">)</span>
        
    <span class="token keyword">def</span> <span class="token function">update_odometer</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span> mileage<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""
        将里程表读数设置为指定的值
        拒绝将历程表往回拨
        """</span>
        <span class="token keyword">if</span> mileage <span class="token operator">>=</span> self<span class="token punctuation">.</span>odometer_reading<span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>odometer_reading <span class="token operator">=</span> mileage
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"You can't roll back an odometer!"</span><span class="token punctuation">)</span>
            
    <span class="token keyword">def</span> <span class="token function">increment_odometer</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> miles<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""将里程表读数增加指定的量"""</span>
        self<span class="token punctuation">.</span>odometer_reading <span class="token operator">+=</span> miles<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>下面创建另一个文件——<strong>my_car.py</strong>，在其中<strong>导入Car类并创建其实例</strong>：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> car <span class="token keyword">import</span> Car

my_new_car <span class="token operator">=</span> Car<span class="token punctuation">(</span><span class="token string">'audi'</span><span class="token punctuation">,</span> <span class="token string">'a4'</span><span class="token punctuation">,</span> <span class="token number">2016</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>my_new_car<span class="token punctuation">.</span>get_descriptive_name<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

my_new_car<span class="token punctuation">.</span>odometer_reading <span class="token operator">=</span> <span class="token number">23</span>
my_new_car<span class="token punctuation">.</span>reading_odometer<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>导入类是一种有效的编程方式，<strong>让大部分逻辑存储在独立的文件中</strong>，<strong>使主程序文件变得整洁而易于阅读</strong>。</p>
<hr>
<h4 id="在一个模块中存储多个类"><a href="#在一个模块中存储多个类" class="headerlink" title="在一个模块中存储多个类"></a>在一个模块中存储多个类</h4><p>虽然同一个模块中的类之间应存在某种相关性，但可根据需要在一个模块中存储任意数量的类。</p>
<p>类Battery和ElectricCar都可以帮助模拟汽车，因此可以将其加入模块car.py中。</p>
<hr>
<h4 id="从一个模块中导入多个类"><a href="#从一个模块中导入多个类" class="headerlink" title="从一个模块中导入多个类"></a>从一个模块中导入多个类</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> car <span class="token keyword">import</span> Car<span class="token punctuation">,</span> ElectricCar<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<ul>
<li>从一个模块中导入多个类时，<strong>用逗号分隔各个类</strong>。</li>
</ul>
<hr>
<h4 id="导入整个模块-1"><a href="#导入整个模块-1" class="headerlink" title="导入整个模块"></a>导入整个模块</h4><p>可以导入整个模块，再<strong>使用句点表示法访问需要的类</strong>。这中导入方法很简单，代码也易于阅读。<strong>由于创建类实例的代码都包含模块名，因此不会与当前文件使用的任何名称发生冲突</strong>。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> car

my_beetle <span class="token operator">=</span> car<span class="token punctuation">.</span>Car<span class="token punctuation">(</span><span class="token string">'volkswagen'</span><span class="token punctuation">,</span> <span class="token string">'beetle'</span><span class="token punctuation">,</span> <span class="token number">2016</span><span class="token punctuation">)</span>

my_tesla <span class="token operator">=</span> car<span class="token punctuation">.</span>ElectricCar<span class="token punctuation">(</span><span class="token string">'tesla'</span><span class="token punctuation">,</span> <span class="token string">'roadster'</span><span class="token punctuation">,</span> <span class="token number">2016</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h4 id="导入模块中的所有类"><a href="#导入模块中的所有类" class="headerlink" title="导入模块中的所有类"></a>导入模块中的所有类</h4><p>要导入模块中的每个类，可使用下面的语法：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> module_name <span class="token keyword">import</span> <span class="token operator">*</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>但是<strong>不推荐这种导入方式</strong>(同<strong>导入模块中的所有元素</strong>)，原因有二：</p>
<ol>
<li>这种导入方式<strong>没有明确地指出你使用了模块中的哪些类</strong>。</li>
<li>还可能引发名称方面的困惑。<strong>如果不小心导入了一个与程序文件中其他东西同名的类</strong>，将<strong>引发难以诊断的错误</strong>。</li>
</ol>
<p>需要从一个模块中导入很多类时，最好<strong>导入整个模块</strong>，并<strong>用<code>module_name.class_name</code>语法来访问类</strong>。</p>
<hr>
<h4 id="在一个模块中导入另一个模块"><a href="#在一个模块中导入另一个模块" class="headerlink" title="在一个模块中导入另一个模块"></a>在一个模块中导入另一个模块</h4><p>有时候，需要将类分散到多个模块中，<strong>以免模块太大，或在同一个模块中存储不相关的类</strong>。将类存储在多个模块中时，你<strong>可能会发现一个模块中的类依赖于另一个模块中的类</strong>。这种情况下，可在前一个模块中导入必要的类。</p>
<p>例如，下面将Car类存储在一个模块中，并将ElectricCar和Battery类存储再另一个模块中。我们将第二个模块命名为electric_car.py：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token triple-quoted-string string">"""一组可用于表示电动汽车的类"""</span>

<span class="token keyword">from</span> car <span class="token keyword">import</span> Car

<span class="token keyword">class</span> <span class="token class-name">Battery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token operator">-</span><span class="token operator">-</span>snip<span class="token operator">-</span><span class="token operator">-</span>
    
<span class="token keyword">class</span> <span class="token class-name">ElectricCar</span><span class="token punctuation">(</span>Car<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token operator">-</span><span class="token operator">-</span>snip<span class="token operator">-</span><span class="token operator">-</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>现在可以分别从每个模块中导入类，以根据需要创建任何类型的汽车了：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> car <span class="token keyword">import</span> Car
<span class="token keyword">from</span> electric_car <span class="token keyword">import</span> ElectricCar

my_beetle <span class="token operator">=</span> Car<span class="token punctuation">(</span><span class="token string">'volkswagen'</span><span class="token punctuation">,</span> <span class="token string">'beetle'</span><span class="token punctuation">,</span> <span class="token number">2016</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>my_beetle<span class="token punctuation">.</span>get_descriptive_name<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

my_tesla <span class="token operator">=</span> ElectricCar<span class="token punctuation">(</span><span class="token string">'tesla'</span><span class="token punctuation">,</span> <span class="token string">'roadster'</span><span class="token punctuation">,</span> <span class="token number">2016</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>my_tesla<span class="token punctuation">.</span>get_descriptive_name<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h3 id="Python-标准库"><a href="#Python-标准库" class="headerlink" title="Python 标准库"></a>Python 标准库</h3><p>Python标准库是<strong>一组模块</strong>，安装好的Python都包含它。<strong>可使用标准库中的任何函数和类</strong>，为此只需在程序开头包含一条简单的<strong>import语句</strong>。</p>
<p>下面来看<strong>模块collection</strong>中的一个类——<strong>OrderedDict</strong>。要创建字典并记录其中的键-值对的<strong>添加顺序</strong>，即可使用模块collections中的OrderedDict类。再来看一看第6章的favorite_languages.py示例：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> collections <span class="token keyword">import</span> OrderedDict

favorite_languages <span class="token operator">=</span> OrderedDict<span class="token punctuation">(</span><span class="token punctuation">)</span>

favorite_languages<span class="token punctuation">[</span><span class="token string">'jen'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'python'</span>
favorite_languages<span class="token punctuation">[</span><span class="token string">'sarah'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'c'</span>
favorite_languages<span class="token punctuation">[</span><span class="token string">'edward'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'ruby'</span>
favorite_languages<span class="token punctuation">[</span><span class="token string">'phil'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'python'</span>

<span class="token keyword">for</span> name<span class="token punctuation">,</span> language <span class="token keyword">in</span> favorite_languages<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>name<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"'s favorite language is "</span> <span class="token operator">+</span>
         language<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"."</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>这是一个很不错的类，它<strong>兼具列表和字典的主要优点</strong>(在<strong>将信息关联起来的同时保留原来的顺序</strong>)。</p>
<h4 id="模块random"><a href="#模块random" class="headerlink" title="模块random"></a>模块random</h4><p>模块random包含<strong>以各种方式生成随机数的函数</strong>，其中的<code>randint()</code>返回一个<strong>位于指定范围内的整数</strong>。</p>
<p>例如，下面的代码返回一个1~6内的整数：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> random <span class="token keyword">import</span> randint
x <span class="token operator">=</span> randint<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<hr>
<h3 id="类编码风格"><a href="#类编码风格" class="headerlink" title="类编码风格"></a>类编码风格</h3><ul>
<li><strong>类名</strong>：应采用<strong>驼峰命名法</strong>。</li>
<li><strong>实例名</strong>和<strong>模块名</strong>：应采用<strong>小写格式</strong>，并在单词之间加上下划线。</li>
<li>在<strong>类</strong>中，可使用<strong>一个空行</strong>来<strong>分隔方法</strong>；在<strong>模块</strong>中，可使用<strong>两个空行</strong>来<strong>分隔类</strong>。</li>
<li>需要同时导入标准库中的模块和自己编写的模块时，先编写导入标准库模块的import语句，再<strong>添加一个空行</strong>，然后编写导入自己编写的模块的import语句。这种做法<strong>让人更容易明白程序使用的各个模块来自何方</strong>。</li>
</ul>
<hr>
<h2 id="文件和异常"><a href="#文件和异常" class="headerlink" title="文件和异常"></a>文件和异常</h2><h3 id="从文件中读取数据"><a href="#从文件中读取数据" class="headerlink" title="从文件中读取数据"></a>从文件中读取数据</h3><p>文本文件可存储的数据量多的难以置信，每当需要分析或修改存储在文件中的信息时，读取文件都很有用，对数据分析应用程序来说尤其如此。例如可以编写一个这样的程序：<strong>读取一个文本文件的内容，重新设置这些数据的格式并将其写入文件，让浏览器能够显示这些内容</strong>。</p>
<p>要使用文本文件中的信息，<strong>首先需要将信息读取到内存中</strong>。为此，可以<strong>一次性读取文件的全部内容</strong>，也可以<strong>每次一行逐步读取</strong>。</p>
<h4 id="读取整个文件"><a href="#读取整个文件" class="headerlink" title="读取整个文件"></a>读取整个文件</h4><p>首先创建一个文件，它包含精确到小数点后30位的圆周率值，且在小数点后<strong>每10位处都换行</strong>：</p>
<pre class="line-numbers language-none"><code class="language-none">3.1415926535
  8979323846
  2643383279<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>将上述文件保存为<code>pi_digits.txt</code>，<strong>保存到本章程序所在的目录中</strong>。</p>
<p>下面的程序<strong>打开并读取这个文件</strong>，再<strong>将其内容显示到屏幕上</strong>：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'pi_digits.txt'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> file_object<span class="token punctuation">:</span>
    contents <span class="token operator">=</span> file_object<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>contents<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>再这个程序中，<strong>第一行代码做了大量的工作</strong>：</p>
<ul>
<li><p>函数<code>open()</code></p>
<ul>
<li>接受一个参数——<strong>要打开的文件的名称</strong>。</li>
<li>Python<strong>在当前执行的文件所在的目录中查找指定的文件</strong>。</li>
<li>返回一个<strong>表示文件的对象</strong>，Python将这个对象存储在我们将在后面使用的变量中。</li>
</ul>
</li>
<li><p><strong>关键字with</strong>在<strong>不需要访问文件后将其关闭</strong></p>
<ul>
<li><p>也可以调用<code>open()</code>和<code>close()</code>来打开和关闭文件，但这样做时，<strong>如果程序存在bug导致<code>close()</code>语句未执行，文件将不会关闭</strong>。</p>
<p>如果在程序中<strong>过早调用</strong><code>close()</code>，你会发现<strong>需要使用文件时它已关闭(无法访问)，这会导致更多的错误</strong>。</p>
</li>
<li><p>并非在任何情况下都能轻松确定关闭文件的恰当时机，但<strong>通过关键字with，可以让Python确定合适的时机自动关闭文件</strong>。</p>
</li>
</ul>
</li>
<li><p>有了表示文件的对象后，<strong>使用方法<code>read()</code>读取这个文件的全部内容</strong>，<strong>作为一个字符串</strong>。</p>
<ul>
<li><code>read()</code><strong>到达文件末尾</strong>时返回一个<strong>空字符串</strong>，这个空字符串<strong>显示出来就是一个空行</strong>。</li>
<li>要<strong>删除末尾的空行</strong>，可在print语句中使用<code>rstrip()</code>：<code>print(contents.rstrip())</code></li>
</ul>
</li>
</ul>
<hr>
<h4 id="文件路径"><a href="#文件路径" class="headerlink" title="文件路径"></a>文件路径</h4><p>Python<strong>默认在当前执行的文件所在的目录中查找指定的文件</strong>，但有时可能要打开不在程序文件所属目录中的文件。要让Python<strong>打开不与程序文件位于同一个目录中的文件</strong>，需要提供<strong>文件路径</strong>。</p>
<ul>
<li><p><strong>相对</strong>文件路径：</p>
<p>相对于<strong>当前运行的程序所在目录</strong>的路径。</p>
<ul>
<li><p>在 Linux 和 OS X 中，可以这样编写代码：</p>
<p><code>with open(&#39;text_files/filename.txt&#39;) as file_object:</code></p>
<p>这行代码让Python到<strong>当前文件夹下的</strong><code>text_files</code>文件夹中寻找指定的.txt文件。</p>
</li>
<li><p>在 Windows 系统中，在文件路径中使用<strong>反斜杠</strong>(<code>\</code>)：</p>
<p><code>with open(&#39;text_files\filename.txt&#39;) as file_object:</code></p>
</li>
</ul>
</li>
<li><p><strong>绝对</strong>文件路径：</p>
<p>将文件<strong>在计算机中的准确位置</strong>告诉Python。</p>
<p>绝对路径通常比相对路径<strong>更长</strong>，因此将其<strong>存储在一个变量中</strong>，再将该变量传递给<code>open()</code>会有所帮助。</p>
<ul>
<li><p>在 Linux 和 OS X 中，可以这样编写代码：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">file_path <span class="token operator">=</span> <span class="token string">'/home/ehmatthes/other_files/text_files/filename.txt'</span>
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>file_path<span class="token punctuation">)</span> <span class="token keyword">as</span> file_object<span class="token punctuation">:</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
</li>
<li><p>在 Windows 系统中，它们类似于下面这样：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">file_path <span class="token operator">=</span> <span class="token string">'C:\Ysers\ehmatthes\other_files\text_files\filename.txt'</span>
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>file_path<span class="token punctuation">)</span> <span class="token keyword">as</span> file_object<span class="token punctuation">:</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li>
</ul>
<p>注意：</p>
<ul>
<li>Windows系统<strong>有时能够正确解读</strong>文件路径中的<strong>斜杠</strong>。如果使用Windows系统，且结果不符合预期，请<strong>确保</strong>在文件路径中使用的是<strong>反斜杠</strong>。</li>
<li><strong>反斜杠</strong>在Python中被视为<strong>转义标记</strong>，为<strong>在Windows中确保万无一失</strong>，应<strong>以原始字符串的方式指定路径</strong>，即<strong>在开头的单引号前加上<code>r</code></strong>(以r开头，那么说明<strong>后面的字符，都是普通的字符</strong>了，即如果是<code>\n</code>，<strong>将表示一个反斜杠字符，一个字母n，而不是表示换行了</strong>)。</li>
</ul>
</li>
</ul>
<hr>
<h4 id="逐行读取"><a href="#逐行读取" class="headerlink" title="逐行读取"></a>逐行读取</h4><p>读取文件时，常常需要<strong>检查其中的每一行</strong>：你可能要在文件中<strong>查找特定的信息</strong>，或者<strong>要以某种方式修改文件中的文本</strong>。例如，你可能要遍历一个包含天气数据的文件，并使用天气描述中包含字样sunny的行；在新闻报道中，你可能会查找包含标签<code>&lt;headline&gt;</code>的行，并按特定的格式设置它。</p>
<p>要以<strong>每次一行的方式</strong>检查文件，可对文件对象使用<strong>for循环</strong>：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">filename <span class="token operator">=</span> <span class="token string">'pi_digits.txt'</span>

<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span> <span class="token keyword">as</span> file_object<span class="token punctuation">:</span>
    <span class="token keyword">for</span> line <span class="token keyword">in</span> file_object<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>line<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>我们<strong>打印每一行</strong>时，发现<strong>空白行</strong>更多了：</p>
<pre class="line-numbers language-none"><code class="language-none">3.1415926535

  8979323846
  
  2643383279<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>为什么会出现这些空白行呢？因为<strong>在这个文件中</strong>，<strong>每行的末尾都有一个看不见的换行符</strong>，而<strong>print语句也会加上一个换行符</strong>。要<strong>消除这些多余的空白行，可在print语句中使用<code>rstrip()</code></strong>：<code>print(line.rstrip())</code></p>
<hr>
<h4 id="创建一个包含文件各行内容的列表"><a href="#创建一个包含文件各行内容的列表" class="headerlink" title="创建一个包含文件各行内容的列表"></a>创建一个包含文件各行内容的列表</h4><p>使用<strong>关键字with</strong>时，<code>open()</code><strong>返回的文件对象只在with代码块内可用</strong>。如果要在<strong>with代码块外</strong>访问文件的内容，可<strong>在with代码块内</strong>将文件的各行<strong>存储在一个列表中</strong>，并在with代码块外使用该列表：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">filename <span class="token operator">=</span> <span class="token string">'pi_digits.txt'</span>

<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span> <span class="token keyword">as</span> file_object<span class="token punctuation">:</span>
    lines <span class="token operator">=</span> file_object<span class="token punctuation">.</span>readlines<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
<span class="token keyword">for</span> line <span class="token keyword">in</span> lines<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>line<span class="token punctuation">.</span>rstrip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li>方法<code>readlines()</code>从文件中<strong>读取每一行，并将其存储在一个列表中</strong>。</li>
</ul>
<hr>
<h4 id="使用文件的内容"><a href="#使用文件的内容" class="headerlink" title="使用文件的内容"></a>使用文件的内容</h4><p>首先创建一个字符串，它<strong>包含文件中存储的所有数字</strong>，且<strong>没有任何空格</strong>：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">filename <span class="token operator">=</span> <span class="token string">'pi_digits.txt'</span>

<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span> <span class="token keyword">as</span> file_object<span class="token punctuation">:</span>
    lines <span class="token operator">=</span> file_object<span class="token punctuation">.</span>readlines<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
pi_string <span class="token operator">=</span> <span class="token string">''</span>
<span class="token keyword">for</span> line <span class="token keyword">in</span> lines<span class="token punctuation">:</span>
    pi_string <span class="token operator">+=</span> line<span class="token punctuation">.</span>rstrip<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
<span class="token keyword">print</span><span class="token punctuation">(</span>pi_string<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>pi_string<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>打印结果：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token number">3.1415926535</span>  <span class="token number">8979323846</span>  <span class="token number">2643383279</span>
<span class="token number">36</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>在变量pi_string存储的字符串中，<strong>包含原来位于左边的空格</strong>，为删除这些空格，**可使用<code>strip()</code>**而不是<code>rstrip()</code></p>
<p>注意：</p>
<p>读取<strong>文本文件</strong>时，Python将其中的文本都<strong>解读为字符串</strong>。如果<strong>读取的是数字，并要将其作为数值使用</strong>，就必须使用函数<code>int()</code>或<code>float()</code>转换为数字。</p>
<hr>
<h4 id="包含小数点后一百万位的大型文件"><a href="#包含小数点后一百万位的大型文件" class="headerlink" title="包含小数点后一百万位的大型文件"></a>包含小数点后一百万位的大型文件</h4><p>只要系统内存足够多，想处理多少数据都可以。</p>
<hr>
<h4 id="圆周率值中包含你的生日吗"><a href="#圆周率值中包含你的生日吗" class="headerlink" title="圆周率值中包含你的生日吗"></a>圆周率值中包含你的生日吗</h4><p>为确认某个人的生日是否包含在圆周率值得前1 000 000位中，可将生日表示为一个由数字组成得字符串，再检查这个字符串是否包含在pi_string中：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">filename <span class="token operator">=</span> <span class="token string">'pi_digits.txt'</span>

<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span> <span class="token keyword">as</span> file_object<span class="token punctuation">:</span>
    lines <span class="token operator">=</span> file_object<span class="token punctuation">.</span>readlines<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
pi_string <span class="token operator">=</span> <span class="token string">''</span>
<span class="token keyword">for</span> line <span class="token keyword">in</span> lines<span class="token punctuation">:</span>
    pi_string <span class="token operator">+=</span> line<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
birthday <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"Enter your birthday, in thje form mmddyy: "</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> birthday <span class="token keyword">in</span> pi_string<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Your birthday appears in the first million digits of pi!"</span><span class="token punctuation">)</span>
<span class="token keyword">else</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Your birthday does not appear in the first million digits of pi."</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h3 id="写入文件"><a href="#写入文件" class="headerlink" title="写入文件"></a>写入文件</h3><p><strong>保存数据</strong>最简单的方式之一是将其<strong>写入到文件中</strong>。</p>
<h4 id="写入空文件"><a href="#写入空文件" class="headerlink" title="写入空文件"></a>写入空文件</h4><p>要将文本写入文件，在调用<code>open()</code>时需要<strong>提供另一个实参</strong>，告诉Python<strong>要写入打开的文件</strong>。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">filename <span class="token operator">=</span> <span class="token string">'programming.txt'</span>

<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> file_object<span class="token punctuation">:</span>
    file_object<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">"I love programming."</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li><p>实参<code>&#39;w&#39;</code>告诉Python，我们要以<strong>写入模式</strong>打开这个文件。</p>
</li>
<li><p>打开文件时，可指定<strong>模式</strong></p>
<ul>
<li><strong>读取</strong>模式（<strong>‘r’</strong>）</li>
<li><strong>写入</strong>模式（<strong>‘w’</strong>）</li>
<li><strong>附加</strong>模式（<strong>‘a’</strong>)</li>
<li><strong>读写</strong>模式（<strong>‘r+’</strong>）</li>
</ul>
<p>如果<strong>省略了模式实参</strong>，默认以<strong>只读模式</strong>打开文件。</p>
</li>
<li><p>如果<strong>要写入的文件不存在</strong>，函数<code>open()</code>将<strong>自动创建它</strong>。然而，<strong>以写入(‘w’)模式打开文件时千万要小心</strong>，因为<strong>如果指定的文件已经存在，Python将在返回文件对象前清空该文件</strong>。</p>
</li>
<li><p>文件对象的方法<code>write()</code><strong>将一个字符串写入文件</strong>。</p>
</li>
<li><p>Python<strong>只能将字符串写入文本文件</strong>，要将数值数据存储到文本文件中，必须先使用函数<code>str()</code>将其转换为字符串格式。</p>
</li>
</ul>
<hr>
<h4 id="写入多行"><a href="#写入多行" class="headerlink" title="写入多行"></a>写入多行</h4><p>函数<code>write()</code><strong>不会在写入的文本末尾添加换行符</strong>，要让每个字符串都单独占一行，需要在<code>write()</code>语句中包含换行符。</p>
<hr>
<h4 id="附加到文件"><a href="#附加到文件" class="headerlink" title="附加到文件"></a>附加到文件</h4><p>如果要<strong>给文件添加内容，而不是覆盖原有内容</strong>，可以**附加模式(‘a’)**打开文件。如果指定的文件不存在，Python会创建一个空文件。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">filename <span class="token operator">=</span> <span class="token string">'programming.txt'</span>

<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> <span class="token string">'a'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> file_object<span class="token punctuation">:</span>
    file_object<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">"I also love finding meaning in large datasets.\n"</span><span class="token punctuation">)</span>
    file_object<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">"I love creating apps that can run in a browser.\n"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h3 id="异常"><a href="#异常" class="headerlink" title="异常"></a>异常</h3><p>Python使用<strong>被称为异常的特殊对象</strong>来<strong>管理程序执行期间发生的错误</strong>。每当发生让Python不知所措的错误时，它都会创建一个异常对象。如果编写了处理该异常的代码，程序将继续运行；<strong>如果未对异常进行处理，程序将停止，并显示一个<code>traceback</code>，其中包含有关异常的报告</strong>。</p>
<p>异常是使用<code>try-except</code>代码块处理的。<code>try-except</code>代码块让Python<strong>执行指定的操作</strong>，<strong>同时告诉Python发生异常时怎么办</strong>。使用了<code>try-except</code>代码块时，<strong>即便出现异常，程序也将继续运行</strong>：显示编写的友好的错误消息，而不是令用户迷惑的<code>traceback</code>。</p>
<ul>
<li><p>ZeroDivisionError 异常</p>
<p><code>ZeroDivisionError</code>就是一个<strong>异常对象</strong></p>
</li>
<li><p>ValueError 异常</p>
<p>尝试<strong>将非数字文本转换为数字</strong>时，将引发<code>ValueError</code></p>
</li>
<li><p>FileNotFoundError 异常</p>
</li>
<li></li>
</ul>
<hr>
<h4 id="使用-try-except-代码块"><a href="#使用-try-except-代码块" class="headerlink" title="使用 try-except 代码块"></a>使用 try-except 代码块</h4><p>当你认为可能发生了错误时，可编写一个<code>try-except</code>代码块来处理可能引发的异常。</p>
<p>处理<code>ZeroDivisionError</code>异常的<code>try-except</code>代码块类似于下面这样：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">try</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token operator">/</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token keyword">except</span> ZeroDivisionError<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"You can't divide by zero!"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h4 id="使用异常避免崩溃"><a href="#使用异常避免崩溃" class="headerlink" title="使用异常避免崩溃"></a>使用异常避免崩溃</h4><p>发生错误时，<strong>如果程序还有工作没有完成</strong>，<strong>妥善地处理错误</strong>就尤其重要。这种情况经常会出现在要求用户提供输入的程序中；如果程序能够妥善地处理无效输入就能再提示用户提供有效输入，而<strong>不至于崩溃</strong>。</p>
<hr>
<h4 id="else-代码块"><a href="#else-代码块" class="headerlink" title="else 代码块"></a>else 代码块</h4><p><strong>将可能引发错误地代码放在<code>try-except</code>代码块中</strong>，可提高这个程序抵御错误的能力。<strong>依赖于try代码块成功执行的代码</strong>都应放到<strong>else代码块</strong>中：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">try</span><span class="token punctuation">:</span>
    answer <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>first_number<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token builtin">int</span><span class="token punctuation">(</span>second_number<span class="token punctuation">)</span>
<span class="token keyword">except</span> ZeroDivisionError<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"You can't divide by 0!"</span><span class="token punctuation">)</span>
<span class="token keyword">else</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>answer<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h4 id="处理-FileNotFoundError-异常"><a href="#处理-FileNotFoundError-异常" class="headerlink" title="处理 FileNotFoundError 异常"></a>处理 FileNotFoundError 异常</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python">filename <span class="token operator">=</span> <span class="token string">'alice.txt'</span>

<span class="token keyword">try</span><span class="token punctuation">:</span>
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span> <span class="token keyword">as</span> f_obj<span class="token punctuation">:</span>
        contents <span class="token operator">=</span> f_obj<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">except</span> FileNotFoundError<span class="token punctuation">:</span>
    msg <span class="token operator">=</span> <span class="token string">"Sorry, the file "</span> <span class="token operator">+</span> filename <span class="token operator">+</span> <span class="token string">" does not exist."</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>如果文件不存在，这个程序什么都不做，因此错误处理代码的意义不大。</p>
<hr>
<h4 id="分析文本"><a href="#分析文本" class="headerlink" title="分析文本"></a>分析文本</h4><p>下面来提取童话<em>Alice in Wonderland</em>的文本，并尝试<strong>计算它包含多少个单词</strong>。</p>
<p>我们将使用方法<code>split()</code>，它<strong>根据一个字符串创建一个单词列表</strong>。方法<code>split()</code><strong>以空格为分隔符</strong>将字符串分拆成多个部分，<strong>并将这些部分都存储在一个列表中</strong>。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">filename <span class="token operator">=</span> <span class="token string">'alice.txt'</span>

<span class="token keyword">try</span><span class="token punctuation">:</span>
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span> <span class="token keyword">as</span> f_obj<span class="token punctuation">:</span>
        contents <span class="token operator">=</span> f_obj<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">except</span> FileNotFoundError<span class="token punctuation">:</span>
    msg <span class="token operator">=</span> <span class="token string">"Sorry, the file "</span> <span class="token operator">+</span> filename <span class="token operator">+</span> <span class="token string">" does not exist."</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span>
<span class="token keyword">else</span><span class="token punctuation">:</span>
    <span class="token comment"># 计算文件大致包含多少个单词</span>
    words <span class="token operator">=</span> contents<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token punctuation">)</span>
    num_words <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>words<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"The file "</span> <span class="token operator">+</span> filename <span class="token operator">+</span> <span class="token string">" has about "</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>num_words<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">" words."</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h4 id="使用多个文件"><a href="#使用多个文件" class="headerlink" title="使用多个文件"></a>使用多个文件</h4><p>下面多分析几本书。我们先将这个程序的大部分代码移到一个名为<code>count_words()</code>的函数中，这样对多本书进行分析时将更容易：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">count_words</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""计算一个文件大致包含多少个单词"""</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
    	<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span> <span class="token keyword">as</span> f_obj<span class="token punctuation">:</span>
        	contents <span class="token operator">=</span> f_obj<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">except</span> FileNotFoundError<span class="token punctuation">:</span>
        msg <span class="token operator">=</span> <span class="token string">"Sorry, the file "</span> <span class="token operator">+</span> filename <span class="token operator">+</span> <span class="token string">" does not exist."</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token comment"># 计算文件大致包含多少个单词</span>
        words <span class="token operator">=</span> contents<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token punctuation">)</span>
        num_words <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>words<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"The file "</span> <span class="token operator">+</span> filename <span class="token operator">+</span> <span class="token string">" has about "</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>num_words<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">" words."</span><span class="token punctuation">)</span>
filename <span class="token operator">=</span> <span class="token string">'alice.txt'</span>
count_words<span class="token punctuation">(</span>filename<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h4 id="失败时一声不吭"><a href="#失败时一声不吭" class="headerlink" title="失败时一声不吭"></a>失败时一声不吭</h4><p><strong>要让程序在失败时一声不吭，可通过pass语句，在except代码块中明确表明什么都不做</strong>：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">count_words</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""计算一个文件大致包含多少个单词"""</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        <span class="token operator">-</span><span class="token operator">-</span>snip<span class="token operator">-</span><span class="token operator">-</span>

	<span class="token keyword">except</span> FileNotFoundError<span class="token punctuation">:</span>
        <span class="token keyword">pass</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token operator">-</span><span class="token operator">-</span>snip<span class="token operator">-</span><span class="token operator">-</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>pass语句</strong>还充当了<strong>占位符</strong>。它提醒你<strong>在程序的某个地方什么都没有做，并且以后也许要在这里做些什么</strong>。在这个程序中，我们可能决定将找不到的文件的名称写入到文件<code>missing_files.txt</code>中。</p>
<hr>
<h3 id="使用-模块json-存储数据"><a href="#使用-模块json-存储数据" class="headerlink" title="使用 模块json 存储数据"></a>使用 模块json 存储数据</h3><p>很多程序要求用户输入某种信息，如让用户<strong>存储游戏首选项</strong>或<strong>提供可视化的数据</strong>。不管专注的是什么，<strong>程序都把用户提供的信息存储在列表和字典等数据结构中</strong>。用户关闭程序时，几乎总是要保存他们提供的信息，一种简单的方式是<strong>使用模块json来存储数据</strong>。</p>
<ul>
<li>模块json能<strong>将简单的Python数据结构转储到文件中</strong>，<strong>并在程序再次运行时加载该文件中的数据</strong>。</li>
<li>还可以使用json<strong>在Python程序之间分享数据</strong></li>
<li>JSON数据格式不是Python专用，因此能够将以JSON格式储的数据与使用其他编程语言的人分享</li>
<li>JSON是一种轻便格式，很有用，也易于学习</li>
<li>**JSON(JavaScript Object Notation)**格式最初是为JavaScript开发的，但随后成了一种常见格式，被众多语言采用</li>
</ul>
<p>我们来编写程序，使用<code>json.dump()</code>来<strong>存储一组数字</strong>，使用<code>json.load()</code><strong>将这些数字读取到内存中</strong>。</p>
<h4 id="使用-json-dump"><a href="#使用-json-dump" class="headerlink" title="使用 json.dump()"></a>使用 json.dump()</h4><ul>
<li>函数<code>json.dump()</code>接受两个实参：<ol>
<li>要存储的<strong>数据</strong></li>
<li>可用于存储数据的<strong>文件对象</strong></li>
</ol>
</li>
</ul>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> json

numbers <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">]</span>

filename <span class="token operator">=</span> <span class="token string">'numbers.json'</span>
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f_obj<span class="token punctuation">:</span>
    json<span class="token punctuation">.</span>dump<span class="token punctuation">(</span>numbers<span class="token punctuation">,</span> f_obj<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li>先导入<strong>模块json</strong>，再<strong>创建一个数字列表</strong>。</li>
<li>通常<strong>使用文件扩展名<code>.json</code><strong>来</strong>指出文件存储的数据为JSON格式</strong>。</li>
<li>使用函数<code>json.dump()</code>将数字列表存储到文件numbers.json中</li>
</ul>
<hr>
<h4 id="使用-json-load"><a href="#使用-json-load" class="headerlink" title="使用 json.load()"></a>使用 json.load()</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> json

filename <span class="token operator">=</span> <span class="token string">'numbers.json'</span>
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span> <span class="token keyword">as</span> f_obj<span class="token punctuation">:</span>
    numbers <span class="token operator">=</span> json<span class="token punctuation">.</span>load<span class="token punctuation">(</span>f_obj<span class="token punctuation">)</span>
    
<span class="token keyword">print</span><span class="token punctuation">(</span>numbers<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h4 id="保存和读取用户生成的数据"><a href="#保存和读取用户生成的数据" class="headerlink" title="保存和读取用户生成的数据"></a>保存和读取用户生成的数据</h4><p>来看这样一个例子：用户<strong>首次运行程序时被提示输入自己的名字</strong>，这样<strong>再次运行程序时就记住他了</strong>。</p>
<ul>
<li><p>先存储用户的名字：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> json

username <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"What is your name? "</span><span class="token punctuation">)</span>

filename <span class="token operator">=</span> <span class="token string">'username.json'</span>
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f_obj<span class="token punctuation">:</span>
    json<span class="token punctuation">.</span>dump<span class="token punctuation">(</span>username<span class="token punctuation">,</span> f_obj<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"We'll remember you when you come back, "</span> <span class="token operator">+</span> username <span class="token operator">+</span> <span class="token string">"!"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>再编写一个程序，向其名字被存储的用户发出问候：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> json

filename <span class="token operator">=</span> <span class="token string">'username.json'</span>

<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span> <span class="token keyword">as</span> f_obj<span class="token punctuation">:</span>
    username <span class="token operator">=</span> json<span class="token punctuation">.</span>load<span class="token punctuation">(</span>f_obj<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Welcome back, "</span> <span class="token operator">+</span> username <span class="token operator">+</span> <span class="token string">"!"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ul>
<p>我们需要将这两个程序合并到一个程序中。这个程序运行时，我们将尝试<strong>从文件username.json中获取用户名</strong>。因此首先编写一个<strong>尝试恢复用户名的try代码块</strong>。如果这个文件不存在，我们就在except代码块中提示用户输入用户名，并将其存储在username.json中，以便程序再次运行时能够获取它：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> json

<span class="token comment"># 如果以前存储了用户名，就加载它</span>
<span class="token comment"># 否则，就提示用户输入用户名并存储它</span>
filename <span class="token operator">=</span> <span class="token string">'username.json'</span>
<span class="token keyword">try</span><span class="token punctuation">:</span>
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span> <span class="token keyword">as</span> f_obj"
    username <span class="token operator">=</span> json<span class="token punctuation">.</span>load<span class="token punctuation">(</span>f_obj<span class="token punctuation">)</span>
<span class="token keyword">except</span> FileNotFoundError<span class="token punctuation">:</span>
    username <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"What is your name? "</span><span class="token punctuation">)</span>
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f_obj<span class="token punctuation">:</span>
        json<span class="token punctuation">.</span>dump<span class="token punctuation">(</span>username<span class="token punctuation">,</span> f_obj<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"We'll remember you when you come back, "</span> <span class="token operator">+</span> username <span class="token operator">+</span> <span class="token string">"!"</span><span class="token punctuation">)</span>
<span class="token keyword">else</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Welcome back, "</span> <span class="token operator">+</span> username <span class="token operator">+</span> <span class="token string">"!"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h4 id="重构"><a href="#重构" class="headerlink" title="重构"></a>重构</h4><p>你经常会遇到这样的情况：代码能够正确地运行，但可做进一步的<strong>改进</strong>——<strong>将代码划分为一系列完成具体工作的函数</strong>。这样的过程被称为<strong>重构</strong>。<strong>重构让代码更清晰、更易于理解、更容易扩展</strong>。</p>
<p>要重构上述程序，可将大部分逻辑放到一个或多个函数中。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> json

<span class="token keyword">def</span> <span class="token function">greet_user</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""问候用户，并指出其名字"""</span>
    filename <span class="token operator">=</span> <span class="token string">'username.json'</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span> <span class="token keyword">as</span> f_obj<span class="token punctuation">:</span>
            username <span class="token operator">=</span> json<span class="token punctuation">.</span>load<span class="token punctuation">(</span>f_obj<span class="token punctuation">)</span>
    <span class="token keyword">except</span> FileNotFoundError<span class="token punctuation">:</span>
        username <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"What is your name? "</span><span class="token punctuation">)</span>
        <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f_obj<span class="token punctuation">:</span>
            json<span class="token punctuation">.</span>dump<span class="token punctuation">(</span>username<span class="token punctuation">,</span> f_obj<span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"We'll remember you when you come back"</span> <span class="token operator">+</span> username <span class="token operator">+</span> <span class="token string">"!"</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Welcome back, "</span> <span class="token operator">+</span> username <span class="token operator">+</span> <span class="token string">"!"</span><span class="token punctuation">)</span>
        
greet_user<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>下面来重构<code>greet_user()</code>，让它不执行这么多任务：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> json

<span class="token keyword">def</span> <span class="token function">get_stored_username</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""如果存储了用户名，就获取它"""</span>
    filename <span class="token operator">=</span> <span class="token string">'username.json'</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span> <span class="token keyword">as</span> f_obj<span class="token punctuation">:</span>
            username <span class="token operator">=</span> json<span class="token punctuation">.</span>load<span class="token punctuation">(</span>f_obj<span class="token punctuation">)</span>
    <span class="token keyword">except</span> FileNotFoundError<span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token boolean">None</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> username
    
<span class="token keyword">def</span> <span class="token function">get_new_username</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""提示用户输入用户名"""</span>
    username <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"What is your name? "</span><span class="token punctuation">)</span>
    filename <span class="token operator">=</span> <span class="token string">'username.json'</span>
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>filename<span class="token punctuation">.</span> <span class="token string">'w'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f_obj<span class="token punctuation">:</span>
        json<span class="token punctuation">.</span>dump<span class="token punctuation">(</span>username<span class="token punctuation">,</span> f_obj<span class="token punctuation">)</span>
    
<span class="token keyword">def</span> <span class="token function">greet_user</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""问候用户，并指出其名字"""</span>
    username <span class="token operator">=</span> get_stored_username<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> username<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Welcom back, "</span> <span class="token operator">+</span> username <span class="token operator">+</span> <span class="token string">"!"</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        username <span class="token operator">=</span> get_new_username<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"We'll remember you when you come back"</span> <span class="token operator">+</span> username <span class="token operator">+</span> <span class="token string">"!"</span><span class="token punctuation">)</span>

greet_user<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>在这个版本中，<strong>每个函数都执行单一而清晰的任务</strong>。</p>
<hr>
<h2 id="测试代码"><a href="#测试代码" class="headerlink" title="测试代码"></a>测试代码</h2><h3 id="测试函数"><a href="#测试函数" class="headerlink" title="测试函数"></a>测试函数</h3><p>下面是一个简单的函数，它接受名和姓并返回整洁的姓名：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">get_formatted_name</span><span class="token punctuation">(</span>first<span class="token punctuation">,</span> last<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""生成整洁的姓名"""</span>
    full_name <span class="token operator">=</span> first <span class="token operator">+</span> <span class="token string">' '</span> <span class="token operator">+</span> last
    <span class="token keyword">return</span> full_name<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>为核实函数像期望的那样工作，来编写一个使用这个函数的程序：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> name_function <span class="token keyword">import</span> get_formatted_name

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Enter 'q' at any time to quit."</span><span class="token punctuation">)</span>
<span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
    first <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"\nPlease give me a forst name: "</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> first <span class="token operator">==</span> <span class="token string">'q'</span><span class="token punctuation">:</span>
	    <span class="token keyword">break</span>
    last <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"Please give me a last time: "</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> last <span class="token operator">==</span> <span class="token string">'q'</span><span class="token punctuation">:</span>
        <span class="token keyword">break</span>
        
    formatted_name <span class="token operator">=</span> get_formatted_name<span class="token punctuation">(</span>first<span class="token punctuation">,</span> last<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\tNeatly formatted name: "</span> <span class="token operator">+</span> formatted_name <span class="token operator">+</span> <span class="token string">'.'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>现在假设我们要修改<code>get_formatted_name()</code>，使其还能处理中间名。这样做时，我们要确保<strong>不破坏这个函数处理只有名和姓的姓名的方式</strong>。为此，我们可以在每次修改<code>get_formatted_name()</code>后都进行测试：运行程序<code>names.py</code>，并输入像Janis Joplin这样的姓名，但这太繁琐了。所幸Python提供了一种<strong>自动测试函数输出</strong>的高效方式。</p>
<h4 id="单元测试和测试用例"><a href="#单元测试和测试用例" class="headerlink" title="单元测试和测试用例"></a>单元测试和测试用例</h4><p><strong>Python标准库中的模块unittest</strong>提供了<strong>代码测试工具</strong>。</p>
<ul>
<li><strong>单元</strong>测试：用于<strong>核实函数的某个方面</strong>没有问题</li>
<li><strong>测试用例</strong>：是<strong>一组单元测试</strong>，这些单元测试一起核实函数在各种情形下的行为都符合要求。</li>
</ul>
<p>良好的测试用例考虑到了函数可能收到的各种输入，包含针对所有这些情形的测试。<strong>全覆盖式测试</strong>用例包含一整套单元测试，涵盖了各种可能的函数使用方式。对于大型项目，要实现全覆盖很难。通常，<strong>最初只要针对代码的重要行为编写测试即可，等项目被广泛使用时再考虑全覆盖</strong>。</p>
<hr>
<h4 id="可通过的测试"><a href="#可通过的测试" class="headerlink" title="可通过的测试"></a>可通过的测试</h4><p><strong>创建测试用例的语法需要一段时间才能习惯</strong>，但测试用例创建后，<strong>再添加针对函数的单元测试就很简单了</strong>。要为函数编写测试用例，可<strong>先导入模块unittest以及要测试的函数</strong>，再创建一个<strong>继承unittest.TestCase</strong>的类，并编写一系列方法对函数行为的不同方面进行测试。</p>
<p>下面是一个只包含一个方法的测试用例，它检查函数<code>get_formatted_name()</code>在给定名和姓时能否正确地工作：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> unittest
<span class="token keyword">from</span> name_function <span class="token keyword">import</span> get_formatted_name

<span class="token keyword">class</span> <span class="token class-name">NamesTestCase</span><span class="token punctuation">(</span>unittest<span class="token punctuation">.</span>TestCase<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""测试name_function.py"""</span>
    
    <span class="token keyword">def</span> <span class="token function">test_first_last_name</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""能够正确地处理像Janis Joplin 这样的姓名吗？ """</span>
        formatted_name <span class="token operator">=</span> get_formatted_name<span class="token punctuation">(</span><span class="token string">'janis'</span><span class="token punctuation">,</span> <span class="token string">'joplin'</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>assertEqual<span class="token punctuation">(</span>formatted_name<span class="token punctuation">,</span> <span class="token string">'Janis Joplin'</span><span class="token punctuation">)</span>
        
unittest<span class="token punctuation">.</span>main<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li><p>代码行<code>unittest.main()</code>让Python<strong>运行这个文件中的测试</strong>：</p>
<pre class="line-numbers language-none"><code class="language-none">.
---------------------------------------------------------
Ran 1 test in 0.000s

OK<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li>第一行的句点<code>.</code>表明<strong>有一个测试通过了</strong></li>
<li>最后的<strong>OK</strong>表明该测试用例中的<strong>所有单元测试都通过了</strong></li>
</ul>
</li>
<li><p><strong>测试类的命名</strong>最好让它看起来与要测试的函数相关，并<strong>包含字样Test</strong>。这个类<strong>必须继承unittest.TestCase类</strong>，<strong>这样Python才知道如何运行你编写的测试</strong>。</p>
</li>
<li><p>我们运行上述程序时，<strong>所有以<code>test_</code>打头的方法都会自动运行</strong>。</p>
</li>
<li><p>unittest最有用的功能之一：一个<strong>断言</strong>方法。</p>
<p><strong>断言方法用来核实得到的结果是否与期望的结果一致(应该满足的条件是否确实满足)</strong>。上述代码通过调用<code>unittest</code>的方法<code>assertEqual()</code>，并向它传递<code>formatted_name</code>和<code>&#39;Janis Joplin&#39;</code>。</p>
</li>
</ul>
<hr>
<h4 id="不能通过的测试"><a href="#不能通过的测试" class="headerlink" title="不能通过的测试"></a>不能通过的测试</h4><p>测试未通过时结果是什么样的呢？我们来修改<code>get_formatted_name()</code>，使其能够处理中间名，但这样做时，故意让这个函数无法正确地处理像<code>Janis Joplin</code>这样只有名和姓的姓名。</p>
<p>下面是函数<code>get_formatted_name()</code>的新版本，它要求<strong>通过一个实参指定中间名</strong>：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">get_formatted_name</span><span class="token punctuation">(</span>first<span class="token punctuation">,</span> middle<span class="token punctuation">,</span> last<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""生成整洁的姓名"""</span>
    full_name <span class="token operator">=</span> first <span class="token operator">+</span> <span class="token string">' '</span> <span class="token operator">+</span> middle <span class="token operator">+</span> <span class="token string">' '</span> <span class="token operator">+</span> last
    <span class="token keyword">return</span> full_name<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>这次运行测试代码，将会得到如下输出：</p>
<pre class="line-numbers language-none"><code class="language-none">E
&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;
ERROR: test_first_last_name (__main__.NamesTestCase)
------------------------------------------------------
...
...
...
------------------------------------------------------
Ran 1 test in 0.000s

FAILED (errors&#x3D;1)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li>第一行<strong>字母E</strong>指出测试用例中<strong>有一个单元测试导致了错误</strong>。</li>
<li>最后一行指出整个测试用例都未通过，因为运行该测试用例时发生了<strong>一个错误</strong>。</li>
</ul>
<hr>
<h4 id="添加新测试"><a href="#添加新测试" class="headerlink" title="添加新测试"></a>添加新测试</h4><p>我们再编写一个测试，用于<strong>测试包含中间名的姓名</strong>。为此，在NamesTestCase类中再添加一个方法：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> unittest
<span class="token keyword">from</span> name_function <span class="token keyword">import</span> get_formatted_name

<span class="token keyword">class</span> <span class="token class-name">NamesTestCase</span><span class="token punctuation">(</span>unittest<span class="token punctuation">.</span>TestCase<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""测试name_function.py"""</span>
    
    <span class="token keyword">def</span> <span class="token function">test_first_last_name</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""能够正确地处理像Janis Joplin 这样的姓名吗？ """</span>
        formatted_name <span class="token operator">=</span> get_formatted_name<span class="token punctuation">(</span><span class="token string">'janis'</span><span class="token punctuation">,</span> <span class="token string">'joplin'</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>assertEqual<span class="token punctuation">(</span>formatted_name<span class="token punctuation">,</span> <span class="token string">'Janis Joplin'</span><span class="token punctuation">)</span>
        
    <span class="token keyword">def</span> <span class="token function">test_first_last_middle_name</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""能够正确地处理像Wolfgang Amadeus Mozart这样的姓名吗？ """</span>
        formatted_name <span class="token operator">=</span> get_formatted_name<span class="token punctuation">(</span>
        	<span class="token string">'wolfgang'</span><span class="token punctuation">,</span> <span class="token string">'mozart'</span><span class="token punctuation">,</span> <span class="token string">'amadeus'</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>assertEqual<span class="token punctuation">(</span>formatted_name<span class="token punctuation">,</span> <span class="token string">'Wolfgang Amadeus Mozart'</span><span class="token punctuation">)</span>
        
unittest<span class="token punctuation">.</span>main<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li><strong>测试方法名必须以<code>test_</code>打头</strong>，这样它才会在我们运行<code>test_name_function.py</code>时自动运行。</li>
<li><strong>可以在TestCase类中使用很长的方法名</strong>，这些方法名必须是描述性的，这样才能让你明白测试未通过时的输出。</li>
</ul>
<p>两个测试都通过的输出：</p>
<pre class="line-numbers language-none"><code class="language-none">..
-------------------------------------------------
Ran 2 tests in 0.000s

OK<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h3 id="测试类"><a href="#测试类" class="headerlink" title="测试类"></a>测试类</h3><h4 id="各种断言方法"><a href="#各种断言方法" class="headerlink" title="各种断言方法"></a>各种断言方法</h4><p>Python在<code>unittest.TestCase</code>类中提供了很多<strong>断言方法</strong>。</p>
<p>6个常用的断言方法：</p>
<table>
<thead>
<tr>
<th>方法</th>
<th>用途</th>
</tr>
</thead>
<tbody><tr>
<td><code>assertEqual(a, b)</code></td>
<td>核实<code>a == b</code></td>
</tr>
<tr>
<td><code>assertNotEqual(a, b)</code></td>
<td>核实<code>a != b</code></td>
</tr>
<tr>
<td><code>assertTrue(x)</code></td>
<td>核实x为<code>True</code></td>
</tr>
<tr>
<td>assertFalse(x)</td>
<td>核实x为<code>False</code></td>
</tr>
<tr>
<td><code>assertIn(item, list)</code></td>
<td>核实item在list中</td>
</tr>
<tr>
<td><code>assertNotIn(item, list)</code></td>
<td>核实item不在list中</td>
</tr>
</tbody></table>
<hr>
<h4 id="一个要测试的类"><a href="#一个要测试的类" class="headerlink" title="一个要测试的类"></a>一个要测试的类</h4><p>类的测试与函数的测试相似——所做的大部分工作都是测试类中方法的行为，但存在一些不同之处，下面来编写一个类进行测试。</p>
<p>来看一个帮助管理匿名调查的类：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">AnonymousSurvey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""收集匿名调查问卷的答案"""</span>
    
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> question<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""存储一个问题，并为存储答案做准备"""</span>
        self<span class="token punctuation">.</span>question <span class="token operator">=</span> question
        self<span class="token punctuation">.</span>responses <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        
    <span class="token keyword">def</span> <span class="token function">show_questinon</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""显示调查问卷"""</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>question<span class="token punctuation">)</span>
        
    <span class="token keyword">def</span> <span class="token function">store_response</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> new_response<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""存储单份调查答卷"""</span>
        self<span class="token punctuation">.</span>responses<span class="token punctuation">.</span>append<span class="token punctuation">(</span>new_response<span class="token punctuation">)</span>
        
    <span class="token keyword">def</span> <span class="token function">show_results</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""显示收集到的所有答卷"""</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Survey results:"</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> response <span class="token keyword">in</span> self<span class="token punctuation">.</span>responses<span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'- '</span> <span class="token operator">+</span> response<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>为证明AnonymousSurvey类能够正确地工作，我们来编写一个使用它地程序：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> survey <span class="token keyword">import</span> AnonymousSurvey

<span class="token comment"># 定义一个问题，并创建一个表示调查地AnonymousSurvey对象</span>
question <span class="token operator">=</span> <span class="token string">"What language did you first learn to speak?"</span>
my_survey <span class="token operator">=</span> AnonymousSurvey<span class="token punctuation">(</span>question<span class="token punctuation">)</span>

<span class="token comment"># 显示问题并存储答案</span>
my_survey。show_question<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Enter 'q' at any time to quit.\n"</span><span class="token punctuation">)</span>
<span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
    response <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"Language: "</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> response <span class="token operator">==</span> <span class="token string">'q'</span><span class="token punctuation">:</span>
        <span class="token keyword">break</span>
    my_survey<span class="token punctuation">.</span>store_response<span class="token punctuation">(</span>response<span class="token punctuation">)</span>
    
<span class="token comment"># 显示调查结果</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\nThank you to everyone who participated in the survey!"</span><span class="token punctuation">)</span>
my_survey<span class="token punctuation">.</span>show_results<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>AnonymousSurvey类可用于<strong>进行简单的匿名调查</strong>。假设我们将它放在了模块survey中，并想<strong>进行改进</strong>：<strong>让每位用户都可输入多个答案；编写一个方法，它只列出不同的答案，并指出每个答案出现了多少次</strong>；<strong>再编写一个类，用于管理非匿名调查</strong>。</p>
<p>进行上述修改存在风险，可能会影响AnonymousSurvey类的当前行为。要确认在开发这个模块时没有破坏既有行为，可以编写针对这个类的测试。</p>
<hr>
<h4 id="测试-AnonymousSurvey-类"><a href="#测试-AnonymousSurvey-类" class="headerlink" title="测试 AnonymousSurvey 类"></a>测试 AnonymousSurvey 类</h4><p>下面来编写一个测试，对AnonymouSurvey类的行为进行验证：如果用户面对调查问题时只提供了一个答案，这个答案也能被妥善地存储；用户提供三个答案时，也将被妥善地存储：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> unittest
<span class="token keyword">from</span> survey <span class="token keyword">import</span> AnonymousSurvey

<span class="token keyword">class</span> <span class="token class-name">TestAnonymousSurvey</span><span class="token punctuation">(</span>unittest<span class="token punctuation">.</span>TestCase<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""针对AnonymousSurvey类的测试"""</span>
    
    <span class="token keyword">def</span> <span class="token function">test_store_single_response</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""测试单个答案会被妥善地存储"""</span>
        question <span class="token operator">=</span> <span class="token string">"What language did you first learn to speak?"</span>
        my_survey <span class="token operator">=</span> AnonymousSurvey<span class="token punctuation">(</span>question<span class="token punctuation">)</span>
        my_survey<span class="token punctuation">.</span>store_response<span class="token punctuation">(</span><span class="token string">'English'</span><span class="token punctuation">)</span>
        
        self<span class="token punctuation">.</span>assertIn<span class="token punctuation">(</span><span class="token string">'English'</span><span class="token punctuation">,</span> my_survey<span class="token punctuation">.</span>responses<span class="token punctuation">)</span>
        
    <span class="token keyword">def</span> <span class="token function">test_store_three_responses</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""测试三个答案会被妥善地存储"""</span>
        question <span class="token operator">=</span> <span class="token string">"What language did you first learn to speak?"</span>
        my_survey <span class="token operator">=</span> AnonymousSurvey<span class="token punctuation">(</span>question<span class="token punctuation">)</span>
        responses <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'English'</span><span class="token punctuation">,</span> <span class="token string">'Spanish'</span><span class="token punctuation">,</span> <span class="token string">'Mandarin'</span><span class="token punctuation">]</span>
        <span class="token keyword">for</span> response <span class="token keyword">in</span> responses<span class="token punctuation">:</span>
            my_survey<span class="token punctuation">.</span>store_response<span class="token punctuation">(</span>response<span class="token punctuation">)</span>
            
        <span class="token keyword">for</span> response <span class="token keyword">in</span> responses<span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>assertIn<span class="token punctuation">(</span>response<span class="token punctuation">,</span> my_survey<span class="token punctuation">.</span>responses<span class="token punctuation">)</span>
        
unittest<span class="token punctuation">.</span>main<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>上述做法的效果很好，但这些测试有些重复的地方。下面使用unittest的另一项功能来提高它们的效率。</p>
<hr>
<h4 id="方法-setUp"><a href="#方法-setUp" class="headerlink" title="方法 setUp()"></a>方法 setUp()</h4><p>unittest.TestCase类中包含了方法<code>setUp()</code>。<strong>让我们只需创建这些对象一次，并在每个测试方法中使用它们</strong>。如果在TestCase类章包含了方法<code>setUp()</code>，Python将先运行它，再运行各个以<code>test_</code>打头的方法。这样，<strong>在每个测试方法中都可使用在方法<code>setUp()</code>中创建的对象了</strong>。</p>
<p>下面使用<code>setUp()</code>来创建一个调查对象和一组答案，供方法<code>test_store_single_response()</code>和<code>test_store_three_responses()</code>使用：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> unittest
<span class="token keyword">from</span> survey <span class="token keyword">import</span> AnonymousSurvey

<span class="token keyword">class</span> <span class="token class-name">TestAnonymousSurvey</span><span class="token punctuation">(</span>unittest<span class="token punctuation">.</span>TestCase<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""针对AnonymousSurvey类的测试"""</span>
    
    <span class="token keyword">def</span> <span class="token function">setUp</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""
        创建一个调查对象和一组答案，供使用的测试方法使用
        """</span>
        question <span class="token operator">=</span> <span class="token string">"What language did you first learn to speak?"</span>
        self<span class="token punctuation">.</span>my_survey <span class="token operator">=</span> AnonymousSurvey<span class="token punctuation">(</span>question<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>responses <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'English'</span><span class="token punctuation">,</span> <span class="token string">'Spanish'</span><span class="token punctuation">,</span> <span class="token string">'Mandarin'</span><span class="token punctuation">]</span>
        
    <span class="token keyword">def</span> <span class="token function">test_store_single_response</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""测试单个答案会被妥善地存储"""</span>
        self<span class="token punctuation">.</span>my_survey<span class="token punctuation">.</span>store_response<span class="token punctuation">(</span>self<span class="token punctuation">.</span>responses<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>assertIn<span class="token punctuation">(</span>self<span class="token punctuation">.</span>responses<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>my_survey<span class="token punctuation">.</span>responses<span class="token punctuation">)</span>
        
    <span class="token keyword">def</span> <span class="token function">test_store_three_responses</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""测试三个答案会被妥善地存储"""</span>
        <span class="token keyword">for</span> response <span class="token keyword">in</span> self<span class="token punctuation">.</span>responses<span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>my_survey<span class="token punctuation">.</span>store_response<span class="token punctuation">(</span>response<span class="token punctuation">)</span>
        <span class="token keyword">for</span> response <span class="token keyword">in</span> self<span class="token punctuation">.</span>responses<span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>assertIn<span class="token punctuation">(</span>response<span class="token punctuation">,</span> self<span class="token punctuation">.</span>my_survey<span class="token punctuation">.</span>responses<span class="token punctuation">)</span>
        
unittest<span class="token punctuation">.</span>main<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>方法<code>setUp()</code>做了两件事：</p>
<ol>
<li>创建一个调查对象</li>
<li>创建一个答案列表</li>
</ol>
<p>存储这两样东西的<strong>变量名包含前缀self</strong>(即<strong>存储在属性中</strong>)，因此<strong>可在这个类的任何地方使用</strong>。</p>
<p>测试自己编写的类时，方法<code>SetUp()</code>让测试方法编写起来更容易：可<strong>在<code>setUp()</code>方法中创建一系列实例并设置它们的属性，再在测试方法中直接使用这些实例</strong>。</p>
<p>注意：</p>
<p>运行测试用例时，<strong>每完成一个单元测试，Python都打印一个字符</strong>：<strong>测试通过时打印一个句点；测试引发错误时打印一个E；测试导致断言失败时打印一个F</strong>。</p>
<hr>
<h2 id="Python项目"><a href="#Python项目" class="headerlink" title="Python项目"></a>Python项目</h2><h3 id="数据可视化"><a href="#数据可视化" class="headerlink" title="数据可视化"></a>数据可视化</h3>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <a class="extend prev" rel="prev" title="上一页" aria-label="上一页" href="/page/7/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/7/">7</a><span class="page-number current">8</span><a class="page-number" href="/page/9/">9</a><a class="page-number" href="/page/10/">10</a><a class="extend next" rel="next" title="下一页" aria-label="下一页" href="/page/9/"><i class="fa fa-angle-right"></i></a>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">Hunter</span>
  </div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/medium-zoom/1.1.0/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/sidebar.js"></script><script src="/js/next-boot.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>







  
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>




  

  <script class="next-config" data-name="enableMath" type="application/json">false</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>


<script class="next-config" data-name="utterances" type="application/json">{"enable":true,"repo":"Hunter1023/Hunter1023.github.io","issue_term":"pathname","theme":"github-light"}</script>
<script src="/js/third-party/comments/utterances.js"></script>

</body>
</html>
